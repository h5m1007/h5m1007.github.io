<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> javascript DOM高级程序设计 学习笔记 · Leooon Blog</title><meta name="description" content="javascript DOM高级程序设计 学习笔记 - Leon"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="google-site-verification" content="kx_a2Pxm8eUeXBh4VntVZ3IlkZpWcQMPjLgfTYpTLNI"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://h5m1007.github.io/atom.xml" title="Leooon Blog"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Leooon Blog" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">javascript DOM高级程序设计 学习笔记</h1><div class="post-info">Aug 12, 2016</div><div class="post-content"><p>一本停产的书籍，《javascript DOM高级程序设计》，是的，没错，各大网上书店都没有，实体店可能还能找到，所以我只能下个电子版来看看，果然，不负各大书评，书，的确是好书，前几章已经跟其它书籍有所不一样，感觉自己可以有动力看完一本啦(O.S 很少冷静地看完一本技术书)</p>
<h2 id="Event事件"><a href="#Event事件" class="headerlink" title="Event事件"></a>Event事件</h2><ul>
<li>事件：不以”on”开头，如onclick不是事件而是用来引用一个对象的属性，可以通过它来为DOM元素指定一个click事件</li>
<li>事件侦听器：即当指定的事件发生时会执行的<em>函数或方法</em></li>
<li>事件注册：指为一个DOM元素的具体事件，指定事件侦听器的<em>过程</em></li>
<li>事件代理：由于事件冒泡，可把子节点的监听函数定义在父级上，经父级的监听统一处理多个子级事件  </li>
</ul>
<h3 id="事件类型"><a href="#事件类型" class="headerlink" title="事件类型"></a>事件类型</h3><p>对象事件、鼠标事件、键盘事件、表单事件、W3C事件</p>
<h4 id="对象事件"><a href="#对象事件" class="headerlink" title="对象事件"></a>对象事件</h4><ul>
<li>load和unload 如使用window对象的load事件(在页面完全载入成功后调用)</li>
<li>error和abort error既适用于window对象也适用于图像对象</li>
<li>resize</li>
<li>scroll</li>
</ul>
<h4 id="鼠标事件"><a href="#鼠标事件" class="headerlink" title="鼠标事件"></a>鼠标事件</h4><h5 id="鼠标移动事件"><a href="#鼠标移动事件" class="headerlink" title="鼠标移动事件"></a>鼠标移动事件</h5><ul>
<li>mousemove</li>
<li>mouseover 当指针移动到一个新对象上触发</li>
<li>mouseout</li>
</ul>
<h5 id="鼠标单击事件"><a href="#鼠标单击事件" class="headerlink" title="鼠标单击事件"></a>鼠标单击事件</h5><ul>
<li>mousedown</li>
<li>mouseup</li>
<li>click</li>
<li>dblclick</li>
</ul>
<h4 id="表单事件"><a href="#表单事件" class="headerlink" title="表单事件"></a>表单事件</h4><ul>
<li>submit和reset  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ADS.addEvent(ele, &#39;submit&#39;, function()&#123;&#125;)</span><br><span class="line">&#96;&#96;&#96;  </span><br><span class="line">匹配格式A#A #A# (字母数字字母 中间任意量空格 数字字母数字)  </span><br><span class="line"> .match(正则表达式) 返回匹配的值</span><br></pre></td></tr></table></figure>
str.match(/[A-Z][0-9][A-Z]\s*[0-9][A-Z][0-9]/i)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- blur和focus  </span><br><span class="line">适用于label、input、select、textarea、button等表单元素  </span><br><span class="line">focus会在单击元素或tab切换下一个元素时被调用  </span><br><span class="line">blur会在单机元素之外的地方或tab切换时，基于focus调用上被调用</span><br></pre></td></tr></table></figure>
ADS.addEvent(ele, ‘focus’, function(){<br>  当元素获得焦点时执行…<br>});<br>ADS.addEvent(ele, ‘blur’, function(){<br>  当元素失去焦点时执行…<br>})<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- change  </span><br><span class="line">适用于input、select、textarea表单元素，在focus事件发生后被调用</span><br><span class="line"></span><br><span class="line">### 事件流</span><br><span class="line">- 捕获阶段：浏览器会从最外层祖先元素向内部依次调用事件到目标元素</span><br><span class="line">- 冒泡阶段：从目标元素向外依次通过祖先元素的顺序来冒泡事件  </span><br><span class="line">- 事件注册&#x2F;移除</span><br></pre></td></tr></table></figure>
ele.addEventListener(type, listener, true/false)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type：事件类型  listener：执行函数  true启用捕获阶段，false启用冒泡阶段  </span><br><span class="line"></span><br><span class="line">ele.removeEventListener(type, listener, true&#x2F;false)</span><br></pre></td></tr></table></figure>
ele.addEventListener(type,function(){<br>console.log(this.value);<br>this.removeEventListener(type, arguments.callee); //可移除自身注册事件<br>});</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line">&#96;e.stopPropagation()&#96;  阻止事件冒泡</span><br><span class="line">&#96;e.preventDefault()&#96;  取消默认动作</span><br><span class="line"></span><br><span class="line">### 事件对象的属性</span><br><span class="line">- bubbles 为布尔值，true为处于冒泡，false为处于捕获</span><br><span class="line">- cancelable 为布尔值，true为事件默认动作可取消，false则不可以取消</span><br><span class="line">- currentTarget 指的是当前正在处理的事件侦听器所在的事件流中的DOM元素  &#96;e.currentTarget&#96; 等价于 &#96;this&#96;  **表示注册事件的元素**</span><br><span class="line">- target 为DOM中*最早调用*事件序列的目标对象，即发生事件的元素 (注：this !&#x3D; e.target)</span><br><span class="line">- timestamp 由创建事件开始时间起经过的*毫秒数*</span><br><span class="line">- type 事件名称的字符串值</span><br><span class="line">- eventPhase表示当前事件侦听器处于事件流的哪个阶段</span><br></pre></td></tr></table></figure>
<p>function eventListener(e){<br>    switch(e.eventPhase){<br>    case Event.CAPTURING_PHASE:<br>    // 如果在捕获阶段执行的代码<br>    break;<br>    case Event.AT_TARGET:<br>    // 如果当前是目标对象时执行的代码<br>    break;<br>    case Event.BUBBLING_PHASE:<br>    // 如果在冒泡阶段执行的代码<br>    break;<br>}<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 事件对象的方法</span><br><span class="line">- initEvent(eventType, canBubble, cancelable) 用于初始化由documen.createEvent(&#39;Event&#39;)创建的事件对象</span><br><span class="line">- preventDefault() 取消对象默认动作</span><br><span class="line">- stopPropagation() 停止事件流的进一步执行，包括捕获、冒泡阶段，目标对象。当调用这个方法时，所有侦听器依旧会在当前层次上执行，但事件流不会超出currentTarget</span><br><span class="line"></span><br><span class="line">### 鼠标事件对象的属性 </span><br><span class="line">- altKey、ctrlKey、shiftKey 表示鼠标事件发生时是否同时按住了键盘上Alt、Ctrl、Shift等键</span><br><span class="line">- button 表示鼠标按下的键值，0为左键，1为中键，2为右键</span><br></pre></td></tr></table></figure>
<p>if(e.button == 0){<br>// 鼠标左键单击执行的代码<br>}<br>// 等价于<br>if(e.button == MouseEvent.BUTTON_LEFT){}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- clientX、clientY 指事件发生位置相对于DOM实现的客户端区域的水平和垂直坐标</span><br><span class="line">- screenX、screenY 指事件位置相对于客户端所在屏幕的水平和垂直坐标</span><br><span class="line">- relatedTarget 引用的是与事件相关的次要目标，一般情况值为null，但在mouseover它引用的是**鼠标离开前**一个对象，在mouseout它引用的是**鼠标之前进入**的那个对象</span><br><span class="line"></span><br><span class="line">## 事件的兼容问题</span><br><span class="line"></span><br><span class="line">### 访问事件的目标元素</span><br><span class="line">- W3C: e.target</span><br><span class="line">- IE: e.srcElement</span><br><span class="line">- Safari: 文本节点会代替包含它的元素变成事件的目标对象  </span><br><span class="line">解决方案：重新将目标对象指定为它的父元素</span><br></pre></td></tr></table></figure>
<p>if(e.target.nodetype == ADS.node.TEXT_NODE){<br>    target = node.parentNode<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 处理鼠标的位置</span><br><span class="line">鼠标的光标应相对于文档原点的位置  </span><br><span class="line">经过一些**能力检测**并根据访问页面的浏览器来调整要使用的属性  </span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  </span><br><span class="line">W3C和IE都定义了clientX和clientY属性，但在确定针对浏览器*滚动后*的位移属性，两者各不相同，W3C使用document.documentElement.scrollTop，而IE使用document.body.scrollTop。</span><br><span class="line">而Safari则把位置信息各放在事件的pageX和pageY属性中。</span><br></pre></td></tr></table></figure>
<p>var x = e.pageX<br>    || (e.clientX + (document.documentElement.scrollLeft<br>    || document.body.scrollLeft));<br>var y = e.pagey<br>    || (e.clientY + (document.documentElement.scrollTop<br>    || document.body.scrollTop));</p>
<p>```</p>
</div></article></div></main><footer><div class="paginator"><a href="/2016/08/13/learn-from-jsdom/" class="prev">PREV</a><a href="/2016/08/10/learn-from-jsdom/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2020 <a href="https://h5m1007.github.io">Leon</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>