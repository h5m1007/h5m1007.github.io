<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Leooon Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://h5m1007.github.io/"/>
  <updated>2020-05-05T08:17:46.799Z</updated>
  <id>https://h5m1007.github.io/</id>
  
  <author>
    <name>Leon</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ‰“é€ æœ€ä½³ç»ˆç«¯ç¯å¢ƒ</title>
    <link href="https://h5m1007.github.io/2020/04/30/best-terminal-configure/"/>
    <id>https://h5m1007.github.io/2020/04/30/best-terminal-configure/</id>
    <published>2020-04-30T08:32:18.000Z</published>
    <updated>2020-05-05T08:17:46.799Z</updated>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æ–°è´­å…¥çš„mbpï¼Œéœ€è¦ç”¨å›ä¹‹å‰å·¥ä½œçš„airä¸Šç»ˆç«¯zshï¼Œé‡æ–°ä¸ºæ–°æœºå­é…ç½®è¿‡ä¸€éï¼Œæœ€ä½³çš„ç»ˆç«¯ç¯å¢ƒã€‚</p><h2 id="oh-my-zsh-iTerm2"><a href="#oh-my-zsh-iTerm2" class="headerlink" title="oh-my-zsh + iTerm2"></a>oh-my-zsh + iTerm2</h2><p>ä»¥ä¸‹ç®€ç§° oh-my-zsh ä¸º ozshã€‚ozsh ç”±ä½•è€Œæ¥ï¼Œé«˜åº¦è‡ªå®šä¹‰æ— è®ºæ˜¯åœ¨æ ·å¼ã€æ’ä»¶ç­‰ç­‰æ–¹æ¡ˆï¼Œæ‹“å±•äº†ç³»ç»Ÿè‡ªå¸¦çš„ zshã€‚</p><p>å…ˆä¸Šæœ€ç»ˆé…ç½®ç•Œé¢ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/images/20200503150505.png" alt="ozsh"></p><p>æ˜æ˜¾æ¯”åŸæ¥çš„é«˜é¢œå€¼ä¸”æ›´å¤šå¢å¼ºåŠŸèƒ½ï¼ğŸ‘</p><h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>å…ˆä¸ºæœ¬æœºä¸‹è½½å®‰è£…å¥½ï¼ŒGitã€Brewã€Xcode(CLI)ï¼Œç§‘å­¦å®‰è£…æ–¹å¼ç§»æ­¥è‡³<a href="/2020/04/30/dev-env-configure/">ä»0å¼€å§‹é…ç½®æ–°è´­MBP</a></p><h3 id="å„ä¸ªå·¥å…·çš„å®‰è£…ä½¿ç”¨"><a href="#å„ä¸ªå·¥å…·çš„å®‰è£…ä½¿ç”¨" class="headerlink" title="å„ä¸ªå·¥å…·çš„å®‰è£…ä½¿ç”¨"></a>å„ä¸ªå·¥å…·çš„å®‰è£…ä½¿ç”¨</h3><ul><li><p>iTerm2</p><p>  ç›´æ¥å»å®˜ç½‘ä¸‹è½½æˆ–æ˜¯ç¬¬ä¸‰æ–¹è½¯ä»¶å¹³å°ä¸‹è½½ï¼Œæ¨èç¬¬ä¸‰æ–¹ï¼Œå› ä¸ºä¸‹è½½é€Ÿåº¦å¿«å¾ˆå¤šã€‚</p><p>  <a href="https://www.iterm2.com/" target="_blank" rel="noopener">å®˜ç½‘</a><br>  <a href="https://macwk.com/soft/iterm2" target="_blank" rel="noopener">ç¬¬ä¸‰æ–¹</a></p><p>  ä¸‹è½½å®‰è£…å®Œï¼Œé»˜è®¤æ ·å¼ï¼šï¼ˆç›—å›¾ï¼‰</p><p>  <img src="https://raw.githubusercontent.com/sirius1024/pubimgs/master/blogs/iterm2/1.png" alt="iTerm2"></p></li><li><p>oh-my-zsh</p><p>  <a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="noopener">oh-my-zshå¼€æºåœ°å€</a></p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># curl download</span></span><br><span class="line">sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># wget download</span></span><br><span class="line">sh -c <span class="string">"<span class="variable">$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>"</span></span><br></pre></td></tr></table></figure><p>  ä¸‹è½½å®‰è£…å®Œï¼Œé»˜è®¤æ ·å¼ï¼šï¼ˆç›—å›¾ï¼‰</p><p>  <img src="https://raw.githubusercontent.com/sirius1024/pubimgs/master/blogs/iterm2/2.png" alt="iTerm2"></p></li><li><p>powerline</p><p>  ç»ˆç«¯å­—ä½“å¢å¼ºæ’ä»¶ï¼Œå…·ä½“ä¸‹è½½å®‰è£…æ­¥éª¤ç§»æ­¥è‡³<a href="/2020/04/30/dev-env-configure/">ä»0å¼€å§‹é…ç½®æ–°è´­MBP</a></p></li><li><p>PowerFonts</p><p>  ç»ˆç«¯å­—ä½“å¢å¼ºæ’ä»¶ï¼Œéœ€è¦ä¸‹è½½æºé¡¹ç›®ä»“åº“ï¼Œå¹¶æ‰§è¡Œé¡¹ç›®é‡Œçš„ <code>install.sh</code> å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># git clone</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/powerline/fonts.git --depth=1 ./powerFonts</span><br><span class="line"><span class="comment"># jump to powerFonts folder</span></span><br><span class="line"><span class="built_in">cd</span> powerFonts</span><br><span class="line"><span class="comment"># run install shell</span></span><br><span class="line">bash ./install.sh</span><br></pre></td></tr></table></figure><p>  æ‰§è¡Œå®‰è£…å®Œï¼Œè®¾ç½® iTerm2 å­—ä½“ï¼ŒiTerm2 -&gt; Preferences -&gt; Profiles -&gt; Textï¼Œåœ¨FontåŒºåŸŸé€‰ä¸­Change Fontï¼Œç„¶åæ‰¾åˆ°Meslo LGå­—ä½“ã€‚</p><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/images/20200505114546.png" alt="iTerm2 config"></p><p>  éœ€è¦åŒæ—¶è®¾ç½®å¥½è¿™ä¸¤ä¸ªä½ç½®ï¼Œç¬¬äºŒä¸ªä½ç½®å¦‚æœæ²¡è®¾ç½®ï¼Œä¼šæœ‰ç©ºæ¡† icon å‡ºç°ã€‚</p></li><li><p>é…è‰²æ–¹æ¡ˆ</p><p>  é…è‰²æ–¹æ¡ˆåœ¨ä½¿ç”¨ vi/vim æˆ– colorFul log æ—¶ï¼Œä¼šç›¸å½“æœ‰ç”¨ã€‚ä»¥åŒæ ·çš„æ–¹å¼ï¼Œgit clone ä¸‹æ¥é¡¹ç›®æºç ï¼š</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># git clone</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/altercation/solarized --depth=1 ./solarized</span><br><span class="line"><span class="comment"># jump to solarized-theme folder</span></span><br><span class="line"><span class="built_in">cd</span> solarized/iterm2-colors-solarized/</span><br><span class="line"><span class="comment"># open folder</span></span><br><span class="line">open .</span><br></pre></td></tr></table></figure><p>  ä¸‹è½½åæ‰“å¼€é¡¹ç›®ç›®å½•ï¼šï¼ˆç›—å›¾ï¼‰</p><p>  <img src="https://raw.githubusercontent.com/sirius1024/pubimgs/master/blogs/iterm2/8.png" alt="solarized-theme"></p><p>  ä¾æ—§æ‰“å¼€ iTerm2 é…ç½®ç•Œé¢ï¼ŒiTerm2 -&gt; Preferences -&gt; Profiles -&gt; Colors -&gt; Color Presetsã€‚</p><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/images/Xnip2020-05-05_12-01-26.jpg" alt="iTerm2 config"></p></li><li><p>ä¸»é¢˜å®‰è£…</p><p>  éœ€è¦ä¸‹è½½æºé¡¹ç›®ä»“åº“ï¼Œå¹¶æ‰§è¡Œé¡¹ç›®é‡Œçš„ <code>install.sh</code> å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># git clone</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/fcamblor/oh-my-zsh-agnoster-fcamblor.git ./agnoster-theme</span><br><span class="line"><span class="comment"># jump to agnoster-theme folder</span></span><br><span class="line"><span class="built_in">cd</span> agnoster-theme</span><br><span class="line"><span class="comment"># run install shell</span></span><br><span class="line">bash ./install.sh</span><br></pre></td></tr></table></figure><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/pzy/Xnip2020-05-05_14-56-13.jpeg" alt="agnoster-theme"></p><p>  å†å» zsh çš„é…ç½®æ–‡ä»¶ <code>vi ~/.zshrc</code>ï¼Œæ›´æ”¹ä¸»é¢˜åº”ç”¨ã€‚</p><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/pzy/20200505155804.jpg" alt="zshrc"></p><p>  å¦‚ä½•ä½¿ç”¨ vi è‡ªè¡Œç™¾åº¦ï¼Œè¿™é‡Œä¿®æ”¹å®Œå <code>:wq</code> ä¿å­˜é€€å‡ºç¼–è¾‘ï¼Œé‡å¯ç»ˆç«¯å³ä¸»é¢˜ç”Ÿæ•ˆã€‚</p></li><li><p>é«˜äº®æ’ä»¶ zsh-syntax-highlighting</p><p>  zsh-syntax-highlightingï¼Œä½¿ç”¨åèƒ½é«˜äº®æ‰€æœ‰å…³é”®å­—ï¼Œå¦‚ï¼š</p><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/pzy/20200505160322.png" alt="zsh-syntax-highlighting"></p><p>  è¿™é‡Œçš„å®‰è£…æ–¹å¼ä¾æ—§ git cloneï¼Œæœ‰äº›ä¸åŒçš„æ˜¯ï¼Œéœ€è¦æŠŠ clone ä¸‹æ¥çš„é¡¹ç›®ç›´æ¥æ”¾åœ¨ <code>~/.oh-my-zsh/custom/plugins/</code> ã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.oh-my-zsh/custom/plugins/</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git</span><br></pre></td></tr></table></figure><p>  å†å»ç¼–è¾‘ <code>~/.zshrc</code>ã€‚</p><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/pzy/20200505160831.png" alt="zsh-syntax-highlighting"></p></li><li><p>å‘½ä»¤è‡ªåŠ¨è¡¥å…¨æ’ä»¶ zsh-autosuggestion</p><p>  zsh-autosuggestionï¼Œä½¿ç”¨åè¾“å…¥çš„å‘½ä»¤ä¼šæç¤ºå’Œè¡¥å…¨ï¼Œå¦‚ï¼š</p><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/pzy/20200505161343.png" alt="zsh-autosuggestion"></p><p>  ä¸‹è½½åº”ç”¨æ–¹å¼å¦‚ä¸Šé¢ğŸ‘†ä¸€è‡´ã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.oh-my-zsh/custom/plugins/</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions.git</span><br></pre></td></tr></table></figure><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/pzy/20200505161106.png" alt="zsh-autosuggestion"></p></li></ul><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>åˆ°è¿™é‡Œï¼Œå·²ç»å®Œæˆäº†æ•´ä¸ªç»ˆç«¯çš„å®‰è£…é…ç½®ï¼Œæœ€ç»ˆæ•ˆæœå†æ¥å›é¡¾ä¸‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/images/20200503150505.png" alt="ozsh"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;æ–°è´­å…¥çš„mbpï¼Œéœ€è¦ç”¨å›ä¹‹å‰å·¥ä½œçš„airä¸Šç»ˆç«¯zshï¼Œé‡æ–°ä¸ºæ–°æœºå­é…ç½®è¿‡ä¸€éï¼Œæœ€ä½³çš„ç»ˆç«¯ç¯å¢ƒã€‚&lt;/p&gt;
&lt;h2 id=&quot;oh-my-zsh-
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>ä»0å¼€å§‹é…ç½®æ–°è´­MBP</title>
    <link href="https://h5m1007.github.io/2020/04/30/dev-env-configure/"/>
    <id>https://h5m1007.github.io/2020/04/30/dev-env-configure/</id>
    <published>2020-04-30T08:29:45.000Z</published>
    <updated>2020-05-03T07:22:30.453Z</updated>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æ–°å…¥æ‰‹çš„ mbpï¼Œéœ€è¦é‡æ–°é…ç½®ä¹‹å‰å‰ç«¯å¼€å‘çš„ç¯å¢ƒï¼Œå·²ç»å‡†å¤‡åŒæ­¥çš„å†…å®¹æœ‰ï¼š</p><ol><li><p>Safariï¼ŒChrome ä¸¤å¤§æµè§ˆå™¨çš„å†å²æ•°æ®ï¼Œå¦‚æµè§ˆè®°å½•ã€ä¹¦ç­¾ã€å¯†ç ã€æ‹“å±•æ’ä»¶ç­‰ç­‰ï¼Œåˆ†åˆ«ä»¥ iCould å’Œ Google è´¦å·çš„åŒæ­¥åŠŸèƒ½ï¼Œå®ç°è¿ç§»æœºå™¨æ•°æ®çš„å®Œç¾åŒæ­¥ã€‚</p></li><li><p>å…¶å®ƒè½¯ä»¶çš„åŒæ­¥å·¥ä½œï¼Œå¦‚è½¯ä»¶ä¹‹å‰çš„é…ç½®ï¼Œå®‰è£…çš„æ’ä»¶ç­‰ç­‰ã€‚</p><p> å¼€å‘è½¯ä»¶åˆ—è¡¨ï¼š</p><ul><li><p>iTerm2ï¼šç§»æ­¥<a href="/2020/04/30/best-terminal-configure/">æ‰“é€ æœ€ä½³ç»ˆç«¯</a>;</p></li><li><p>å¹•å¸ƒï¼šç±»ä¼¼äºXmindè„‘å›¾è½¯ä»¶ï¼Œç”¨ç™»å½•è´¦å·æ¥å®ç°åŒæ­¥å·²ä¿å­˜è‡³äº‘ç«¯çš„æ•°æ®ï¼›</p></li><li><p>SwitchHostsï¼šæœ¬åœ° hosts æ–‡ä»¶ä¿®æ”¹è½¯ä»¶ï¼Œç›´æ¥å¯¼å…¥å·²ä»å…¶å®ƒæœºå™¨å¯¼å‡ºçš„é…ç½®æ–‡ä»¶å³å¯ï¼›</p></li><li><p>VsCodeï¼šé‡é‡çº§è½¯ä»¶ï¼Œå¼€å‘å¿…å¤‡ç¼–è¾‘å™¨ï¼ŒåŒæ­¥åŠŸèƒ½ä½¿ç”¨ vscode çš„ Setting Sync æ’ä»¶ï¼Œé€šè¿‡å·²åœ¨ gist ä¸Šä¼ çš„é…ç½®æ–‡ä»¶æ¥<br>å®ç°åŒæ­¥å·¥ä½œï¼Œå¯åŒæ­¥ä¹‹å‰å·²å®‰è£…æ’ä»¶åˆ—è¡¨ã€è½¯ä»¶é…ç½®ç­‰ç­‰ï¼›</p></li></ul></li><li><p>é™¤äº†ä»¥ä¸Šè½¯ä»¶çš„é…ç½®å®‰è£…ä¹‹å¤–ï¼Œé¢å¤–çš„å‘è¿˜æœ‰ï¼š</p><ul><li><p>ç§‘å­¦ä¸Šç½‘</p><p>  æ²¡æœ‰æ¢¯å­æ²¡æœ‰æ¡ä»¶å°±åˆ›é€ æ¡ä»¶ï¼Œå›½å†…æƒ³ download ä¸€äº›å¦‚ brewã€pipã€ä¹ƒè‡³äºç”¨ git clone éƒ½æ˜¯åŸºæœ¬æ²¡é€Ÿåº¦å¯è¨€çš„ï¼Œé’ˆå¯¹ä»¥ä¸Šè½¯ä»¶å‚è€ƒè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p><p>  <strong>brew</strong>ï¼šæŒ‰ç…§å®˜æ–¹å®‰è£…æ–¹å¼ï¼Œå› GFWçš„å­˜åœ¨ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸‹è½½ä¸äº†æˆ–æ²¡é€Ÿåº¦ï¼Œæ‰€ä»¥å¾—æ¢ç§æ–¹å¼ã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh &gt;&gt; ~/brew_install.sh</span><br></pre></td></tr></table></figure><p>  ä¿®æ”¹ brew_install.sh æ–‡ä»¶ï¼Œæ›´æ¢é‡Œé¢çš„é•œåƒæº  </p><p>  <code>BREW_REPO = &quot;https://github.com/Homebrew/brewâ€</code><br>  ==&gt;<br>  <code>BREW_REPO=&quot;https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/brew.gitâ€</code></p><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/images/20200502172342.png" alt="ä¿®æ”¹ brew é•œåƒæº"></p><p>  å†æ‰§è¡Œ brew_install.sh æ–‡ä»¶ï¼Œä¸å‡ºæ„å¤–ï¼Œ<code>brew -v</code> æ˜¾ç¤ºç‰ˆæœ¬å·å³å®‰è£…å®Œæ¯•ã€‚</p><p>  <strong>pip</strong>ï¼špip æ˜¯ python åŒ…ç®¡ç†å·¥å…·ï¼Œç³»ç»Ÿé»˜è®¤è‡ªå¸¦çš„ python2.7 å®‰è£…åŒ…é‡Œ easy_install.py æ˜¯é»˜è®¤å®‰è£…çš„ï¼Œè€Œ pip éœ€å¦å¤–å®‰è£…</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä½¿ç”¨å›½å†…é•œåƒæºï¼šhttps://pypi.tuna.tsinghua.edu.cn/simple/</span></span><br><span class="line">sudo easy_install -i https://pypi.tuna.tsinghua.edu.cn/simple/ pip</span><br></pre></td></tr></table></figure></li><li><p>Git ä¸‹è½½é€Ÿåº¦</p><p>  ç³»ç»Ÿä¸ä¼šè‡ªå¸¦ Gitï¼Œä½†å®‰è£…åœ¨ä¸‹è½½ Brewï¼Œä¼šå¼•å¯¼è°ƒç”¨ç³»ç»Ÿè‡ªåŠ¨ä¸‹è½½å®‰è£…æ‰€å¿…é¡»çš„ Xcode(CLI) ä»¥åŠ Gitã€‚</p><p>  è¿›å…¥ä¸»é¢˜ï¼Œå•å• Git Clone ä¸ªé¡¹ç›®é€Ÿåº¦ç›¸å½“å ªå¿§ï¼Œè§£å†³æ­¤ç±»é—®é¢˜ï¼Œæ–¹æ¡ˆæœ‰å‡ ç§ï¼š</p><p>  ä¸€èˆ¬çš„æ–¹å¼æ˜¯ç›´æ¥ç»‘ hosts ( å¯èƒ½æœ¬åœ°ç½‘ç»œåŸå› äº¦æˆ–å…¶å®ƒï¼Œåæ­£å¯¹äºæˆ‘mbpæ— æ•ˆï¼Œmmp )ï¼š</p><p>  æŸ¥è¯¢ä»¥ä¸‹ä¸¤åŸŸåç›¸å¯¹æœ¬åœ°ç½‘ç»œçš„ <a href="https://www.ipaddress.com" target="_blank" rel="noopener">IP åœ°å€</a> ( æ¯ä¸ªäººæŸ¥è¯¢åˆ°çš„å¯èƒ½ä¸ä¸€ )</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">github.global.ssl.fastly.net</span><br><span class="line"></span><br><span class="line">github.com</span><br></pre></td></tr></table></figure><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/images/20200502172728.png" alt="github.global.ssl.fastly.net"></p><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/images/20200502173014.png" alt="github.com"></p><p>  å‡è®¾æŸ¥è¯¢åˆ°çš„ IP åœ°å€æ˜¯ï¼š  </p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">140.82.113.4 github.com</span><br><span class="line">199.232.69.194 github.global.ssl.fastly.net</span><br></pre></td></tr></table></figure><p>  å†™å…¥ <code>/etc/hosts</code> æ–‡ä»¶æœ«å°¾è¿½åŠ </p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hosts</span><br></pre></td></tr></table></figure><p>  å› æˆ‘å·²ç»å®‰è£…äº† SwitchHosts è¯¥è½¯ä»¶ï¼Œç›´æ¥å†™å…¥é…ç½®æ–‡ä»¶ç«‹å³ç”Ÿæ•ˆã€‚</p><p>  æœ€åéœ€è¦åˆ·æ–° DNS</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo killall -HUP mDNSResponder</span><br></pre></td></tr></table></figure><p>  <strong>æ³¨</strong>ï¼šè·å–çš„ IP å› æ¯ä¸ªäººä¸ä¸€æ ·ï¼Œä¸”æ—¶è€Œä¼šæ›´æ–°ï¼Œæ‰€ä»¥ä¸€æ—¦é€Ÿåº¦å˜æ…¢ï¼Œé‡å¤ä»¥ä¸Šæ­¥éª¤è¿›è¡Œä¿®æ”¹ã€‚</p><p>  å¦ä¸€ç§æœ€ç›´æ¥äº†å½“çš„ï¼Œå€ŸåŠ©ç°æˆå·¥å…·å®ç°åŠ é€Ÿï¼š(<strong>åŠ›èï¼</strong>)<br>  <a href="https://github.zhlh6.cn/" target="_blank" rel="noopener">GithubåŠ é€Ÿå™¨</a><br>  <a href="https://chrome.google.com/webstore/detail/githubåŠ é€Ÿ/kejahdakjmkfddgnifodfnpcklckjjpo" target="_blank" rel="noopener">Chromeæ’ä»¶</a></p></li><li><p>Brew</p><p>  <code>brew install xxx</code>ï¼Œbrew å®‰è£…è½¯ä»¶é€Ÿåº¦ä¾æ—§æ„Ÿäººï¼Œè§£å†³æ–¹æ¡ˆä»ç„¶ä¿®æ”¹é•œåƒæºï¼Œä¿®æ”¹ brewã€homebrew-core çš„é¡¹ç›® git remote é•œåƒæº</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="string">"<span class="variable">$(brew --repo)</span>"</span></span><br><span class="line"></span><br><span class="line">git remote <span class="built_in">set</span>-url origin https://mirrors.ustc.edu.cn/brew.git</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> <span class="string">"<span class="variable">$(brew --repo)</span>/Library/Taps/homebrew/homebrew-core"</span></span><br><span class="line"></span><br><span class="line">git remote <span class="built_in">set</span>-url origin https://mirrors.ustc.edu.cn/homebrew-core.git</span><br></pre></td></tr></table></figure><p>  æœ€åæ›´æ–°ä¸‹ brew <code>brew update</code>ã€‚</p><p>  è¿˜æœ‰ä¸€ç§è´¹æ—¶è´¹é’±ï¼ŒæŒ‚ä»£ç†ï¼š</p><p>  å‡è®¾ä½ å·²ç»ç”¨äº†å¦‚Shadowsocksï¼Œä¸”ä¹Ÿæ­å¥½æœåŠ¡å™¨ï¼Œä¸ç®¡æ˜¯è‡ªå·±çš„è¿˜æ˜¯è‡ªè´¹çš„VPSã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç«¯å£1086ä¸ä¸€å®šé…ç½®éƒ½æ˜¯ä¸€è‡´ï¼ŒæŒ‰è‡ªå·±é…ç½®çš„ä¿®æ”¹</span></span><br><span class="line">ALL_PROXY=socks5://127.0.0.1:1086 brew install node</span><br></pre></td></tr></table></figure><p>  æ¯æ¬¡ä½¿ç”¨ brew å®‰è£…è½¯ä»¶æ—¶ï¼Œéƒ½éœ€è¦æ‰‹åŠ¨åŠ è½½ä»£ç†ï¼Œæƒ³æ–¹ä¾¿çš„æ¢ä¹Ÿå¯æŠŠ <code>export ALL_PROXY=socks5://127.0.0.1:1086</code> å†™å…¥ <code>~/.zshrc</code> ç»ˆç«¯é…ç½®æ–‡ä»¶é‡Œï¼Œä½†ä¸å»ºè®®è¿™æ ·åšï¼Œå› ä¸ºå¯èƒ½ä¼šå½±å“å…¶å®ƒå·¥å…·çš„ä½¿ç”¨ã€‚</p></li><li><p>Node</p><p>  å»ºè®®ç›´æ¥ä½¿ç”¨ nvm Nodeç‰ˆæœ¬ç®¡ç†è½¯ä»¶ï¼Œä½¿ç”¨å®˜æ–¹ä¸‹è½½å®‰è£…æ–¹å¼</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash</span><br></pre></td></tr></table></figure><p>  ä¸‹è½½å®‰è£…å®Œæˆåï¼Œä¿®æ”¹ <code>~/.zshrc</code> ç»ˆç«¯é…ç½®æ–‡ä»¶é‡Œï¼Œå¾€åç»§ç»­è¿½åŠ </p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨ç»ˆç«¯æ—¶è°ƒç”¨ nvm æ‰§è¡Œæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">"<span class="variable">$([ -z "$&#123;XDG_CONFIG_HOME-&#125;" ] &amp;&amp; printf %s "$&#123;HOME&#125;/.nvm" || printf %s "$&#123;XDG_CONFIG_HOME&#125;/nvm")</span>"</span>[ -s <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span> ] &amp;&amp; \. <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span></span><br></pre></td></tr></table></figure><p>  <img src="https://cdn.jsdelivr.net/gh/h5m1007/cloud-image@master/images/20200502173809.png" alt="nvm"></p><p>  é‡å¯ç»ˆç«¯ï¼Œ<code>nvm install 12.16.3</code>ï¼Œå®‰è£…åˆ¶å®šç‰ˆæœ¬ nodeã€‚</p></li></ul></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;æ–°å…¥æ‰‹çš„ mbpï¼Œéœ€è¦é‡æ–°é…ç½®ä¹‹å‰å‰ç«¯å¼€å‘çš„ç¯å¢ƒï¼Œå·²ç»å‡†å¤‡åŒæ­¥çš„å†…å®¹æœ‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Safariï¼ŒChrome ä¸¤å¤§æµ
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>å‡½æ•°ä¼˜åŒ–ç›¸å…³</title>
    <link href="https://h5m1007.github.io/2020/04/17/learn-from-optimize/"/>
    <id>https://h5m1007.github.io/2020/04/17/learn-from-optimize/</id>
    <published>2020-04-17T08:29:28.000Z</published>
    <updated>2020-04-30T09:55:14.225Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å°¾è°ƒç”¨"><a href="#å°¾è°ƒç”¨" class="headerlink" title="å°¾è°ƒç”¨"></a>å°¾è°ƒç”¨</h2><ol><li>å‡½æ•°Aå†…éƒ¨è°ƒç”¨å‡½æ•°Bï¼Œä¸”ä¸é™„åŠ å…¶å®ƒæ“ä½œ</li><li>å‡½æ•°Aåœ¨å‡½æ•°æœ€åæ‰§è¡Œé˜¶æ®µè°ƒç”¨å‡½æ•°B</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">true</span>) <span class="keyword">return</span> B();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> C()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">B</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">C</span>(<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="è°ƒç”¨å¸§-è°ƒç”¨è®°å½•"><a href="#è°ƒç”¨å¸§-è°ƒç”¨è®°å½•" class="headerlink" title="è°ƒç”¨å¸§ (è°ƒç”¨è®°å½•)"></a>è°ƒç”¨å¸§ (è°ƒç”¨è®°å½•)</h3><p>ç”¨äºå­˜å‚¨è°ƒç”¨ä½ç½®ä¸å†…éƒ¨å˜é‡ä¿¡æ¯ï¼Œæ‰€æœ‰çš„è°ƒç”¨è®°å½•å½¢æˆè°ƒç”¨æ ˆã€‚<br>å°¾è°ƒç”¨ç”±äºæ˜¯å‡½æ•°æœ€åä¸€æ­¥æ“ä½œï¼Œåˆ™ä¸éœ€ä¿ç•™å¤–å±‚fnçš„è°ƒç”¨è®°å½•ï¼Œå› ä¸ºè°ƒç”¨ä½ç½®ã€å†…éƒ¨å˜é‡ç­‰ä¿¡æ¯ä¸ä¼šå†ç”¨åˆ°ï¼Œ<br>ç”¨å†…å±‚fnçš„è°ƒç”¨è®°å½•å–ä»£å¤–å±‚fnçš„è°ƒç”¨è®°å½•å³å¯ã€‚</p><h3 id="å°¾è°ƒç”¨ä¼˜åŒ–"><a href="#å°¾è°ƒç”¨ä¼˜åŒ–" class="headerlink" title="å°¾è°ƒç”¨ä¼˜åŒ–"></a>å°¾è°ƒç”¨ä¼˜åŒ–</h3><p>åªä¿ç•™å†…å±‚fnçš„è°ƒç”¨è®°å½•ï¼Œåœ¨è°ƒç”¨è®°å½•åªæœ‰ä¸€é¡¹ä¸‹ï¼Œæå¤§ç¨‹åº¦èŠ‚çœå†…å­˜ã€‚</p><h2 id="å°¾é€’å½’"><a href="#å°¾é€’å½’" class="headerlink" title="å°¾é€’å½’"></a>å°¾é€’å½’</h2><p>å‡½æ•°é€’å½’æœ¬èº«å¾ˆè€—å†…å­˜ï¼Œå¯èƒ½å­˜åœ¨n*nçš„è°ƒç”¨è®°å½•ï¼Œå®¹æ˜“æ ˆæº¢å‡ºï¼Œå¼•å…¥å°¾é€’å½’è°ƒç”¨åï¼Œç”±äºå‡½æ•°æœ€ååªå­˜åœ¨ä¸€ä¸ªè°ƒç”¨è®°å½•ï¼Œ<br>æ‰€ä¸ä¼šå‡ºç°æ ˆæº¢å‡ºçš„é£é™©ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// né˜¶ä¹˜</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( n === <span class="number">1</span> ) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> n * factorial(n - <span class="number">1</span>); <span class="comment">// äº§ç”Ÿnä¸ªè°ƒç”¨è®°å½•ï¼Œå¤æ‚åº¦O(n)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ==&gt; å°¾é€’å½’è°ƒç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">n, total</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( n === <span class="number">1</span> ) <span class="keyword">return</span> total;</span><br><span class="line">  <span class="keyword">return</span> factorial(n - <span class="number">1</span>, n * total); <span class="comment">// å§‹ç»ˆäº§ç”Ÿ1ä¸ªè°ƒç”¨è®°å½•ï¼Œå¤æ‚åº¦O(1)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ==&gt; æŸ¯é‡ŒåŒ–å°¾é€’å½’è°ƒç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">currying</span>(<span class="params">fn, n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">m</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fn.call(<span class="keyword">this</span>, m, n)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tailFactorial</span>(<span class="params">n, total</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( n === <span class="number">1</span> ) <span class="keyword">return</span> total;</span><br><span class="line">  <span class="keyword">return</span> tailFactorial(n - <span class="number">1</span>, n * total);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> factorial = currying(tailFactorial, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å°¾è°ƒç”¨&quot;&gt;&lt;a href=&quot;#å°¾è°ƒç”¨&quot; class=&quot;headerlink&quot; title=&quot;å°¾è°ƒç”¨&quot;&gt;&lt;/a&gt;å°¾è°ƒç”¨&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;å‡½æ•°Aå†…éƒ¨è°ƒç”¨å‡½æ•°Bï¼Œä¸”ä¸é™„åŠ å…¶å®ƒæ“ä½œ&lt;/li&gt;
&lt;li&gt;å‡½æ•°Aåœ¨å‡½æ•°æœ€åæ‰§è¡Œé˜¶æ®µè°ƒç”¨å‡½æ•°B&lt;/li&gt;
&lt;/ol&gt;
&lt;f
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>å„ç§åº”ç”¨å·¥å…·ç±»å®ç°</title>
    <link href="https://h5m1007.github.io/2020/04/09/learn-from-js/"/>
    <id>https://h5m1007.github.io/2020/04/09/learn-from-js/</id>
    <published>2020-04-09T08:07:43.000Z</published>
    <updated>2020-04-30T06:38:46.783Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ·±æµ…æ‹·è´"><a href="#æ·±æµ…æ‹·è´" class="headerlink" title="æ·±æµ…æ‹·è´"></a>æ·±æµ…æ‹·è´</h2><h3 id="æµ…æ‹·è´"><a href="#æµ…æ‹·è´" class="headerlink" title="æµ…æ‹·è´"></a>æµ…æ‹·è´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> copy1 = &#123; ...&#123;<span class="attr">x</span>: <span class="number">1</span>&#125; &#125;; <span class="comment">// ...&#123;&#125; è§£æ„å®ç°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> copy2  = <span class="built_in">Object</span>.assign(&#123;&#125;, &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;); <span class="comment">// object.assign å¯¹è±¡åˆå¹¶å®ç°</span></span><br></pre></td></tr></table></figure><h3 id="æ·±æ‹·è´"><a href="#æ·±æ‹·è´" class="headerlink" title="æ·±æ‹·è´"></a>æ·±æ‹·è´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: &#123;<span class="attr">x</span>: <span class="number">3</span>&#125;&#125;;</span><br><span class="line"><span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj)); <span class="comment">// JSON.stringify åºåˆ—åŒ–å¯¹è±¡æˆå­—ç¬¦ä¸²å†è½¬å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é€’å½’å¤„ç†</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepCopy</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> copy = obj <span class="keyword">instanceof</span> <span class="built_in">Array</span> ? [] : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( <span class="keyword">let</span> k <span class="keyword">in</span> obj ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( obj.hasOwnProperty(k) ) &#123;</span><br><span class="line">      copy[k] = <span class="keyword">typeof</span> obj[k] === <span class="string">'object'</span> ? deepCopy(obj[k]) : obj[k];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> copy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¨¡æ‹ŸsetInterval"><a href="#æ¨¡æ‹ŸsetInterval" class="headerlink" title="æ¨¡æ‹ŸsetInterval"></a>æ¨¡æ‹ŸsetInterval</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">setTimeout( <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// è¿™é‡Œä¸èƒ½ç”¨ç®­å¤´å‡½æ•°ï¼Œå¦åˆ™æ‹¿ä¸åˆ° arguments</span></span><br><span class="line">  <span class="comment">// func</span></span><br><span class="line">  setTimeout( <span class="built_in">arguments</span>.callee, <span class="number">500</span>);</span><br><span class="line">&#125;, <span class="number">500</span>);</span><br></pre></td></tr></table></figure><h2 id="Event-Bus"><a href="#Event-Bus" class="headerlink" title="Event Bus"></a>Event Bus</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventBus</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.events = <span class="keyword">this</span>.events || <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  addListener( type, fn ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="keyword">this</span>.events.get(type) ) &#123;</span><br><span class="line">      <span class="keyword">this</span>.events.set(type, fn);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  emit( type ) &#123;</span><br><span class="line">    <span class="keyword">let</span> handle = <span class="keyword">this</span>.events.get(type);</span><br><span class="line"></span><br><span class="line">    handle.apply(<span class="keyword">this</span>, [...arguments].slice(<span class="number">1</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> emitter = <span class="keyword">new</span> EventBus;</span><br><span class="line"></span><br><span class="line">emitter.addListener(<span class="string">'event'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(...arguments);</span><br><span class="line">&#125;);</span><br><span class="line">emitter.emit(<span class="string">'event'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>);</span><br></pre></td></tr></table></figure><h2 id="åŒå‘ç»‘å®š"><a href="#åŒå‘ç»‘å®š" class="headerlink" title="åŒå‘ç»‘å®š"></a>åŒå‘ç»‘å®š</h2><p>ç®€æ˜“ç‰ˆä¸»è¦ç†è§£å®ç°æ ¸å¿ƒï¼Œgetter() &amp; setter()</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> input = <span class="built_in">document</span>.getElementById(<span class="string">'input'</span>);</span><br><span class="line"><span class="keyword">const</span> html = <span class="built_in">document</span>.getElementById(<span class="string">'html'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'text'</span>, &#123;</span><br><span class="line">  configurable: <span class="literal">true</span>, <span class="comment">// å¯é…ç½®ï¼Œå¦‚å¯¹å¯¹è±¡keyï¼Œvalueè¿›è¡Œé…ç½®</span></span><br><span class="line">  enumerable: <span class="literal">true</span>, <span class="comment">// å¯æšä¸¾ï¼Œå¦‚å¯¹è¢«å¾ªç¯éå†</span></span><br><span class="line">  <span class="keyword">get</span>() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'get data'</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">set</span>( newValue ) &#123;</span><br><span class="line">    input.value = newValue;</span><br><span class="line">    html.innerHTML = newValue;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">input.addEventListener( <span class="string">'keyup'</span>, e =&gt; &#123;</span><br><span class="line">  obj.text = e.target.value;</span><br><span class="line">&#125; );</span><br></pre></td></tr></table></figure><h2 id="æ»šåŠ¨æ›´æ–°"><a href="#æ»šåŠ¨æ›´æ–°" class="headerlink" title="æ»šåŠ¨æ›´æ–°"></a>æ»šåŠ¨æ›´æ–°</h2><p>æ‰€å‚ä¸è®¡ç®—çš„éœ€è¦çš„å˜é‡å€¼ï¼š</p><ol><li>å¯è§†çª—å£å¤§å°ï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ‡å‡†æµè§ˆå™¨åŠIE9+ || æ ‡å‡†æµè§ˆå™¨åŠä½ç‰ˆæœ¬IE || ä½ç‰ˆæœ¬æ··æ‚æ¨¡å¼</span></span><br><span class="line"><span class="comment">// jq: $(window).height()</span></span><br><span class="line"><span class="built_in">window</span>.innerHeight || <span class="built_in">document</span>.documentElement.clientHeight || <span class="built_in">document</span>.body.clientHeight</span><br></pre></td></tr></table></figure></li><li>çª—å£é¡¶éƒ¨ä¸æ–‡æ¡£é¡¶éƒ¨é—´çš„è·ç¦»ï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jq: $(document).scrollTop();</span></span><br><span class="line"><span class="built_in">window</span>.pageYOffset || <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop</span><br></pre></td></tr></table></figure></li><li>å…ƒç´ é¡¶éƒ¨ä¸æ–‡æ¡£é¡¶éƒ¨é—´çš„è·ç¦»ï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jq: $(el).offset().top</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getElTop</span>(<span class="params">el, initValue = <span class="number">0</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _top = el.offsetTop + initValue;</span><br><span class="line">  <span class="keyword">const</span> parent = el.offsetParent;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( parent !== <span class="literal">null</span> ) &#123;</span><br><span class="line">    _top += parent.clientTop;</span><br><span class="line">    getElTop(parent, _top); <span class="comment">// å°¾é€’å½’</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">return</span> _top;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾ªç¯å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getElTopLoop</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _top = el.offsetTop;</span><br><span class="line">  <span class="keyword">let</span> parent = el.offsetParent;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>( parent !== <span class="literal">null</span> ) &#123;</span><br><span class="line">    _top += parent.offsetTop + parent.clientTop;</span><br><span class="line">    parent = parent.offsetParent;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> _top;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// getBoundingClientRect()</span></span><br><span class="line"><span class="keyword">const</span> EL = <span class="built_in">document</span>.getElementById(<span class="string">'#el'</span>);</span><br><span class="line">EL.getBoundingClientRect().top;</span><br></pre></td></tr></table></figure></li></ol><h3 id="åœºæ™¯ï¼šåˆ¤æ–­å…ƒç´ æ˜¯å¦è¿›å…¥è§†åŒº"><a href="#åœºæ™¯ï¼šåˆ¤æ–­å…ƒç´ æ˜¯å¦è¿›å…¥è§†åŒº" class="headerlink" title="åœºæ™¯ï¼šåˆ¤æ–­å…ƒç´ æ˜¯å¦è¿›å…¥è§†åŒº"></a>åœºæ™¯ï¼šåˆ¤æ–­å…ƒç´ æ˜¯å¦è¿›å…¥è§†åŒº</h3><ol><li>æ–¹å¼ä¸€ï¼šæ ¹æ®å…ƒç´ åˆ°æ–‡æ¡£é¡¶éƒ¨çš„è·ç¦»æ˜¯å¦å°äºå½“å‰è§†å£ç›¸å¯¹äºæ–‡æ¡£é¡¶éƒ¨çš„è·ç¦»</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isInSight</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> clientHeight = <span class="built_in">window</span>.innerHeight || <span class="built_in">document</span>.documentElement.clientHeight || <span class="built_in">document</span>.body.clientHeight;</span><br><span class="line">  <span class="keyword">const</span> scrollTop = <span class="built_in">window</span>.pageYOffset || <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop;</span><br><span class="line">  <span class="keyword">const</span> scrollHeight = clientHeight + scrollTop;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> getElTop(el) &lt; scrollHeight;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImg</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( !el.src ) &#123;</span><br><span class="line">    el.src = el.</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkImgs</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> imgs = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'img'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Array</span>.from(imgs).forEach( <span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ( isInSight(img) ) &#123;</span><br><span class="line">      loadImg(el);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, checkImgs, <span class="literal">false</span>);</span><br><span class="line"><span class="built_in">window</span>.onload = checkImgs;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IntersectionObserver</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æ·±æµ…æ‹·è´&quot;&gt;&lt;a href=&quot;#æ·±æµ…æ‹·è´&quot; class=&quot;headerlink&quot; title=&quot;æ·±æµ…æ‹·è´&quot;&gt;&lt;/a&gt;æ·±æµ…æ‹·è´&lt;/h2&gt;&lt;h3 id=&quot;æµ…æ‹·è´&quot;&gt;&lt;a href=&quot;#æµ…æ‹·è´&quot; class=&quot;headerlink&quot; title=&quot;æµ…æ‹·è´&quot;&gt;&lt;/a&gt;æµ…æ‹·
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>çŸ¥è¯†æ¢³ç†ä¸€</title>
    <link href="https://h5m1007.github.io/2019/06/27/knowledge-combing/"/>
    <id>https://h5m1007.github.io/2019/06/27/knowledge-combing/</id>
    <published>2019-06-27T02:36:10.000Z</published>
    <updated>2020-04-30T06:38:46.783Z</updated>
    
    <content type="html"><![CDATA[<h2 id="éå†"><a href="#éå†" class="headerlink" title="éå†"></a>éå†</h2><ol><li><p>forå¾ªç¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ( <span class="keyword">let</span> i, len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">  <span class="comment">// ç¼“å­˜arré•¿åº¦ï¼Œè¿™ä¸€æ­¥æ–°ç‰ˆæœ¬çš„æµè§ˆå™¨å·²è‡ªè¡Œå®ç°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>forEach<br>es5çš„forEachï¼Œå®é™…æ€§èƒ½æ¯”forè¿˜å·®</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">arr.forEach( <span class="function">(<span class="params"> value, index </span>) =&gt;</span> &#123;&#125; )</span><br></pre></td></tr></table></figure><ul><li>ä¸èƒ½breakä¸­æ–­å¾ªç¯ï¼Œä¸”æ— æ³•return</li></ul><ol start="3"><li>map<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">arr.map( <span class="function">(<span class="params"> value, index </span>) =&gt;</span> &#123;&#125; )</span><br></pre></td></tr></table></figure></li></ol><ul><li>æ”¯æŒreturn</li></ul><ol start="4"><li>for-of<br>es6çš„for-of</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>( <span class="keyword">let</span> index <span class="keyword">of</span> arr ) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ”¯æŒæ•°ç»„ï¼Œç±»æ•°ç»„å¯¹è±¡ï¼Œå­—ç¬¦ä¸²</li><li>æ”¯æŒbreak, continue, return</li></ul><ol start="5"><li>for-in<br>éå†å¯¹è±¡ï¼Œå¯éå†æ•°ç»„ä½†æ•°ç»„çš„ä¸‹æ ‡ä¼šè¢«è½¬æˆå­—ç¬¦ä¸²</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  key1: <span class="string">'value1'</span>,</span><br><span class="line">  key2: <span class="string">'value2'</span>,</span><br><span class="line">  key3: <span class="string">'value3'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>( <span class="keyword">let</span> key <span class="keyword">in</span> obj ) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`obj.<span class="subst">$&#123;key&#125;</span> = <span class="subst">$&#123;obj[key]&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="6"><li>é€€å‡ºå¾ªç¯</li></ol><table><thead><tr><th align="center">åºå·</th><th align="center">æ–¹æ³•</th><th align="center">break</th><th align="center">continue</th><th align="center">return</th><th align="center">return true</th><th align="center">return false</th><th align="center">ç»“è®º</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">forå¾ªç¯</td><td align="center">æˆåŠŸ</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">ä¸åˆæ³•</td><td align="center">ä¸åˆæ³•</td><td align="center">ä¸åˆæ³•</td><td align="center">âˆš</td></tr><tr><td align="center">2</td><td align="center">Array.forEach()</td><td align="center">ä¸åˆæ³•</td><td align="center">ä¸åˆæ³•</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">Ã—</td></tr><tr><td align="center">3</td><td align="center">forâ€¦in</td><td align="center">æˆåŠŸ</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">ä¸åˆæ³•</td><td align="center">ä¸åˆæ³•</td><td align="center">ä¸åˆæ³•</td><td align="center">âˆš</td></tr><tr><td align="center">4</td><td align="center">Array.map()</td><td align="center">ä¸åˆæ³•</td><td align="center">ä¸åˆæ³•</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">Ã—</td></tr><tr><td align="center">5</td><td align="center">Array.some()</td><td align="center">ä¸åˆæ³•</td><td align="center">ä¸åˆæ³•</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">æˆåŠŸ</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">âˆš</td></tr><tr><td align="center">6</td><td align="center">Array.every()</td><td align="center">ä¸åˆæ³•</td><td align="center">ä¸åˆæ³•</td><td align="center">æˆåŠŸ</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">æˆåŠŸ</td><td align="center">âˆš</td></tr><tr><td align="center">7</td><td align="center">Array.filter()</td><td align="center">ä¸åˆæ³•</td><td align="center">ä¸åˆæ³•</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">è·³å‡ºæœ¬æ¬¡å¾ªç¯</td><td align="center">Ã—</td></tr></tbody></table><h2 id="Array-reduce"><a href="#Array-reduce" class="headerlink" title="Array.reduce()"></a>Array.reduce()</h2><p>å¯¹æ•°ç»„çš„æ¯ä¸€é¡¹å‡åºæ‰§è¡Œ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].reduce( <span class="function">(<span class="params">accumulator, currentValue, currentIndex, array</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// accumulator ç´¯è®¡å™¨ï¼Œé»˜è®¤èµ·å§‹å€¼ä¸ºinitialValue</span></span><br><span class="line">  <span class="comment">// currentValue å½“å‰å€¼</span></span><br><span class="line">  <span class="comment">// currentIndex å½“å‰å€¼ä¸‹æ ‡</span></span><br><span class="line">  <span class="comment">// arrayè°ƒç”¨reduceçš„æ•°ç»„</span></span><br><span class="line">  <span class="comment">// initialValue accumulatoré»˜è®¤èµ·å§‹å€¼ï¼Œå½“æ²¡æŒ‡å®šæ—¶åˆ™ä»¥æ•°ç»„ç¬¬ä¸€é¡¹ä¸ºå‡†</span></span><br><span class="line">&#125;, initialValue )</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;éå†&quot;&gt;&lt;a href=&quot;#éå†&quot; class=&quot;headerlink&quot; title=&quot;éå†&quot;&gt;&lt;/a&gt;éå†&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;forå¾ªç¯&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>require</title>
    <link href="https://h5m1007.github.io/2019/06/25/learn-from-requireJs/"/>
    <id>https://h5m1007.github.io/2019/06/25/learn-from-requireJs/</id>
    <published>2019-06-25T07:20:21.000Z</published>
    <updated>2020-04-30T06:38:46.783Z</updated>
    
    <content type="html"><![CDATA[<h2 id="require-ensure"><a href="#require-ensure" class="headerlink" title="require.ensure()"></a>require.ensure()</h2><ul><li>ä»£ç åˆ†éš” åŸºäºwebpackï¼Œé’ˆå¯¹ä½“ç§¯å¤§çš„æ¨¡å—å•ç‹¬å¯¼å‡ºjsæ–‡ä»¶ï¼Œç”¨äºå¼‚æ­¥è°ƒç”¨ï¼Œå¯ç»“åˆåŒæ­¥ä»£ç </li><li>ç”¨æ³•ï¼šrequire.ensure( [], fn(), â€˜â€™ )<br>å‚æ•°1ä¸ºå¼‚æ­¥å‡½æ•°çš„ä¾èµ–<br>å‚æ•°2ä¸ºå›è°ƒ, å¼‚æ­¥è°ƒç”¨çš„å‡½æ•°å†™äºè¿™é‡Œ<br>å‚æ•°3ä¸ºchunkå‘½å</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼‚æ­¥æŒ‰éœ€åŠ è½½çš„æ–¹å¼å¯¼å‡ºswiper</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">getSwiper</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(</span><br><span class="line">    res =&gt; &#123;</span><br><span class="line">      <span class="built_in">require</span>.ensure(</span><br><span class="line">        [],</span><br><span class="line">        <span class="built_in">require</span> =&gt; &#123;</span><br><span class="line">          res(<span class="built_in">require</span>(<span class="string">'xxx/swiper'</span>));</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">'chunck-swiper'</span></span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;require-ensure&quot;&gt;&lt;a href=&quot;#require-ensure&quot; class=&quot;headerlink&quot; title=&quot;require.ensure()&quot;&gt;&lt;/a&gt;require.ensure()&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;ä»£ç åˆ†éš” åŸºäºwebpa
      
    
    </summary>
    
    
    
      <category term="javascript require" scheme="https://h5m1007.github.io/tags/javascript-require/"/>
    
  </entry>
  
  <entry>
    <title>nodejs å¼€å‘è®°å½•</title>
    <link href="https://h5m1007.github.io/2019/06/25/learn-from-nodejs/"/>
    <id>https://h5m1007.github.io/2019/06/25/learn-from-nodejs/</id>
    <published>2019-06-25T07:04:45.000Z</published>
    <updated>2020-04-30T06:38:46.783Z</updated>
    
    <content type="html"><![CDATA[<h2 id="nodejsä¸­ä¸€äº›è·¯å¾„ç›¸å…³æ¦‚å¿µ"><a href="#nodejsä¸­ä¸€äº›è·¯å¾„ç›¸å…³æ¦‚å¿µ" class="headerlink" title="nodejsä¸­ä¸€äº›è·¯å¾„ç›¸å…³æ¦‚å¿µ"></a>nodejsä¸­ä¸€äº›è·¯å¾„ç›¸å…³æ¦‚å¿µ</h2><p>__dirnameï¼šè·å¾—å½“å‰æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨ç›®å½•å®Œæ•´ç›®å½•å<br>__filenameï¼šè·å¾—å½“å‰æ‰§è¡Œæ–‡ä»¶å®Œæ•´ç»å¯¹è·¯å¾„æ–‡ä»¶å<br>process.cwd()ï¼šè·å¾—å½“å‰nodeå‘½ä»¤æ‰§è¡Œç›®å½•å<br>path.resolve()ï¼šè¿”å›ç›¸å¯¹å½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;nodejsä¸­ä¸€äº›è·¯å¾„ç›¸å…³æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#nodejsä¸­ä¸€äº›è·¯å¾„ç›¸å…³æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;nodejsä¸­ä¸€äº›è·¯å¾„ç›¸å…³æ¦‚å¿µ&quot;&gt;&lt;/a&gt;nodejsä¸­ä¸€äº›è·¯å¾„ç›¸å…³æ¦‚å¿µ&lt;/h2&gt;&lt;p&gt;__dirnameï¼šè·å¾—å½“å‰æ‰§è¡Œæ–‡ä»¶
      
    
    </summary>
    
    
    
      <category term="javascript node" scheme="https://h5m1007.github.io/tags/javascript-node/"/>
    
  </entry>
  
  <entry>
    <title>react å¼€å‘è®°å½•ä¸€</title>
    <link href="https://h5m1007.github.io/2019/06/25/learn-from-react/"/>
    <id>https://h5m1007.github.io/2019/06/25/learn-from-react/</id>
    <published>2019-06-25T07:01:28.000Z</published>
    <updated>2020-04-30T06:38:46.783Z</updated>
    
    <content type="html"><![CDATA[<h2 id="exports-amp-amp-import"><a href="#exports-amp-amp-import" class="headerlink" title="exports &amp;&amp; import"></a>exports &amp;&amp; import</h2><ol><li>module exports export import<br>ç”±äºnodejsé‡‡ç”¨CommonJSæ¨¡å—è§„èŒƒï¼Œå…¶ä¸­moduleè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡å˜é‡ï¼Œæœ¬èº«çš„exportså±æ€§æ˜¯å¯¹å¤–æ¥å£ã€‚å› nodeä¸ºæ¯ä¸ªæ¨¡å—æä¾›ä¸€ä¸ªexportså˜é‡ï¼Œæ‰€ä»¥æœ‰ä¸¤ç§æ¨¡å—å¯¼å‡ºæ–¹å¼ï¼š<code>module.exports = { obj }</code> å’Œ <code>exports.obj = { obj }</code>ï¼›<br>è€ŒES6çš„exportå’Œexport defaultï¼Œå¯¼å‡ºå¯¹å¤–æ¥å£ä»¥æä¾›ç»™importå¯¼å…¥ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼š<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// export-index.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="keyword">var</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  import-index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">var</span> &#125; <span class="keyword">from</span> â€˜<span class="keyword">export</span>-indexâ€™;</span><br></pre></td></tr></table></figure>ç”±exportç›´æ¥å¯¼å‡ºçš„ï¼Œimportå¯¼å…¥å¿…é¡»æ˜¯å¯¹è±¡ä¸”éœ€çŸ¥å˜é‡å</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// export-index.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">var</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">var</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  import-index.js</span></span><br><span class="line"><span class="keyword">import</span> _var <span class="keyword">from</span> â€˜<span class="keyword">export</span>-indexâ€™;</span><br></pre></td></tr></table></figure><p>è€Œç”±export defaultå¯¼å‡ºçš„ï¼Œimportå¯¼å…¥å¯ä»¥æ˜¯è‡ªå®šä¹‰å˜é‡å</p><h2 id="class-A-extends-B"><a href="#class-A-extends-B" class="headerlink" title="class A extends B {}"></a>class A extends B {}</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line"><span class="keyword">constructor</span>(params) &#123;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">superæŒ‡å‘çˆ¶ç±»Bçš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="comment">ä½†superå†…éƒ¨çš„thisæŒ‡å‘A</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">super</span>(params); <span class="comment">// B.prototype.constructor.call(this, params)</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç»„ä»¶é—´çš„å¼•ç”¨"><a href="#ç»„ä»¶é—´çš„å¼•ç”¨" class="headerlink" title="ç»„ä»¶é—´çš„å¼•ç”¨"></a>ç»„ä»¶é—´çš„å¼•ç”¨</h2><p>å½“å­ç»„ä»¶è°ƒç”¨çˆ¶ç»„ä»¶å‡½æ•°æ—¶ï¼Œ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Parent</span></span><br><span class="line"><span class="keyword">import</span> Child <span class="keyword">from</span> <span class="string">'./child.jsx'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"><span class="keyword">constructor</span>(props) &#123;</span><br><span class="line"><span class="keyword">super</span>(props);</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.state = &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">handleFn = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"><span class="comment">// è¿™é‡Œä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œå½“å­ç»„ä»¶è°ƒç”¨æ—¶</span></span><br><span class="line"><span class="comment">// å¯ä»¥è·å¾—å½“å‰ä½œç”¨åŸŸçš„this</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Child</span> <span class="attr">handleFn</span>=<span class="string">&#123;handleFn&#125;</span> /&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Child</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"><span class="keyword">constructor</span>(props) &#123;</span><br><span class="line"><span class="keyword">super</span>(props);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line"><span class="keyword">const</span> &#123; handleFn &#125; = <span class="keyword">this</span>.props;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">&lt;div onClick=&#123; () =&gt; handleFn() &#125; /&gt;</span><br><span class="line">);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="reactä¸­çš„æ³¨é‡Šï¼š"><a href="#reactä¸­çš„æ³¨é‡Šï¼š" class="headerlink" title="reactä¸­çš„æ³¨é‡Šï¼š"></a>reactä¸­çš„æ³¨é‡Šï¼š</h2><p>1.å•è¡Œæ³¨é‡Šâ€“<br>{/* æ³¨é‡Šå†…å®¹ */} </p><p>2.å¤šè¡Œæ³¨é‡Šâ€“<br>/*<br>æ³¨é‡Š1<br>æ³¨é‡Š2<br>*/<br>psï¼šåˆ‡è®°ä¸èƒ½ç”¨ <code>&lt;!-- æ³¨é‡Š --&gt;</code></p><h2 id="react-ç”Ÿå‘½å‘¨æœŸ"><a href="#react-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="react ç”Ÿå‘½å‘¨æœŸ"></a>react ç”Ÿå‘½å‘¨æœŸ</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(props) &#123; </span><br><span class="line"><span class="comment">// åªè°ƒç”¨ä¸€æ¬¡</span></span><br><span class="line"><span class="keyword">super</span>(props); <span class="comment">// å¿…é¡»å­˜åœ¨ </span></span><br><span class="line">&#125; <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">â†“</span><br><span class="line">componentWillMount() &#123; </span><br><span class="line"><span class="comment">// åªè°ƒç”¨ä¸€æ¬¡ï¼Œæ­¤æ—¶å¯ä¿®æ”¹state</span></span><br><span class="line">&#125; <span class="comment">// ç»„ä»¶å³å°†æŒ‚è½½</span></span><br><span class="line">â†“</span><br><span class="line"><span class="comment">// ç¬¬ä¸€æ¬¡ render() &#123;&#125;</span></span><br><span class="line">â†“</span><br><span class="line">componentDidMount() &#123;</span><br><span class="line">åªè°ƒç”¨ä¸€æ¬¡ï¼Œæ­¤æ—¶çœŸå®çš„DOMå·²è¢«æ¸²æŸ“å‡ºæ¥</span><br><span class="line">&#125; <span class="comment">// ç»„ä»¶å®ŒæˆæŒ‚è½½</span></span><br><span class="line">â†“</span><br><span class="line">componentWillReceiveProps(nextProps) &#123;</span><br><span class="line"><span class="comment">// ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„props</span></span><br><span class="line"><span class="comment">// çˆ¶ç»„ä»¶å‘ç”Ÿrenderæ—¶ï¼Œå­ç»„ä»¶è°ƒç”¨</span></span><br><span class="line"><span class="comment">// å¯ç”¨äºç»„ä»¶é—´é€šä¿¡ï¼Œçˆ¶ç»„ä»¶ä½œä¸ºä¸­é—´å±‚</span></span><br><span class="line">&#125; <span class="comment">// ç»„ä»¶å³å°†æ¥æ”¶çˆ¶ç»„ä»¶å€¼</span></span><br><span class="line">â†“</span><br><span class="line">shouldComponentUpdate(nextProps, nextState) &#123;</span><br><span class="line"><span class="comment">// ç»„ä»¶æ˜¯å¦åº”å½“æ¸²æŸ“æ–°çš„propså’Œstate</span></span><br><span class="line">&#125; <span class="comment">// è¿”å›falseä¸æ‰§è¡Œä¸‹ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸ</span></span><br><span class="line">â†“</span><br><span class="line">componentWillUpdate(nextProps, nextState) &#123;</span><br><span class="line"><span class="comment">// æ¥æ”¶åˆ°æ–°çš„propså’Œstateä¹‹åï¼Œæ¸²æŸ“ä¹‹å‰</span></span><br><span class="line">&#125; <span class="comment">// ç»„ä»¶å³å°†æ›´æ–°</span></span><br><span class="line">â†“</span><br><span class="line"><span class="comment">// ç¬¬äºŒæ¬¡ render() &#123;&#125;</span></span><br><span class="line">â†“</span><br><span class="line">componentDidUpdate(prevProps, prevState) &#123;</span><br><span class="line"><span class="comment">// å®Œæˆæ–°çš„propså’Œstateæ›´æ–°ï¼Œæ¸²æŸ“ä¹‹åè°ƒç”¨</span></span><br><span class="line"><span class="comment">// æ­¤æ—¶å¯è®¿é—®çœŸå®DOM</span></span><br><span class="line">&#125; <span class="comment">// ç»„ä»¶å®Œæˆæ›´æ–°</span></span><br><span class="line">â†“</span><br><span class="line">componentWillUnmount() &#123;</span><br><span class="line"><span class="comment">// ç»„ä»¶è¢«ç§»é™¤å‰è°ƒç”¨</span></span><br><span class="line">&#125; <span class="comment">// ç»„ä»¶å¸è½½</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨renderé˜¶æ®µï¼Œåªèƒ½ç» this.prop å’Œ this.state è®¿é—®æ•°æ®ï¼Œä¸èƒ½æ”¹å˜çŠ¶æ€ï¼Œä¸èƒ½ä¿®æ”¹DOMè¾“å‡º</li></ul><h2 id="react-æŒ‡å®šä½ç½®render"><a href="#react-æŒ‡å®šä½ç½®render" class="headerlink" title="react æŒ‡å®šä½ç½®render"></a>react æŒ‡å®šä½ç½®render</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChildComponent</span> <span class="title">extend</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">close</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> div = <span class="built_in">document</span>.createElement(<span class="string">'childClass'</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> ( div ) &#123;</span><br><span class="line">    ReactDOM.unmountComponentAtNode(div);</span><br><span class="line">    div.parentNode.removeChild(div);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> div = <span class="built_in">document</span>.createElement(<span class="string">'childClass'</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> ( !div ) &#123;</span><br><span class="line">    div = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">    div.className = <span class="string">'childClass'</span>;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(div);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">ChildComponent</span> /&gt;</span></span>, div);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€§èƒ½ç¯‡"><a href="#æ€§èƒ½ç¯‡" class="headerlink" title="æ€§èƒ½ç¯‡"></a>æ€§èƒ½ç¯‡</h1><ol><li><p>ä½¿ç”¨ pureComponent<br>å†…éƒ¨å¤„ç†çš„æ˜¯æµ…æ¯”è¾ƒï¼Œåº”ç”¨äºä¸šåŠ¡åœºæ™¯ï¼Œæ•°æ®å˜åŒ–ä¸å¤æ‚çš„æƒ…å†µ</p></li><li><p>defaultProps åˆå§‹åŒ–ç»„ä»¶å±æ€§å€¼<br>å¼•å…¥ ``, é¿å…ç»„ä»¶é‡å¤æ¸²æŸ“</p></li><li><p>å±•ç¤ºç»„ä»¶ / å®¹å™¨ç»„ä»¶<br>æŠ½ç¦»ä¸šåŠ¡é€»è¾‘è‡³å®¹å™¨ç»„ä»¶ï¼Œçº¯ UI å±‚é¢æ”¾ç½®å±•ç¤ºç»„ä»¶</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Layout <span class="keyword">from</span> <span class="string">'./Layout'</span>; <span class="comment">// å±•ç¤ºç»„ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">LayoutContainer</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"><span class="comment">// ...ä¸šåŠ¡é€»è¾‘ fn</span></span><br><span class="line">render() &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Layout</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¼å‡ºæ¥å—å±•ç¤ºç»„ä»¶çš„å‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">Component</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="title">Container</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">render() &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Component</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;exports-amp-amp-import&quot;&gt;&lt;a href=&quot;#exports-amp-amp-import&quot; class=&quot;headerlink&quot; title=&quot;exports &amp;amp;&amp;amp; import&quot;&gt;&lt;/a&gt;exports &amp;amp;&amp;amp
      
    
    </summary>
    
    
    
      <category term="react" scheme="https://h5m1007.github.io/tags/react/"/>
    
  </entry>
  
  <entry>
    <title>dva</title>
    <link href="https://h5m1007.github.io/2019/06/21/dva/"/>
    <id>https://h5m1007.github.io/2019/06/21/dva/</id>
    <published>2019-06-21T08:39:37.000Z</published>
    <updated>2020-04-30T06:38:46.783Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DVA"><a href="#DVA" class="headerlink" title="DVA"></a>DVA</h1><hr><h3 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ /dist/                    <span class="comment"># ç¼–è¯‘æ‰“åŒ…åç›®å½•</span></span><br><span class="line">â”œâ”€â”€ /src/                     <span class="comment"># æºç ç›®å½•</span></span><br><span class="line">â”‚ â”œâ”€â”€ /assets/                <span class="comment"># é™æ€èµ„æºç›®å½•</span></span><br><span class="line">â”‚ â”œâ”€â”€ /components/            <span class="comment"># UIç»„ä»¶ç›®å½•</span></span><br><span class="line">â”‚ â”‚ â”œâ”€â”€ /Forbid/              <span class="comment"># ä¸šåŠ¡ç›¸å…³ç»„ä»¶</span></span><br><span class="line">â”‚ â”‚ â”‚ â””â”€â”€ forbid.css          </span><br><span class="line">â”‚ â”‚ â”‚ â””â”€â”€ index.js            </span><br><span class="line">â”‚ â”œâ”€â”€ /containers/            <span class="comment"># å®¹å™¨ç»„ä»¶ç›®å½•</span></span><br><span class="line">â”‚ â”‚ â””â”€â”€ Forbid.js             </span><br><span class="line">â”‚ â”œâ”€â”€ /models/                <span class="comment"># Model ä¸€ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªmodel</span></span><br><span class="line">â”‚ â”œâ”€â”€ /services/              <span class="comment"># å„æ¨¡å—æ¥å£è¯·æ±‚</span></span><br><span class="line">â”‚ â”œâ”€â”€ /utils/                 <span class="comment"># å…¬ç”¨å·¥å…·</span></span><br><span class="line">â””â”€â”€ index.ejs                 </span><br><span class="line">â””â”€â”€ index.js                  <span class="comment"># å…¥å£æ–‡ä»¶</span></span><br><span class="line">â””â”€â”€ router.js                 <span class="comment"># è·¯ç”±æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><h2 id="component"><a href="#component" class="headerlink" title="component"></a>component</h2><hr><p>UIç»„ä»¶ï¼Œç”±å¼€å‘è€…æä¾›ï¼Œè´Ÿè´£UIè§†è§‰å±‚ï¼›æ‰€æœ‰æ•°æ®ç”±propsæä¾›ï¼Œä¸é€‚ç”¨ä»»ä½• <code>Redux</code> çš„ API</p><h2 id="container"><a href="#container" class="headerlink" title="container"></a>container</h2><hr><p>å®¹å™¨ç»„ä»¶ï¼Œç”± <code>react-redux</code> è‡ªåŠ¨ç”Ÿæˆï¼Œç®¡ç†æ•°æ®åŠä¸šåŠ¡é€»è¾‘ï¼Œä¸è´Ÿè´£UIå®ç°ï¼›ä½¿ç”¨ <code>Redux</code> çš„ API</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">const UiComponent &#x3D; (&#123;state, dispatch, location, history&#125;) &#x3D;&gt; ();</span><br><span class="line"></span><br><span class="line">const mapStateToProps &#x3D; (state, ownProps) &#x3D;&gt; state;</span><br><span class="line"></span><br><span class="line">const mapDispatchToProps &#x3D; (dispatch, ownProps) &#x3D;&gt; &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        onAction: () &#x3D;&gt; &#123;</span><br><span class="line">            dispatch(&#123;</span><br><span class="line">                type: &#39;&#39;,</span><br><span class="line">                &#123;data&#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export connect(</span><br><span class="line">    mapStateToProps,</span><br><span class="line">    mapDispatchToProps</span><br><span class="line">)(UiComponent);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ç»connectåçš„ç»„ä»¶ï¼Œå¯è·å–åˆ°state, dispatch, location, history</span><br></pre></td></tr></table></figure><h2 id="model"><a href="#model" class="headerlink" title="model"></a>model</h2><hr><p>dvaæœ€ä¸ºé‡è¦çš„éƒ¨åˆ†ï¼Œå¯å½“åšæ˜¯å¯¹reduxã€react-reduxã€redux-sagaçš„å°è£…</p><h3 id="namespace"><a href="#namespace" class="headerlink" title="namespace"></a>namespace</h3><p>modelçš„å‘½åç©ºé—´ï¼Œå…¨å±€stateçš„ä¸€ä¸ªå±æ€§ï¼Œå³state.namespace</p><h3 id="state"><a href="#state" class="headerlink" title="state"></a>state</h3><p>å¯¹åº”çš„æ˜¯ <code>reducer</code> çš„ <code>initialState</code></p><p><strong>é¢å¤–è¯´æ˜</strong><br>react çš„ state å’Œ redux çš„ state ä¸æ˜¯ä¸€ä¸ªæ€§è´¨çš„ä¸œè¥¿ï¼Œreact ä¸­çš„ state æ˜¯ç»„ä»¶å†…éƒ¨æœ¬èº«çš„çŠ¶æ€ï¼Œè€Œ redux çš„ state åˆ™æ˜¯ redux æœ¬èº«çš„æ•°æ®ï¼Œæä¾›ç»™ react ä½¿ç”¨ï¼Œredux ä¹Ÿå¯æä¾›ç»™å…¶å®ƒæ¡†æ¶ä½¿ç”¨ã€‚</p><h3 id="subscription"><a href="#subscription" class="headerlink" title="subscription"></a>subscription</h3><p><em>dom readyåæ‰§è¡Œ</em><br>è®¢é˜…æŸäº›æ•°æ®æºï¼Œæ ¹æ®æƒ…å†µ <code>dispatch</code> æŸäº› <code>action</code></p><h3 id="effects"><a href="#effects" class="headerlink" title="effects"></a>effects</h3><p>å¯¹åº”çš„æ˜¯ <code>redux-saga</code>ï¼Œç®€åŒ–äº†ä½¿ç”¨æ–¹å¼<br>å¤„ç†å¼‚æ­¥æ“ä½œï¼Œå‘èµ·å¼‚æ­¥actionï¼Œ<em>ä¸èƒ½ç›´æ¥ä¿®æ”¹state</em><br>æœ¬èº«ä¸ºå¯¹è±¡ï¼Œå­˜æ”¾çš„åªèƒ½æ˜¯ <code>generator</code> ç”Ÿæˆå™¨å‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°æºå¸¦ä¸¤ä¸ªå‚æ•° <code>action</code> å’Œ <code>effects</code>ï¼Œ<br>è€Œ <code>effects</code> åŒ…å« <code>put</code>ã€<code>call</code>ã€<code>select</code> ä¸‰ä¸ªå­—æ®µï¼Œå…¶ä¸­ <code>put</code> è§¦å‘ <code>action</code>ï¼Œ<code>call</code> è°ƒç”¨å¼‚æ­¥å¤„ç†é€»è¾‘ï¼Œ<code>select</code> ä» <code>state</code> ä¸­è·å–æ•°æ®</p><h3 id="reducers"><a href="#reducers" class="headerlink" title="reducers"></a>reducers</h3><p>å‘èµ·åŒæ­¥action<br><em>å”¯ä¸€å¯ä»¥ä¿®æ”¹stateçš„åœ°æ–¹</em><br>æœ¬èº«ä¸ºå¯¹è±¡ï¼Œå­˜æ”¾çš„æ¯ä¸ªå‡½æ•°éƒ½æºå¸¦ä¸¤ä¸ªå‚æ•°ï¼š<code>state</code> å’Œ <code>action</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;DVA&quot;&gt;&lt;a href=&quot;#DVA&quot; class=&quot;headerlink&quot; title=&quot;DVA&quot;&gt;&lt;/a&gt;DVA&lt;/h1&gt;&lt;hr&gt;
&lt;h3 id=&quot;ç›®å½•ç»“æ„&quot;&gt;&lt;a href=&quot;#ç›®å½•ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;ç›®å½•ç»“æ„&quot;&gt;&lt;/
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>docker</title>
    <link href="https://h5m1007.github.io/2019/06/21/docker/"/>
    <id>https://h5m1007.github.io/2019/06/21/docker/</id>
    <published>2019-06-21T07:29:09.000Z</published>
    <updated>2020-04-30T06:38:46.783Z</updated>
    
    <content type="html"><![CDATA[<h1 id="dockerfile-å’Œ-docker-compose-çš„å…³ç³»"><a href="#dockerfile-å’Œ-docker-compose-çš„å…³ç³»" class="headerlink" title="dockerfile å’Œ docker-compose çš„å…³ç³»"></a>dockerfile å’Œ docker-compose çš„å…³ç³»</h1><p>èƒŒæ™¯æ˜¯éœ€è¦æ­å»ºä¸ªwordpressã€‚</p><p>Q: å‡å¦‚ä½ ä¸ç”¨ docker ï¼Œæ­å»º wordpress æ€ä¹ˆå¼„ï¼Ÿ<br>A: å…ˆæ‰¾å° server ï¼Œå‡è®¾å…¶ OS ä¸º Ubuntu ï¼Œç„¶åæŒ‰ç…§æ–‡æ¡£ä¸€æ­¥æ­¥æ•²å‘½ä»¤ï¼Œå†™é…ç½®.</p><p>Q: ç”¨ docker å‘¢ï¼Ÿ<br>A: éšä¾¿æ‰¾å° server ï¼Œä¸ç®¡ä»€ä¹ˆæ“ä½œç³»ç»Ÿï¼Œåªè¦æ”¯æŒ docker å°±è¡Œï¼Œ<br>æ‰§è¡Œç»ˆç«¯å‘½ä»¤ <code>docker run ubuntu</code>ï¼Œdocker ä¼šä»å®˜æ–¹æºé‡Œæ‹‰å–æœ€æ–°çš„ Ubuntu é•œåƒï¼Œ<br>å¯ä»¥è®¤ä¸ºä½ å¼€äº†ä¸ª Ubuntu è™šæ‹Ÿæœºï¼Œç„¶åä¸€æ­¥æ­¥å®‰è£…ï¼Œè·Ÿä¸Šé¢ä¸€æ ·ã€‚</p><p>BUTï¼Œä½†æ˜¯è¿™æ ·å®‰è£…æœ‰ä¸ªæ˜¾è‘—çš„ç¼ºç‚¹ï¼Œä¸€æ—¦ container (å®¹å™¨) è¢«åˆ ï¼Œä½ åšçš„å·¥ä½œå°±éƒ½æ²¡äº†ã€‚<br>å½“ç„¶å¯ä»¥ç”¨å‘½ä»¤<code>docker commit</code> æ¥ä¿å­˜æˆé•œåƒï¼Œè¿™æ ·å°±å¯ä»¥å¤ç”¨äº†ã€‚</p><p>ä½†æ˜¯é•œåƒä¸€èˆ¬æ¯”è¾ƒå¤§ï¼Œè€Œä¸”åªåˆ†äº«é•œåƒçš„è¯ï¼Œåˆ«äººä¹Ÿä¸çŸ¥é“ä½ è¿™é•œåƒåˆ°åº•åŒ…å«ä»€ä¹ˆï¼Œ<br>è¿™äº›é—®é¢˜éƒ½ä¸åˆ©äºåˆ†äº«å’Œå¤ç”¨ã€‚ä¸€ä¸ªç›´è§‚çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ï¼Œå†™ä¸ªè„šæœ¬æŠŠå®‰è£…è¿‡ç¨‹å…¨éƒ¨è®°å½•ä¸‹æ¥ï¼Œ<br>è¿™æ ·å†æ¬¡å®‰è£…çš„æ—¶å€™ï¼Œæ‰§è¡Œè„šæœ¬å°±è¡Œäº†ã€‚</p><p>è€Œ Dockerfile å°±æ˜¯è¿™æ ·çš„è„šæœ¬ï¼Œå®ƒè®°å½•äº†ä¸€ä¸ªé•œåƒçš„åˆ¶ä½œè¿‡ç¨‹ã€‚æœ‰äº† <em>Dockerfile</em>, åªè¦æ‰§è¡Œ<br><code>docker build</code> ï¼Œå°±èƒ½åˆ¶ä½œé•œåƒï¼Œè€Œä¸” <em>Dockerfile</em> å°±æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œä¿®æ”¹ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚</p><p>ç°åœ¨æœ‰äº† wordpress çš„é•œåƒï¼Œåªéœ€è¦ docker run å°±æŠŠ wordpress å¯åŠ¨èµ·æ¥äº†ã€‚</p><p>å¦‚æœä»…ä»…æ˜¯ wordpress, è¿™ä¹Ÿå°±å¤Ÿäº†ã€‚ä½†æ˜¯å¾ˆå¤šæ—¶å€™ï¼Œéœ€è¦å¤šä¸ªé•œåƒåˆä½œæ‰èƒ½å¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼Œ<br>æ¯”å¦‚å‰ç«¯è¦æœ‰ nginx ï¼Œæ•°æ®åº“ mysql , é‚®ä»¶æœåŠ¡ç­‰ç­‰ï¼Œå½“ç„¶ä½ å¯ä»¥æŠŠæ‰€æœ‰è¿™äº›éƒ½å¼„åˆ°ä¸€ä¸ªé•œåƒé‡Œå»ï¼Œ<br>ä½†è¿™æ ·åšå°±æ— æ³•å¤ç”¨äº†ã€‚æ›´å¸¸è§çš„æ˜¯, nginx, mysql, smtp éƒ½åˆ†åˆ«æ˜¯ä¸ªé•œåƒï¼Œç„¶åè¿™äº›é•œåƒåˆä½œï¼Œ<br>å…±åŒæœåŠ¡ä¸€ä¸ªé¡¹ç›®ã€‚<em>docker-compose</em> å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚ä½ çš„é¡¹ç›®éœ€è¦å“ªäº›é•œåƒï¼Œæ¯ä¸ªé•œåƒæ€ä¹ˆ<br>é…ç½®ï¼Œè¦æŒ‚è½½å“ªäº› volume, ç­‰ç­‰ä¿¡æ¯éƒ½åŒ…å«åœ¨ docker-compose.yml é‡Œã€‚è¦å¯åŠ¨æœåŠ¡ï¼Œ<br>åªéœ€è¦æ‰§è¡Œå‘½ä»¤ <code>docker-compose up</code> å°±è¡Œï¼Œåœæ­¢ä¹Ÿåªéœ€è¦ <code>docker-compse stop/down</code>ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼Œ <em>Dockerfile</em> è®°å½•å•ä¸ªé•œåƒçš„æ„å»ºè¿‡ç¨‹ï¼Œ<em>docker-compse.yml</em> è®°å½•ä¸€ä¸ª<br>é¡¹ç›®(project, ä¸€èˆ¬æ˜¯å¤šä¸ªé•œåƒ)çš„æ„å»ºè¿‡ç¨‹ã€‚</p><p>è‡³äºç»“åˆä½¿ç”¨ dockerfile+docker-compose, æ˜¯å› ä¸º <em>docker-compose.yml</em> æœ¬èº«æ²¡æœ‰é•œåƒ<br>æ„å»ºçš„ä¿¡æ¯ï¼Œå¦‚æœé•œåƒæ˜¯ä» <code>docker registry</code> æ‹‰å–ä¸‹æ¥çš„ï¼Œé‚£ä¹ˆ <em>Dockerfile</em> å°±ä¸éœ€è¦ï¼›<br>å¦‚æœé•œåƒæ˜¯éœ€è¦ build çš„ï¼Œé‚£å°±éœ€è¦æä¾› <em>Dockerfile</em>ã€‚</p><h1 id="Dockerfileã€Dockeré•œåƒå’Œ-Dockerå®¹å™¨çš„å…³ç³»"><a href="#Dockerfileã€Dockeré•œåƒå’Œ-Dockerå®¹å™¨çš„å…³ç³»" class="headerlink" title="Dockerfileã€Dockeré•œåƒå’Œ Dockerå®¹å™¨çš„å…³ç³»"></a>Dockerfileã€Dockeré•œåƒå’Œ Dockerå®¹å™¨çš„å…³ç³»</h1><p><a href="http://blog.csdn.net/zhousenshan/article/details/51501734" target="_blank" rel="noopener">click</a></p><h1 id="Dockerfile-è¯¦è§£"><a href="#Dockerfile-è¯¦è§£" class="headerlink" title="Dockerfile è¯¦è§£"></a>Dockerfile è¯¦è§£</h1><p><a href="http://blog.csdn.net/mozf881/article/details/55798811" target="_blank" rel="noopener">click</a></p><h1 id="å¤šè¿›ç¨‹ç®¡ç†å·¥å…·-Supervisor-Dockerfile"><a href="#å¤šè¿›ç¨‹ç®¡ç†å·¥å…·-Supervisor-Dockerfile" class="headerlink" title="å¤šè¿›ç¨‹ç®¡ç†å·¥å…· - Supervisor + Dockerfile"></a>å¤šè¿›ç¨‹ç®¡ç†å·¥å…· - Supervisor + Dockerfile</h1><p><a href="https://www.linuxprobe.com/docker-process-management1.html" target="_blank" rel="noopener">click</a></p><h1 id="linux-docker-dockerfile-supervisor-ç»ˆç«¯å‘½ä»¤å›å¿†å½•"><a href="#linux-docker-dockerfile-supervisor-ç»ˆç«¯å‘½ä»¤å›å¿†å½•" class="headerlink" title="linux + docker + dockerfile + supervisor ç»ˆç«¯å‘½ä»¤å›å¿†å½•"></a>linux + docker + dockerfile + supervisor ç»ˆç«¯å‘½ä»¤å›å¿†å½•</h1><p>æŸ¥çœ‹ç«¯å£æƒ…å†µ<br><code>netstat -ntlp</code></p><p>æŸ¥çœ‹ç«¯å£æ˜ å°„å…³ç³»<br><code>iptables -t nat -L -n</code></p><p>ç«¯å£æ˜ å°„ - linux<br><code>iptables -t nat -A DOCKER -p tcp --dport 8001 -j DNAT --to-destination x.x.x.x:8000</code></p><p>sudo docker run â€“detach <br>  â€“hostname gitlab.example.com <br>  â€“publish 443:443 â€“publish 88:80 â€“publish 23:22 <br>  â€“name gitlab <br>  â€“restart always <br>  â€“volume /srv/gitlab/config:/etc/gitlab <br>  â€“volume /srv/gitlab/logs:/var/log/gitlab <br>  â€“volume /srv/gitlab/data:/var/opt/gitlab <br>  gitlab/gitlab-ce:latest</p><p>å…³é—­ç«¯å£æ˜ å°„å…³ç³» (éœ€è¦é‡å¯ç”Ÿæ•ˆ)<br><code>iptables -A DOCKER -p tcp --dport 8001 -j DROP</code></p><p>ç«¯å£æ˜ å°„ - mac<br><code>lsof -i -P | grep docke</code><br><code>sudo vim /etc/pf.anchors/eclipse.tomcat.forwarding</code><br><code>rdr pass on lo0 inet proto tcp from any to 127.0.0.1 port 3333 -&gt; x.x.x.x port 3333</code><br><code>sudo pfctl -ef /etc/pf-tomcat.conf</code></p><h1 id="å¯¼è‡´dockerè‡ªå¯ä¸äº†å¯èƒ½çš„åŸå› "><a href="#å¯¼è‡´dockerè‡ªå¯ä¸äº†å¯èƒ½çš„åŸå› " class="headerlink" title="å¯¼è‡´dockerè‡ªå¯ä¸äº†å¯èƒ½çš„åŸå› "></a>å¯¼è‡´dockerè‡ªå¯ä¸äº†å¯èƒ½çš„åŸå› </h1><ol><li>å®¿ä¸»æœºè‡ªå¯æœåŠ¡çš„ç«¯å£ä¸å®¹å™¨è‡ªå¯æœåŠ¡ç«¯å£æœ‰å†²çª</li></ol><p>æŸ¥çœ‹dockerå®¹å™¨IP<br><code>docker inspect auto_testing | grep IPAddress</code></p><p>æŸ¥çœ‹æ­£åœ¨è¿è¡Œå®¹å™¨ &amp; æŸ¥çœ‹æ‰€æœ‰åŒ…æ‹¬åœæ­¢çš„å®¹å™¨<br><code>docker ps</code> &amp; <code>docker ps -a</code></p><p>å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨<br><code>docker start auto_testing</code></p><p>è¿›å…¥å®¹å™¨å¹¶æ‰§è¡ŒæŒ‡å®šå‘½ä»¤ï¼ˆCtrl + P + Q é€€å‡ºå®¹å™¨ä¿æŒåå°è¿è¡Œï¼‰<br><code>docker exec -it auto_testing /bin/bash</code></p><p>æŸ¥çœ‹å®¹å™¨åœ¨å®ƒç”Ÿå‘½å‘¨æœŸçš„è®°å½•<br><code>docker logs auto_testing</code><br><em>æ³¨æ„äº‹é¡¹</em> å½“runå®¹å™¨åï¼Œå¯åŠ¨ä¸äº†å®¹å™¨ï¼Œæ£€æŸ¥ä¸‹logå¯å‘ç°é—®é¢˜</p><p>åŸºäºç°æœ‰å®¹å™¨æäº¤é•œåƒè‡³æœ¬åœ°åº“<br><code>docker commit -m=&quot;for auto testing&quot; --author=&quot;xxx&quot; auto_testing auto_testing/ubuntu:v1</code></p><p>pullä¸‹æ¥çš„é•œåƒå¯èƒ½æŸäº›å·¥å…·ç¼ºå¤±<br><code>apt-get update &amp;&amp; \apt-get install -y vim procps net-tools git</code></p><p>åå°å¯åŠ¨å®¹å™¨å¹¶æŒ‡å®šç«¯å£æ˜ å°„<br><code>docker run --restart=always --name auto_testing_v1 -d -p 8360:8360 -p 27018:27017 -p 9002:9001 auto_testing/ubuntu:v1 supervisord -n -c /etc/supervisord.conf</code></p><p><code>docker run --restart=always --privileged --name auto_testing \-d -p 8360:8360 -p 27018:27017 -p 9002:9001 \ubuntu/auto_testing:1.0 /bin/bash \-c &quot;while true;do echo hello world; sleep;done&quot;</code></p><p><code>docker run --restart=always --privileged --name nginx-test-1 \-d -p 80:80 nginx /bin/bash \-c &quot;while true;do echo hello world; sleep;done&quot;-v /pengzhiyang/nginx/conf.d:/etc/nginx/conf.d \</code></p><p>å®‰è£…supervisor<br><code>yum install python-setuptools</code></p><p>ç”Ÿæˆsupervisoré…ç½®æ–‡ä»¶æ¨¡æ¿</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">easy_install supervisor</span><br><span class="line">echo_supervisord_conf &gt; &#x2F;etc&#x2F;supervisord.conf</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨é…ç½®æ–‡ä»¶å¯ç”¨supervisor<br><code>supervisord -c /etc/supervisord.conf</code></p><p>æŸ¥çœ‹è¿è¡Œè¿›ç¨‹<br><code>supervisorctl status</code></p><p>åœç”¨supervisor<br><code>supervisorctl shutdown</code></p><p>#auto_testing å®¹å™¨å·²éƒ¨ç½²çš„æ¨¡å—</p><ol><li>ç³»ç»Ÿubuntu</li><li>git</li><li>node</li><li>mongo<br>å®‰è£…è·¯å¾„ï¼š<code>/projects/mongodb</code></li></ol><p>é…ç½®ç¯å¢ƒå˜é‡<br><code>vi /etc/profile</code><br>æœ«è¡Œä½ç½®æ–°å¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export MONGODB_HOME&#x3D;&#x2F;projects&#x2F;mongodb</span><br><span class="line">export PATH&#x3D;&#x2F;projects&#x2F;mongodb&#x2F;bin:$PATH</span><br></pre></td></tr></table></figure><p><code>vi /etc/rc.local</code><br>é…ç½®å¼€æœºå¯åŠ¨æœåŠ¡(åå°è¿è¡Œ)ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;projects&#x2F;mongodb&#x2F;bin&#x2F;mongod \</span><br><span class="line">--fork --port 27017 \</span><br><span class="line">--dbpath&#x3D;&#x2F;projects&#x2F;mongodb&#x2F;db \</span><br><span class="line">--logpath&#x3D;&#x2F;projects&#x2F;mongodb&#x2F;logs&#x2F;mongodb.log --logappend</span><br></pre></td></tr></table></figure><p>å–æ¶ˆå ç”¨<br><code>rm -rf /projects/mongodb/db/mongod.lock</code></p><p>æŸ¥çœ‹è¿›ç¨‹å ç”¨<br><code>netstat -ntpl</code></p><p>å¼ºåˆ¶æ€æ‰å ç”¨è¿›ç¨‹<br><code>kill -s 9 [pid]</code></p><ol start="5"><li>supervisor è¿›ç¨‹æ§åˆ¶ç®¡ç†</li></ol><h2 id="dockeré‡Œå®‰è£…ubuntuï¼Œubuntué‡Œå†å®‰è£…docker"><a href="#dockeré‡Œå®‰è£…ubuntuï¼Œubuntué‡Œå†å®‰è£…docker" class="headerlink" title="dockeré‡Œå®‰è£…ubuntuï¼Œubuntué‡Œå†å®‰è£…docker"></a>dockeré‡Œå®‰è£…ubuntuï¼Œubuntué‡Œå†å®‰è£…docker</h2><ol><li><code>docker pull ubuntu</code></li><li><code>docker run -it -d --privileged --name xxx ubuntu</code></li><li><code>docker exec -it xxx /bin/bash</code></li><li><code>apt-get update</code></li><li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">apt-get -y install \</span><br><span class="line">    apt-transport-https \</span><br><span class="line">    ca-certificates \</span><br><span class="line">    curl \</span><br><span class="line">    software-properties-common \</span><br><span class="line">    net-tools \</span><br><span class="line">    iptables</span><br></pre></td></tr></table></figure></li><li><code>curl -fsSL get.docker.com -o get-docker.sh</code></li><li><code>sh get-docker.sh --mirror Aliyun</code></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;dockerfile-å’Œ-docker-compose-çš„å…³ç³»&quot;&gt;&lt;a href=&quot;#dockerfile-å’Œ-docker-compose-çš„å…³ç³»&quot; class=&quot;headerlink&quot; title=&quot;dockerfile å’Œ docker-compose çš„å…³
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>nodeæ”¯æŒES6è¯­æ³•é…ç½®</title>
    <link href="https://h5m1007.github.io/2018/10/15/node_support_es6/"/>
    <id>https://h5m1007.github.io/2018/10/15/node_support_es6/</id>
    <published>2018-10-15T03:31:00.000Z</published>
    <updated>2020-04-30T06:38:46.782Z</updated>
    
    <content type="html"><![CDATA[<p>è®©nodeæ”¯æŒES6è¯­æ³•çš„é…ç½®æ–¹æ¡ˆ</p><h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;babel-cli&quot;: &quot;^6.26.0&quot;,</span><br><span class="line">&quot;babel-plugin-transform-runtime&quot;: &quot;^6.23.0&quot;,</span><br><span class="line">&quot;babel-preset-es2015&quot;: &quot;^6.24.1&quot;,</span><br><span class="line">&quot;babel-preset-stage-0&quot;: &quot;^6.24.1&quot;,</span><br><span class="line">&quot;babel-runtime&quot;: &quot;^6.26.0&quot;</span><br></pre></td></tr></table></figure><h2 id="babelrc"><a href="#babelrc" class="headerlink" title=".babelrc"></a>.babelrc</h2><ul><li>æ ¹ç›®å½•æ·»åŠ  babel é…ç½®æ–‡ä»¶ .babelrc</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;presets&quot;: [</span><br><span class="line">        &quot;es2015&quot;,</span><br><span class="line">        &quot;stage-0&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;plugins&quot;: [</span><br><span class="line">        &quot;transform-runtime&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="entry-js"><a href="#entry-js" class="headerlink" title="entry.js"></a>entry.js</h2><ul><li>åœ¨å…¥å£æ–‡ä»¶é‡Œå¼•å…¥</li></ul><p><code>require(&#39;babel-core/register&#39;);</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è®©nodeæ”¯æŒES6è¯­æ³•çš„é…ç½®æ–¹æ¡ˆ&lt;/p&gt;
&lt;h2 id=&quot;package-json&quot;&gt;&lt;a href=&quot;#package-json&quot; class=&quot;headerlink&quot; title=&quot;package.json&quot;&gt;&lt;/a&gt;package.json&lt;/h2&gt;&lt;figure 
      
    
    </summary>
    
    
      <category term="node" scheme="https://h5m1007.github.io/categories/node/"/>
    
    
      <category term="node es6" scheme="https://h5m1007.github.io/tags/node-es6/"/>
    
  </entry>
  
  <entry>
    <title>NodeJs å…¨è®°å½•å…«</title>
    <link href="https://h5m1007.github.io/2016/11/18/learn-from-nodejs/"/>
    <id>https://h5m1007.github.io/2016/11/18/learn-from-nodejs/</id>
    <published>2016-11-18T10:17:00.000Z</published>
    <updated>2020-04-30T06:38:46.782Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ç«¯ç¨‹åºçŒ¿çš„ç¬¬äºŒæ˜¥ ä½¿ç”¨è€æœ¬è¡ŒJSæ¥æ„å»ºæœåŠ¡å™¨ç«¯çš„ç¥å™¨  NodeJs</p><h2 id="Socket-IO"><a href="#Socket-IO" class="headerlink" title="Socket.IO"></a>Socket.IO</h2><p>åŸºäºWebSocketå‡ºç°çš„é—®é¢˜ï¼ŒSocket.IOåœ¨è§£å†³é—®é¢˜çš„åŒæ—¶ä¿ç•™äº†å…¶APIï¼Œä¹Ÿæä¾›äº†è‰¯å¥½çš„çµæ´»æ€§  </p><h3 id="å…¼å®¹æ€§é«˜"><a href="#å…¼å®¹æ€§é«˜" class="headerlink" title="å…¼å®¹æ€§é«˜"></a>å…¼å®¹æ€§é«˜</h3><p>Socket.IOçš„æ¶ˆæ¯ä¼ é€’æ˜¯<strong>åŸºäºä¼ è¾“</strong>çš„ï¼Œå¹¶éå…¨ä¾é WebSocketï¼Œå¯åœ¨å¤§éƒ¨åˆ†æµè§ˆå™¨å’Œè®¾å¤‡ä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬IE6åˆ°IOS  </p><h3 id="å¯é äº‹ä»¶æœºåˆ¶"><a href="#å¯é äº‹ä»¶æœºåˆ¶" class="headerlink" title="å¯é äº‹ä»¶æœºåˆ¶"></a>å¯é äº‹ä»¶æœºåˆ¶</h3><p>æä¾›å¯¹<strong>è¶…æ—¶</strong>æ”¯æŒï¼Œç›‘å¬ <code>connect</code> å’Œ <code>disconnect</code> äº‹ä»¶è€Œä¸æ˜¯ <code>open</code> å’Œ <code>close</code> äº‹ä»¶  </p><h3 id="Webé€šä¿¡æ–¹å¼"><a href="#Webé€šä¿¡æ–¹å¼" class="headerlink" title="Webé€šä¿¡æ–¹å¼"></a>Webé€šä¿¡æ–¹å¼</h3><p>å…¸å‹é€šä¿¡æ–¹å¼ç»HTTPæ”¶å‘èµ„æºï¼Œè€Œ<strong>å®æ—¶</strong>Webä¸–ç•Œä¸­ï¼Œéƒ½æ˜¯åŸºäº<strong>äº‹ä»¶ä¼ è¾“</strong>çš„  </p><p>Socket.IOé€šè¿‡åˆ†å‘ (<code>emit</code>) å’Œ ç›‘å¬ (<code>listen</code>) æ¥è¿›è¡ŒJSONæ•°æ®æ”¶å‘  </p><p>WebSocket.IOæ–¹å¼  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    ws.on(&#39;connection&#39;, function(socket)&#123;</span><br><span class="line">        socket.on(&#39;message&#39;, function(msg)&#123;</span><br><span class="line">            &#x2F;&#x2F; deal with msg</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>Socket.IOæ–¹å¼  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    io.sockets.on(&#39;connection&#39;, function(socket)&#123;</span><br><span class="line">        socket.on(&#39;message&#39;, function(msg)&#123;</span><br><span class="line">            &#x2F;&#x2F; deal with msg</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="å‘½åç©ºé—´"><a href="#å‘½åç©ºé—´" class="headerlink" title="å‘½åç©ºé—´"></a>å‘½åç©ºé—´</h3><p>å‘½åç©ºé—´å³å¤šè·¯ä¼ è¾“ï¼Œsocket.ioå¯¹åŒæ ·çš„èµ„æºè¿›è¡Œ<strong>é¢‘é“åˆ’åˆ†</strong>ï¼Œå¹¶å°†æ•°æ®ä¼ è¾“ç»™å¯¹åº”çš„å›è°ƒï¼Œä¸”å…è®¸ç›‘å¬å¤šä¸ªå‘½åç©ºé—´çš„ <code>connection</code> äº‹ä»¶  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    io.sockets.on(&#39;connection&#39;);</span><br><span class="line">    io.of(&#39;&#x2F;some&#x2F;namespace&#39;).on(&#39;connection&#39;);</span><br><span class="line">    io.of(&#39;&#x2F;some&#x2F;other&#x2F;namespace&#39;).on(&#39;connection&#39;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="å®ç°å®æ—¶èŠå¤©"><a href="#å®ç°å®æ—¶èŠå¤©" class="headerlink" title="å®ç°å®æ—¶èŠå¤©"></a>å®ç°å®æ—¶èŠå¤©</h3><ol><li>å¼•å…¥expresså’Œsocket.ioæ¨¡å—å£°æ˜ä¸º <code>sio</code></li><li>expressåˆ›å»ºæœåŠ¡å¹¶å°†è¿”å›å¯¹è±¡ <code>app</code> ç»™ <code>sio</code> ç›‘å¬</li><li>è°ƒç”¨ç›‘å¬è¿”å›çš„å…¨å±€å¯¹è±¡ <code>io</code> çš„ <code>sockets</code> å±æ€§</li><li>ç”¨æ¥ç›‘å¬ <code>connection</code>ï¼Œå›è°ƒå¸¦socketå‚æ•°</li><li>è¯¥å‚æ•°åœ¨è¿æ¥åï¼Œç”¨æ¥ç›‘å¬å®¢æˆ·ç«¯åˆ†å‘çš„ <code>join</code> ç”¨æˆ·åŠ å…¥çš„äº‹ä»¶</li><li>ç›‘å¬å®¢æˆ·ç«¯åˆ†å‘çš„æ•°æ®äº‹ä»¶ <code>text</code></li><li>åœ¨ <code>join</code> äº‹ä»¶å›è°ƒä¸­ï¼Œ<code>broadcast.emit()</code> ç»™<strong>æ‰€æœ‰ç”¨æˆ·</strong>åˆ†å‘ <code>annoucement</code> äº‹ä»¶</li><li>åœ¨å®¢æˆ·ç«¯è°ƒç”¨å…¨å±€å¯¹è±¡çš„ <code>connect()</code> æ–¹æ³•</li><li>è°ƒç”¨è¿”å›çš„å¯¹è±¡ <code>socket</code> ï¼Œç”¨æ¥ç›‘å¬ <code>connect</code> äº‹ä»¶</li><li>ç›‘å¬åå›è°ƒä¸­ï¼Œä½¿ç”¨ <code>socket</code> æ¥åˆ†å‘ <code>emit</code> äº‹ä»¶å’Œç»™å›è°ƒçš„å‚æ•°</li><li>å½“å®¢æˆ·ç«¯æœ‰ç”¨æˆ·åŠ å…¥æ—¶ï¼Œåœ¨ <code>connect</code> å›è°ƒä¸­åˆ†å‘äº‹ä»¶ <code>join</code></li><li>ç›‘å¬æœåŠ¡ç«¯åˆ†å‘çš„ <code>annoucement</code> äº‹ä»¶</li><li>å½“ç”¨æˆ·æäº¤æ¶ˆæ¯æ—¶ï¼Œåˆ†å‘ <code>text</code> äº‹ä»¶å’Œç»™å›è°ƒçš„å‚æ•°</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‰ç«¯ç¨‹åºçŒ¿çš„ç¬¬äºŒæ˜¥ ä½¿ç”¨è€æœ¬è¡ŒJSæ¥æ„å»ºæœåŠ¡å™¨ç«¯çš„ç¥å™¨  NodeJs&lt;/p&gt;
&lt;h2 id=&quot;Socket-IO&quot;&gt;&lt;a href=&quot;#Socket-IO&quot; class=&quot;headerlink&quot; title=&quot;Socket.IO&quot;&gt;&lt;/a&gt;Socket.IO&lt;/h2&gt;&lt;p
      
    
    </summary>
    
    
      <category term="nodejs javascript" scheme="https://h5m1007.github.io/categories/nodejs-javascript/"/>
    
    
      <category term="nodejs express socket.io" scheme="https://h5m1007.github.io/tags/nodejs-express-socket-io/"/>
    
  </entry>
  
  <entry>
    <title>å¾®ä¿¡å°ç¨‹åº éœ€è¦çŸ¥é“çš„äº‹</title>
    <link href="https://h5m1007.github.io/2016/11/17/weixin_small_app/"/>
    <id>https://h5m1007.github.io/2016/11/17/weixin_small_app/</id>
    <published>2016-11-17T05:55:00.000Z</published>
    <updated>2020-04-30T06:38:46.782Z</updated>
    
    <content type="html"><![CDATA[<p>å¾®ä¿¡å°ç¨‹åºæ˜¯ä¸€ç§ä¸éœ€è¦ä¸‹è½½å®‰è£…å³å¯ä½¿ç”¨çš„åº”ç”¨ï¼Œå®ƒå®ç°äº†åº”ç”¨â€œè§¦æ‰‹å¯åŠâ€çš„æ¢¦æƒ³ï¼Œç”¨æˆ·æ‰«ä¸€æ‰«æˆ–è€…æœä¸€ä¸‹å³å¯æ‰“å¼€åº”ç”¨ã€‚ä¹Ÿä½“ç°äº†â€œç”¨å®Œå³èµ°â€çš„ç†å¿µï¼Œç”¨æˆ·ä¸ç”¨å…³å¿ƒæ˜¯å¦å®‰è£…å¤ªå¤šåº”ç”¨çš„é—®é¢˜ã€‚åº”ç”¨å°†æ— å¤„ä¸åœ¨ï¼Œéšæ—¶å¯ç”¨ï¼Œä½†åˆæ— éœ€å®‰è£…å¸è½½ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯å¾®ä¿¡å°ç¨‹åº"><a href="#ä»€ä¹ˆæ˜¯å¾®ä¿¡å°ç¨‹åº" class="headerlink" title="ä»€ä¹ˆæ˜¯å¾®ä¿¡å°ç¨‹åº"></a>ä»€ä¹ˆæ˜¯å¾®ä¿¡å°ç¨‹åº</h2><p>å¾®ä¿¡å°ç¨‹åºæ˜¯ä¸€ç§ä¸éœ€è¦ä¸‹è½½å®‰è£…å³å¯ä½¿ç”¨çš„åº”ç”¨  </p><p>å®ç°äº†åº”ç”¨â€œè§¦æ‰‹å¯åŠâ€çš„æ¢¦æƒ³ï¼Œç”¨æˆ·æ‰«ä¸€æ‰«æˆ–è€…æœä¸€ä¸‹å³å¯æ‰“å¼€åº”ç”¨  </p><p>ä½“ç°äº†â€œç”¨å®Œå³èµ°â€çš„ç†å¿µï¼Œç”¨æˆ·ä¸ç”¨å…³å¿ƒæ˜¯å¦å®‰è£…å¤ªå¤šåº”ç”¨çš„é—®é¢˜  </p><p>åº”ç”¨å°†æ— å¤„ä¸åœ¨ï¼Œéšæ—¶å¯ç”¨ï¼Œä½†åˆæ— éœ€å®‰è£…å¸è½½  </p><h3 id="å°ç¨‹åºå’Œå…¬ä¼—å·å†…åµŒH5æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#å°ç¨‹åºå’Œå…¬ä¼—å·å†…åµŒH5æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="å°ç¨‹åºå’Œå…¬ä¼—å·å†…åµŒH5æœ‰ä»€ä¹ˆåŒºåˆ«"></a>å°ç¨‹åºå’Œå…¬ä¼—å·å†…åµŒH5æœ‰ä»€ä¹ˆåŒºåˆ«</h3><ol><li><p>ä¸€èˆ¬å…¬ä¼—å·ä¼šåœ¨èœå•åº•éƒ¨æä¾›åŠŸèƒ½å¼•å¯¼å…¥å£ï¼Œå¼•å¯¼ç”¨æˆ·åˆ°H5é¡µé¢ï¼Œä½†H5ä½“éªŒä¸Native Appå·®è·è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œè€Œå¾®ä¿¡å°ç¨‹åºæä¾›ä¸°å¯Œæ¡†æ¶ç»„ä»¶å’ŒAPIæ¥å£ï¼Œåœ¨è¿™äº›ç»„ä»¶å’Œæ¥å£çš„å¸®åŠ©ä¸‹ï¼Œå¼€å‘åœ¨å¾®ä¿¡çš„å°ç¨‹åºåŸºæœ¬ä¿æŒä¸Native Appä¸€æ ·çš„æµç•…åº¦ï¼Œæå¤§æé«˜äº†ç”¨æˆ·ä½“éªŒ  </p></li><li><p>å¾®ä¿¡å°ç¨‹åºå¯ä»¥ç†è§£ä¸ºRNå³React Nativeï¼ŒH5å†™çš„ç¨‹åºç„¶åä»¥Native Appæ–¹å¼è¿è¡Œï¼Œå…¶åŸç†éƒ½æ˜¯ç”¨JSè°ƒç”¨åº•å±‚Nativeç»„ä»¶  </p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å¾®ä¿¡å°ç¨‹åºæ˜¯ä¸€ç§ä¸éœ€è¦ä¸‹è½½å®‰è£…å³å¯ä½¿ç”¨çš„åº”ç”¨ï¼Œå®ƒå®ç°äº†åº”ç”¨â€œè§¦æ‰‹å¯åŠâ€çš„æ¢¦æƒ³ï¼Œç”¨æˆ·æ‰«ä¸€æ‰«æˆ–è€…æœä¸€ä¸‹å³å¯æ‰“å¼€åº”ç”¨ã€‚ä¹Ÿä½“ç°äº†â€œç”¨å®Œå³èµ°â€çš„ç†å¿µï¼Œç”¨æˆ·ä¸ç”¨å…³å¿ƒæ˜¯å¦å®‰è£…å¤ªå¤šåº”ç”¨çš„é—®é¢˜ã€‚åº”ç”¨å°†æ— å¤„ä¸åœ¨ï¼Œéšæ—¶å¯ç”¨ï¼Œä½†åˆæ— éœ€å®‰è£…å¸è½½ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯å¾®ä¿¡å°ç¨‹åº&quot;&gt;&lt;a h
      
    
    </summary>
    
    
      <category term="weixin H5 js react" scheme="https://h5m1007.github.io/categories/weixin-H5-js-react/"/>
    
    
      <category term="weixin H5 js react" scheme="https://h5m1007.github.io/tags/weixin-H5-js-react/"/>
    
  </entry>
  
  <entry>
    <title>react å›å¿†å½•äºŒ</title>
    <link href="https://h5m1007.github.io/2016/11/11/learn-from-react/"/>
    <id>https://h5m1007.github.io/2016/11/11/learn-from-react/</id>
    <published>2016-11-11T02:55:00.000Z</published>
    <updated>2020-04-30T06:38:46.782Z</updated>
    
    <content type="html"><![CDATA[<p>é©å‘½æ€§åˆ›æ–° æ€§èƒ½å‡ºä¼— ä»£ç é€»è¾‘ç°å¸¸ç®€å•çš„ React</p><h2 id="ä»€ä¹ˆæ˜¯Redux"><a href="#ä»€ä¹ˆæ˜¯Redux" class="headerlink" title="ä»€ä¹ˆæ˜¯Redux"></a>ä»€ä¹ˆæ˜¯Redux</h2><p>æœ¬èº«ä¸ºä¸€ç§æ¶æ„ï¼Œå°†Fluxä¸å‡½æ•°å¼ç¼–ç¨‹ç»“åˆåœ¨ä¸€èµ·</p><h2 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h2><ol><li>ç”¨æˆ·ä½¿ç”¨æ–¹å¼å¤æ‚</li><li><strong>ä¸åŒèº«ä»½</strong>ç”¨æˆ·æ‹¥æœ‰<em>ä¸åŒä½¿ç”¨æ–¹å¼</em></li><li>å¤šç”¨æˆ·é—´å¯<strong>åä½œ</strong></li><li>ä¸<em>æœåŠ¡å™¨<em>å¤§é‡äº¤äº’ï¼Œäº¦æˆ–ä½¿ç”¨</em>WebSocket</em></li><li>Viewéœ€ä»<strong>å¤šä¸ªæ¥æº</strong>è·å–æ•°æ®</li><li>æŸç»„ä»¶çš„<em>çŠ¶æ€</em>éœ€<strong>å…±äº«</strong></li><li>æŸçŠ¶æ€éœ€åœ¨<em>ä»»ä½•åœ°æ–¹</em>éƒ½å¯æ‹¿åˆ°</li><li>å•ä¸ªç»„ä»¶éœ€æ”¹å˜<strong>å…¨å±€çŠ¶æ€</strong></li><li>ä¸€ä¸ªç»„ä»¶éœ€æ”¹å˜<em>å¦ä¸€ä¸ª</em>ç»„ä»¶çŠ¶æ€</li></ol><h2 id="è®¾è®¡æ€æƒ³"><a href="#è®¾è®¡æ€æƒ³" class="headerlink" title="è®¾è®¡æ€æƒ³"></a>è®¾è®¡æ€æƒ³</h2><ul><li>Web Appæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œè§†å›¾å’ŒçŠ¶æ€æ˜¯ä¸€ä¸€å¯¹åº”çš„</li><li>æ‰€æœ‰çŠ¶æ€ä¿å­˜è‡³ä¸€ä¸ªå¯¹è±¡é‡Œé¢</li></ul><h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><h3 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h3><p>ç”¨æ¥ä¿å­˜æ‰€æœ‰æ•°æ®çš„å®¹å™¨ï¼Œæ•´ä¸ªAppåªèƒ½æœ‰ä¸€ä¸ªï¼Œç”± <code>createStore(fn)</code> æ¥ç”Ÿæˆï¼Œæ¥å—ä¸€ä¸ªReducerå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå³åé¢æ‰€è¯´åˆ°çš„Reducerï¼Œä¸€ä¸ªç”¨æ¥æ ¹æ®Actionçš„ä¸åŒè€Œç”Ÿæˆæ­¤åˆ»çš„Stateå¿«ç…§çš„å‡½æ•°  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import &#123; createStore &#125; from &#39;redux&#39;;</span><br><span class="line">const store &#x3D; createStore(fn);</span><br></pre></td></tr></table></figure><h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><p>å½“æƒ³ä»Storeé‡Œè·å¾—<strong>æŸæ—¶é—´ç‚¹</strong>çš„æ•°æ®ï¼Œå¯å¯¹Storeç”Ÿæˆå¿«ç…§ï¼Œè€Œè¿™ç§æ—¶é—´ç‚¹ä¸‹çš„æ•°æ®é›†åˆç§°ä¸º<strong>State</strong>  </p><p>è€Œstateå‚¨å­˜åœ¨ä¸€æ£µå¯¹è±¡æ ‘state treeä¸­ï¼Œä¸”è¿™æ£µæ ‘åªå­˜åœ¨äºå”¯ä¸€çš„storeä¸­  </p><p>å½“å‰æ—¶åˆ»çš„Stateå¯ç”± <code>store.getState()</code> è·å¾—  </p><p>Stateä¸Viewä¸€ä¸€å¯¹åº”ï¼Œå³Stateç›¸åŒViewå°±ç›¸åŒ  </p><p>Stateæœ¬èº«æ˜¯<strong>åªè¯»</strong>çš„ï¼Œè€Œæ”¹å˜å®ƒçš„æ–¹æ³•å°±æ˜¯è§¦å‘action  </p><h3 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h3><p>æœ¬èº«ä¸ºä¸€ä¸ªæè¿°å·²å‘ç”Ÿäº‹ä»¶çš„å¯¹è±¡ï¼Œæ¥å—çš„å±æ€§æœ‰<strong>type</strong>(å¿…é€‰ è¡¨ç¤ºActionåç§°)å’Œå…¶å®ƒè‡ªå®šä¹‰å±æ€§  </p><p>å› Stateçš„å˜åŒ–éœ€ç”±Viewæ¥å¯¼è‡´ï¼Œè€ŒActionä¸ºViewå‘å‡ºçš„<strong>é€šçŸ¥</strong>ï¼Œå‘Šè¯‰Stateåº”æœ‰æ‰€å˜åŒ–äº†  </p><p>Actionæè¿°å½“å‰æ‰€å‘ç”Ÿçš„äº‹æƒ…ï¼Œå®ƒæ˜¯æ”¹å˜Stateçš„å”¯ä¸€åŠæ³•ï¼Œå®ƒä¼šè¿é€æ•°æ®è‡³Store  </p><p>Actionæ˜¯æŠŠæ•°æ®ä»åº”ç”¨ä¼ åˆ°storeçš„æœ‰æ•ˆè½½è·ï¼Œæ˜¯storeæ•°æ®çš„å”¯ä¸€æ¥æºï¼Œä¸€èˆ¬ç» <code>store.dispatch()</code> ä¼ actionåˆ°store  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const action &#x3D; &#123;</span><br><span class="line">    type: &#39;ADD_TODO&#39;, &#x2F;&#x2F; åç§°</span><br><span class="line">    payload: &#39;Learn Redux&#39; &#x2F;&#x2F; æºå¸¦ä¿¡æ¯</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯å°è£…ä¸€ä¸ªç”ŸæˆActionçš„å‡½æ•°ï¼Œåªéœ€æä¾›Actionçš„åç§°å³å¯  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; Action Creator</span><br><span class="line">const ADD_TODO &#x3D; &#39;æ·»åŠ  TODO&#39;;</span><br><span class="line">function addTodo(text)&#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        tyep: ADD_TODO,</span><br><span class="line">        text</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">const action &#x3D; addTodo(&#39;Learn Redux&#39;);</span><br></pre></td></tr></table></figure><h4 id="dispatch"><a href="#dispatch" class="headerlink" title="dispatch()"></a>dispatch()</h4><p><code>store.dispatch()</code>  æ˜¯Viewå‘å‡ºActionçš„å”¯ä¸€åŠæ³•ï¼Œæ¥å—Actionå¯¹è±¡ä½œä¸ºå‚æ•°  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import &#123; createStore &#125; from &#39;redux&#39;;</span><br><span class="line">const store &#x3D; createStore(fn);</span><br><span class="line">store.dispatch(addTodo(&#39;Learn redux&#39;));</span><br></pre></td></tr></table></figure><h4 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h4><p>å½“Storeæ”¶åˆ°Actionæ—¶ï¼ŒStoreéœ€ç»™å‡ºä¸€ä¸ªæ–°çš„Stateå¿«ç…§ï¼Œä»è€ŒViewæ‰ä¼šå˜åŒ–ï¼Œæ•´ä¸ªä¸€ä¸ªè¿‡ç¨‹ç§°ä¸ºReducerï¼Œå®ƒæ¥å—Actionå’Œæ­¤åˆ»çš„Stateå¿«ç…§ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„State  </p><p>å³ <code>(previousState, action) =&gt; newState</code>  </p><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ä¸ºäº†æè¿°actionæ˜¯å¦‚ä½•æ”¹å˜state treeçš„  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const defaultState &#x3D; 0;</span><br><span class="line">const reducer &#x3D; (state &#x3D; defaultState, action) &#x3D;&gt; &#123;</span><br><span class="line">    switch (action.type) &#123;</span><br><span class="line">        case &#39;ADD&#39;:</span><br><span class="line">            return state + action.payload;</span><br><span class="line">        default:</span><br><span class="line">            return state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">const state &#x3D; reducer(1, &#123;</span><br><span class="line">    type: &#39;ADD&#39;,</span><br><span class="line">    payload: 2</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„Reduceréœ€æ‰‹åŠ¨è°ƒç”¨ï¼Œè€Œå½“æŠŠå®ƒä½œä¸ºå‚æ•°ä¼ å…¥ <code>createStore(reducer)</code>ï¼Œå¯å®ç°æ¯å½“ <code>store.dispatch()</code> å‘æ¥ä¸€ä¸ªæ–°Actionæ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨Reducerå¹¶å¾—åˆ°æ–°State  </p><h5 id="Reduceræ‹†åˆ†"><a href="#Reduceræ‹†åˆ†" class="headerlink" title="Reduceræ‹†åˆ†"></a>Reduceræ‹†åˆ†</h5><p>é¢å¯¹æ‰€æœ‰reducersæœ€ç»ˆåªä¼šç”Ÿæˆå”¯ä¸€çš„stateå¯¹è±¡ï¼Œè¿™æ„å‘³ç€è¯¥stateåŒ…å«æ‰€æœ‰æ•°æ®ï¼Œå¯¼è‡´æœ¬èº«ä½“ç§¯ååˆ†åºå¤§ï¼Œè¿›è€Œæœ‰äº†å¯¹reducersçš„æ‹†åˆ†  </p><p>æ‹†åˆ†åï¼Œå•ç‹¬çš„reducerå¯ç‹¬ç«‹æ“ä½œstate treeä¸­æŸä¸ªstateï¼Œå¯æ§åˆ¶å®ƒä»¬è¢«è°ƒç”¨çš„é¡ºåºï¼Œä¼ å…¥é™„åŠ æ•°æ®ï¼Œç¼–å†™å¯å¤ç”¨çš„reduceræ¥å¤„ç†ä¸€äº›é€šç”¨ä»»åŠ¡  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">const chatReducer &#x3D; (state &#x3D; defaultState, action &#x3D; &#123;&#125;) &#x3D;&gt; &#123;</span><br><span class="line">    &#x2F;*</span><br><span class="line">     * å‡è®¾ action &#x3D; &#123;type: &#39;add&#39;, payload: &#39;str&#39;&#125;;</span><br><span class="line">     * åˆ™å£°æ˜ const &#123; type, payload &#125; &#x3D; action;</span><br><span class="line">     * è°ƒç”¨typeè¿”å›&#39;add&#39;ï¼Œè°ƒç”¨payloadè¿”å›&#39;str&#39;</span><br><span class="line">     *&#x2F;</span><br><span class="line">    const &#123; type, payload &#125; &#x3D; action; &#x2F;&#x2F; è§£æ„èµ‹å€¼</span><br><span class="line">    switch(type)&#123;</span><br><span class="line">        case &#39;ADD_CHAT&#39;:</span><br><span class="line">            return Object.assign(&#123;&#125;, state, &#123;</span><br><span class="line">                    &#x2F;&#x2F; Object.assign(&#123;&#125;, &#123;&#125;, ...) åˆå¹¶å¤šä¸ªå¯¹è±¡</span><br><span class="line">                    &#x2F;&#x2F; é‡ç›¸åŒå±æ€§æ—¶ ä½äºåé¢çš„å±æ€§è¦†ç›–å‰é¢çš„</span><br><span class="line">                    chatLog: state.chatLog.concat(payload) &#x2F;&#x2F; str.concat(str) æ‹¼æ¥æŒ‡å®šå­—ç¬¦ä¸²</span><br><span class="line">                &#125;);</span><br><span class="line">        case &#39;CHANGE_STATUS&#39;:</span><br><span class="line">            return Object.assign(&#123;&#125;, state, &#123;</span><br><span class="line">                    statusMessage: payload</span><br><span class="line">                &#125;);</span><br><span class="line">        default:</span><br><span class="line">            return state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯çœ‹å‡ºä¸Šè¿°ä»£ç ï¼Œæœ‰ä¸¤ç§Actionåˆ†åˆ«æ”¹å˜Stateçš„ä¸¤ä¸ªå±æ€§  </p><ul><li>ADD_CHAT =&gt; chatLogå±æ€§</li><li>CHANGE_STATUS =&gt; statusMessageå±æ€§</li></ul><p>æŠŠä¸Šè¿°å„ä¸ªreducerè¿›è¡Œæ‹†åˆ†  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; ä¸»reducer</span><br><span class="line">const chatReducer &#x3D; (state &#x3D; defaultState, action &#x3D; &#123;&#125;) &#x3D;&gt; &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        &#x2F;&#x2F; å­reducer</span><br><span class="line">        chatLog: chatLog(state.chatLog, action),</span><br><span class="line">        statusMessage: statusMessage(state.statusMessage, action)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯ä¸ªå­reduceråˆ†åˆ«å¤„ç†å…¨å±€stateä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå„è‡ªçš„stateå‚æ•°éƒ½æ˜¯ä¸åŒçš„ï¼Œåˆ†åˆ«å¯¹åº”å®ƒç®¡ç†çš„é‚£éƒ¨åˆ†stateæ•°æ®  </p><p>å†ç”± <code>combineReducers()</code> æ¥åˆå¹¶reduceræˆä¸€ä¸ªå¤§çš„Reducer  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import &#123; combineReducers &#125; from &#39;redux&#39;;</span><br><span class="line">const chatReducer &#x3D; combineReducers(&#123;</span><br><span class="line">    chatLog,</span><br><span class="line">    statusMessage</span><br><span class="line">&#125;)</span><br><span class="line">export default todoApp;</span><br></pre></td></tr></table></figure><h5 id="reduce"><a href="#reduce" class="headerlink" title="reduce()"></a>reduce()</h5><p>å½“ä¸€ç»„actionsä¸ºæ•°ç»„æ—¶ï¼Œå­˜å‚¨ç€å¤šä¸ªActionå¯¹è±¡ï¼Œæ­¤æ—¶å¯è°ƒç”¨ <code>actions.reduce(reducer, 0)</code> ï¼Œreducerä½œä¸ºå‚æ•°ï¼Œè¿™æ ·å¯å®ç°åŒæ—¶å¤„ç†ä¸€ä¸ªactionsæ•°ç»„çš„Actionå¯¹è±¡ï¼Œå¹¶å¾—åˆ°æœ€ç»ˆç»“æœ  </p><h4 id="subscribe"><a href="#subscribe" class="headerlink" title="subscribe()"></a>subscribe()</h4><p><code>store.subscribe(listener)</code>  Storeè®¾ç½®ç›‘å¬å‡½æ•°ï¼Œå¯å®ç°ä¸€æ—¦storeçš„å¿«ç…§stateå‘ç”Ÿå˜åŒ–åï¼Œå°±ä¼šè‡ªåŠ¨æ‰§è¡Œè¿™ä¸ªå‡½æ•°  </p><p>ç”¨äºæŠŠç»„ä»¶çš„renderæ–¹æ³•äº¦æˆ–setStateæ–¹æ³•ä½œä¸ºlistenerç›‘å¬å¯¹è±¡ï¼Œstateå˜åŒ–çš„åŒæ—¶è‡ªåŠ¨æ¸²æŸ“Viewé¡µé¢  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let unsubscribe &#x3D; store.subscribe(() &#x3D;&gt; &#123;</span><br><span class="line">    console.log(store.getState());</span><br><span class="line">&#125;);</span><br><span class="line">unsubscribe(); &#x2F;&#x2F;ç›´æ¥è°ƒç”¨èƒ½è§£é™¤ç›‘å¬</span><br></pre></td></tr></table></figure><h2 id="Reduxå·¥ä½œæµç¨‹"><a href="#Reduxå·¥ä½œæµç¨‹" class="headerlink" title="Reduxå·¥ä½œæµç¨‹"></a>Reduxå·¥ä½œæµç¨‹</h2><p><img src="http://img.blog.csdn.net/20151210233944838" alt="ç»“æ„å›¾1"></p><p><img src="http://img.blog.csdn.net/20151210234529139" alt="ç»“æ„å›¾2"></p><ol><li>ç”¨æˆ·ä¸Viewäº¤äº’å‘å‡ºAction</li><li><code>store.dispatch(Reducer(state, action))</code> storeç» <code>store.dispatch()</code> å‘Viewå‘é€stateï¼Œè€ŒActionå’Œæ­¤åˆ»stateä½œä¸ºå‚æ•°ä¼ å…¥Reducerï¼ŒReducerå¤„ç†åè¿”å›æ–°çš„stateï¼Œå‘é€ç»™View</li><li>ä¸€æ—¦Stateæœ‰æ–°å˜åŒ–ï¼ŒStoreè°ƒç”¨ç›‘å¬ <code>store.subscribe(listener)</code> ï¼Œä¾¦å¬å™¨listenerå¯èƒ½æ˜¯ <code>store.getState()</code> è·å–æ­¤åˆ»æ–°stateï¼Œäº¦æˆ–é€šçŸ¥ç»ç»„ä»¶stateæœ‰å˜åŒ–æ¸²æŸ“View</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;é©å‘½æ€§åˆ›æ–° æ€§èƒ½å‡ºä¼— ä»£ç é€»è¾‘ç°å¸¸ç®€å•çš„ React&lt;/p&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯Redux&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯Redux&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯Redux&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯Redux&lt;/h2&gt;&lt;p&gt;æœ¬èº«ä¸ºä¸€ç§æ¶æ„ï¼Œå°†Flu
      
    
    </summary>
    
    
      <category term="react redux jsx" scheme="https://h5m1007.github.io/categories/react-redux-jsx/"/>
    
    
      <category term="react redux jsx" scheme="https://h5m1007.github.io/tags/react-redux-jsx/"/>
    
  </entry>
  
  <entry>
    <title>online resume record</title>
    <link href="https://h5m1007.github.io/2016/11/05/prepare-resume-record/"/>
    <id>https://h5m1007.github.io/2016/11/05/prepare-resume-record/</id>
    <published>2016-11-05T02:03:00.000Z</published>
    <updated>2020-04-30T06:38:46.782Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨çº¿ç®€å†æ„å»ºè¿‡ç¨‹è®°å½•</p><h2 id="Jade"><a href="#Jade" class="headerlink" title="Jade"></a>Jade</h2><p>â€¦å ä½</p><h3 id="include-amp-amp-extends"><a href="#include-amp-amp-extends" class="headerlink" title="include &amp;&amp; extends"></a>include &amp;&amp; extends</h3><ul><li><code>include</code>  å¼•å…¥é¡µé¢è¡¥å……éƒ¨åˆ†ï¼Œå“ªä¸ªä½ç½®ç¼ºæŸéƒ¨åˆ†ï¼ŒåŒ…å«è¿›æ¥ä½œè¡¥å……</li><li><code>extends</code>  å…ˆç»™å‡ºæ•´ä½“ï¼Œå†æ›¿æ¢å±€éƒ¨</li></ul><p>includeåº”ç”¨  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; index.jade</span><br><span class="line">doctype html</span><br><span class="line">html</span><br><span class="line">    include header</span><br><span class="line">    body</span><br><span class="line">        h1 welcome xxx</span><br><span class="line">        p content</span><br><span class="line">    include footer</span><br></pre></td></tr></table></figure><p>extendsåº”ç”¨  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; layout.jade</span><br><span class="line">doctype html</span><br><span class="line">html</span><br><span class="line">    head</span><br><span class="line">        block title</span><br><span class="line">            title Default Title</span><br><span class="line">    body</span><br><span class="line">        block content</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; index.jade</span><br><span class="line">extends layout</span><br><span class="line">block title</span><br><span class="line">    title New Title</span><br><span class="line">block content</span><br><span class="line">    h1 new title</span><br><span class="line">    p new content</span><br></pre></td></tr></table></figure><h2 id="Gulp"><a href="#Gulp" class="headerlink" title="Gulp"></a>Gulp</h2><h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><ul><li>gulpæ‰§è¡ŒæŒ‡å®šä»»åŠ¡å¹¶å›è°ƒ  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    gulp.task(&#39;build&#39;, [&#39;task1&#39;, &#39;task2&#39;], function()&#123;</span><br><span class="line">        &#x2F;&#x2F; åªæ‰§è¡Œä»»åŠ¡build</span><br><span class="line">        &#x2F;&#x2F; åŒæ—¶ä¼šæ‰§è¡Œtask1, task2</span><br><span class="line">        gulp.src(&#39;src&#39;) &#x2F;&#x2F; å°†è¿”å›å¯¹è±¡æµ</span><br><span class="line">            .pipe(plugin1());</span><br><span class="line">    &#125;);</span><br><span class="line">    gulp.task(&#39;task1&#39;, function()&#123;</span><br><span class="line">        gulp.src(&#39;src1&#39;)</span><br><span class="line">            .pipe(plugin1());</span><br><span class="line">    &#125;);</span><br><span class="line">    gulp.task(&#39;task2&#39;, [&#39;task1&#39;], function()&#123;</span><br><span class="line">        &#x2F;&#x2F; å¯è®©task1æ‰§è¡Œå®Œ</span><br><span class="line">        &#x2F;&#x2F; å†æ‰§è¡Œtask2</span><br><span class="line">        gulp.src(&#39;src2&#39;)</span><br><span class="line">            .pipe(plugin2());</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p><code>gulp task</code> å‘½ä»¤è¡Œæ‰§è¡Œä»»åŠ¡åï¼Œç›´æ¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡  </p><p><em>gulp.src()æ–¹æ³•è¾“å…¥ä¸€ä¸ªå¦‚åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶çš„å­—ç¬¦ä¸²ï¼Œæˆ–è€…globæ•°ç»„ï¼Œç„¶åè¿”å›ä¸€ä¸ªå¯ä»¥ä¼ é€’ç»™æ’ä»¶çš„æ•°æ®æµ</em>  </p><p><code>pipe()</code> æŠŠ<strong>å¯¹è±¡æµ</strong>å¯¹æ¥åœ¨æ’ä»¶ä¸Šï¼Œå¹¶è®©æ’ä»¶å¤„ç†å¯¹è±¡  </p><ul><li>Plugins</li></ul><p><code>gulp-load-plugins</code>  è¯¥æ’ä»¶è‡ªåŠ¨æŒ‰éœ€(å½“éœ€è¢«è°ƒç”¨æ—¶æ‰åŠ è½½)åŠ è½½ <code>paskage.json</code> ä¸­Gulpæ’ä»¶ï¼Œå¹¶æŠŠå®ƒä»¬é™„åŠ åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Š  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var gulp &#x3D; require(&#39;gulp&#39;),</span><br><span class="line">        gulpLoadPlugins &#x3D; require(&#39;gulp-load-plugins&#39;),</span><br><span class="line">        plugins &#x3D; gulpLoadPlugins();</span><br><span class="line">    gulp.task(&#39;js&#39;, function () &#123;</span><br><span class="line">       return gulp.src(&#39;js&#x2F;*.js&#39;)</span><br><span class="line">          .pipe(plugins.jshint())</span><br><span class="line">          .pipe(plugins.jshint.reporter(&#39;default&#39;))</span><br><span class="line">          .pipe(plugins.uglify())</span><br><span class="line">          .pipe(plugins.concat(&#39;app.js&#39;))</span><br><span class="line">          .pipe(gulp.dest(&#39;build&#39;)) &#x2F;&#x2F; æŒ‡å®šè¾“å‡ºç›®å½•</span><br><span class="line">          .pipe(gulp.livereload()); &#x2F;&#x2F; æ–‡ä»¶è¢«ä¿®æ”¹è‡ªåŠ¨åŠ è½½åˆ·æ–°ç½‘é¡µ</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><ul><li>Watch</li></ul><p><code>gulp.watch()</code>  ç›‘å¬æ–‡ä»¶ä¿®æ”¹çŠ¶æ€ï¼Œåœ¨æ–‡ä»¶è¢«æ”¹åŠ¨æ—¶æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªä»»åŠ¡  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var watcher &#x3D; gulp.task(&#39;watch&#39;, function (e) &#123;</span><br><span class="line">       gulp.watch(&#39;xxx.scss&#39;, [&#39;buildSass&#39;]);</span><br><span class="line">       console.log(&#39;Event type: &#39; + e.type); &#x2F;&#x2F; added, changed, or deleted</span><br><span class="line">       console.log(&#39;Event path: &#39; + e.path); &#x2F;&#x2F; The path of the modified file</span><br><span class="line">    &#125;);</span><br><span class="line">    watcher.on(&#39;change&#39;, function()&#123;&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="Gulp-amp-amp-Grunt"><a href="#Gulp-amp-amp-Grunt" class="headerlink" title="Gulp &amp;&amp; Grunt"></a>Gulp &amp;&amp; Grunt</h3><h4 id="ä¸åŒç‚¹"><a href="#ä¸åŒç‚¹" class="headerlink" title="ä¸åŒç‚¹"></a>ä¸åŒç‚¹</h4><ol><li><p>Gulpå’ŒGruntçš„å·¥ä½œæ–¹å¼å¾ˆä¸ä¸€æ ·ã€‚Gruntä¸ä½¿ç”¨æ•°æ®æµï¼Œè€Œæ˜¯ä½¿ç”¨æ–‡ä»¶ï¼Œå¯¹æ–‡ä»¶æ‰§è¡Œå•ä¸ªä»»åŠ¡ç„¶åä¿å­˜åˆ°æ–°çš„æ–‡ä»¶ä¸­ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½ä¼šé‡å¤æ‰§è¡Œæ‰€æœ‰è¿›ç¨‹ï¼Œæ–‡ä»¶ç³»ç»Ÿé¢‘ç¹çš„å¤„ç†ä»»åŠ¡ä¼šå¯¼è‡´Gruntçš„è¿è¡Œé€Ÿåº¦æ¯”Gulpæ…¢  </p></li><li><p>Gruntä»»åŠ¡æ‹¥æœ‰å¤§é‡çš„é…ç½®ï¼Œä¼šå¼•ç”¨å¤§é‡ä½ å®é™…ä¸Šå¹¶ä¸éœ€è¦çš„å¯¹è±¡å±æ€§ï¼Œä½†æ˜¯Gulpé‡ŒåŒæ ·çš„ä»»åŠ¡ä¹Ÿè®¸åªæœ‰å‡ è¡Œè€Œå·²  </p></li><li><p>Gruntæ¯”Gulpæ›´åŠ é¢‘ç¹åœ°æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥ä½¿ç”¨æ•°æ®æµçš„Gulpæ€»æ˜¯æ¯”Gruntå¿«ã€‚å¯¹äºä¸€ä¸ªå°çš„LESSæ–‡ä»¶ï¼Œgulpfile.jsé€šå¸¸éœ€è¦6msï¼Œè€Œgruntfile.jsåˆ™éœ€è¦å¤§æ¦‚50msâ€”â€”æ…¢8å€å¤š  </p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨çº¿ç®€å†æ„å»ºè¿‡ç¨‹è®°å½•&lt;/p&gt;
&lt;h2 id=&quot;Jade&quot;&gt;&lt;a href=&quot;#Jade&quot; class=&quot;headerlink&quot; title=&quot;Jade&quot;&gt;&lt;/a&gt;Jade&lt;/h2&gt;&lt;p&gt;â€¦å ä½&lt;/p&gt;
&lt;h3 id=&quot;include-amp-amp-extends&quot;&gt;&lt;a 
      
    
    </summary>
    
    
      <category term="javascript gulp jade" scheme="https://h5m1007.github.io/categories/javascript-gulp-jade/"/>
    
    
      <category term="javascript gulp jade" scheme="https://h5m1007.github.io/tags/javascript-gulp-jade/"/>
    
  </entry>
  
  <entry>
    <title>NodeJs å…¨è®°å½•ä¸ƒ</title>
    <link href="https://h5m1007.github.io/2016/11/01/learn-from-nodejs/"/>
    <id>https://h5m1007.github.io/2016/11/01/learn-from-nodejs/</id>
    <published>2016-11-01T06:03:00.000Z</published>
    <updated>2020-04-30T06:38:46.782Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ç«¯ç¨‹åºçŒ¿çš„ç¬¬äºŒæ˜¥ ä½¿ç”¨è€æœ¬è¡ŒJSæ¥æ„å»ºæœåŠ¡å™¨ç«¯çš„ç¥å™¨  NodeJs</p><h2 id="websocket"><a href="#websocket" class="headerlink" title="websocket"></a>websocket</h2><ul><li><p>websocketæ˜¯ä¸€ä¸ªåè®®ï¼Œç±»ä¼¼äºTCP/IPã€HTTPåè®®ï¼Œä½†å®ƒä»¬éœ€è¦æœ‰socketè¾…åŠ©æ¥æä¾›ç»™å¤–éƒ¨è°ƒç”¨çš„APIï¼Œè€Œwebsocketæœ¬èº«å°±æœ‰ä¸€ä¸ª <strong>WebSocket API</strong>  </p></li><li><p>ä½¿ç”¨socketè¿™æ ·çš„ç½‘ç»œåè®®APIsä¸ä¼šç¬¦åˆåŸå§‹å®‰å…¨æ¨¡å‹ï¼Œè€Œwebsocketåˆ™ä¸ä¼šï¼Œå®ƒæä¾›ç»™H5åº”ç”¨TCPçš„æ–¹å¼å´ä¸ä¼šå‰Šå¼±ç½‘ç»œå®‰å…¨ä¸”è¿˜èƒ½åŒæ—¶æ‹¥æœ‰ç°ä»£API  </p></li><li><p>websocketç›¸å¯¹äºhttpåè®®ï¼Œæ‹Ÿè¡¥äº†httpä¸é€‚åˆ<strong>å®æ—¶é€šä¿¡</strong>çš„ç¼ºé™·ï¼Œwebsocketä»¥å¼‚æ­¥åŒå‘é€šä¿¡æ¨¡å¼ï¼Œé€šè¿‡ä¼ è¾“å±‚åè®®ä½¿å…¶æ›´æ€¥æœ‰çµæ´»æ€§  </p></li><li><p>websocketåè®®èƒ½å¤Ÿè®©å®¢æˆ·ç«¯å’Œè¿œç¨‹æœåŠ¡å™¨ç«¯é€šè¿‡webå»ºç«‹<strong>å…¨åŒå·¥é€šä¿¡</strong>ï¼Œä¸”æ”¯æŒäºŒè¿›åˆ¶å­—ç¬¦ä¸²å’Œæ–‡æœ¬å­—ç¬¦ä¸²ï¼Œåè®®åŒ…å«æ‰“å¼€<strong>æ¡æ‰‹</strong>ä¹‹åçš„åŸºæœ¬æ¶ˆæ¯æ¡†æ¶  </p></li></ul><h3 id="websocket-API"><a href="#websocket-API" class="headerlink" title="websocket API"></a>websocket API</h3><ul><li><p>websocketçš„æ¥å£ï¼Œå¯é€šè¿‡å®ƒæ¥å»ºç«‹<strong>å…¨åŒå·¥é€šé“</strong>æ¥æ”¶å‘æ¶ˆæ¯ï¼Œå½“è¿æ¥è¿œç¨‹æœåŠ¡å™¨ï¼Œåªéœ€åˆ›å»ºä¸€ä¸ªwebsocketå®ä½“ï¼Œå³å®ä¾‹åŒ–ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¼ å…¥ç±»ä¼¼ â€œws://<a href="http://www.xxx.com&quot;" target="_blank" rel="noopener">www.xxx.com&quot;</a> çš„URL  </p></li><li><p>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åœ¨å¼€å§‹æ¡æ‰‹çš„æœŸé—´ï¼Œhttpä¼šå‡çº§è‡³websocketï¼Œè¿™æ ·å»ºç«‹äº†è¿æ¥ï¼Œå…¶åº•å±‚éƒ½æ˜¯TCPåè®®  </p></li><li><p>websocket api æ˜¯<strong>çº¯äº‹ä»¶é©±åŠ¨</strong>çš„ï¼Œå³å¯ä½¿ç”¨å¼‚æ­¥äº‹ä»¶ç›‘å¬æ¥è¿æ¥å…¶æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„æ¯ä¸ªé˜¶æ®µ  </p></li></ul><p><code>onopen()</code><br>ä¸€æ—¦æœåŠ¡å™¨å“åº”websocketè¿æ¥è¯·æ±‚åè§¦å‘openäº‹ä»¶ï¼Œè¿™æ„å‘³ç€åè®®æ¡æ‰‹ç»“æŸï¼Œwebsocketå·²å‡†å¤‡å¥½æ”¶å‘æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ç°åœ¨å¯ç¡®å®šæœåŠ¡ç«¯å·²ç»å¤„ç†å¥½äº†å»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼ŒåŒæ„å’Œä½ çš„åº”ç”¨é€šä¿¡äº†  </p><p><code>onmessage()</code><br>ä¸€æ—¦websocketæ”¶åˆ°æ•°æ®åè§¦å‘messageäº‹ä»¶  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    ws.onmessage &#x3D; function(e)&#123;</span><br><span class="line">        if(e.data)&#123;</span><br><span class="line">            console.log(e.data);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p><code>onerror</code><br>è¿æ¥å¤±è´¥æˆ–å…¶å®ƒæ“ä½œå¼•èµ·é”™è¯¯ç­‰éƒ½ä¼šè§¦å‘erroräº‹ä»¶ï¼Œä»è€Œå¯¼è‡´è¿æ¥å…³é—­  </p><p><code>onclose</code><br>è¿æ¥å…³é—­æ—¶è§¦å‘closeäº‹ä»¶ï¼Œä¹‹åå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å°±ä¸èƒ½å†é€šä¿¡äº†  </p><ul><li><p>å»ºç«‹å…¶å…¨åŒå·¥è¿æ¥ï¼ŒæœåŠ¡å™¨å‘é€æ•°æ®æˆ–èµ„æºç»™å®¢æˆ·ç«¯ï¼Œå®ƒèƒ½è‡ªåŠ¨å‘é€çŠ¶æ€æ”¹å˜çš„<strong>æ•°æ®å’Œé€šçŸ¥</strong>ï¼Œä»è€Œæˆ‘ä»¬æ— é¡»ä¸ºäº†çŠ¶æ€çš„æ›´æ–°è€Œå»è½®è¯¢serverï¼Œåªè¦åœ¨å®¢æˆ·ç«¯è¿›è¡Œç›‘å¬å³å¯  </p></li><li><p>websocketå¯¹è±¡çš„å®ä¾‹æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š<code>send()</code>  <code>close()</code>  </p></li></ul><p><code>send()</code><br>æä¾›ç»™æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ç›¸äº’å‘é€æ¶ˆæ¯çš„æ–¹æ³•ï¼Œä½†éœ€è¦åœ¨ <code>onopen</code> è¿æ¥å®Œå…¨å»ºç«‹äº†æ‰èƒ½ä½¿ç”¨è¯¥æ–¹æ³•  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    ws.onopen &#x3D; function(e)&#123;</span><br><span class="line">        ws.send(str);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p><code>close()</code><br>æ‰‹åŠ¨å…³é—­è¿æ¥ï¼Œä¸€æ—¦ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå°†ä¸èƒ½å†å‘é€æ•°æ®  </p><p><code>ws.close(status, &quot;reason&quot;)</code>  å¯é€‰ä¸¤å‚æ•°ï¼ŒçŠ¶æ€ç å’Œå…³é—­åŸå›   </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    ws.close(</span><br><span class="line">        1000,</span><br><span class="line">        &quot;Closing normally!&quot;</span><br><span class="line">    )</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><ul><li>websocketå¯¹è±¡æœ‰ä¸‰ä¸ªå±æ€§ï¼šreadyStateã€bufferedAmountã€Protocol</li></ul><p><code>ws.readyState</code><br>è¯¥å±æ€§æ¥è¡¨ç¤ºè¿æ¥çŠ¶æ€ï¼Œä¼šéšç€è¿æ¥çŠ¶æ€å˜åŒ–è€Œå˜åŒ–  </p><table><thead><tr><th align="left">å±æ€§</th><th align="right">å€¼</th><th align="center">çŠ¶æ€</th></tr></thead><tbody><tr><td align="left">WebSocket.CONNECTING</td><td align="right">0</td><td align="center">è¿æ¥æ­£è¿›è¡Œä½†æœªå»ºç«‹</td></tr><tr><td align="left">WebSocket.OPEN</td><td align="right">1</td><td align="center">è¿æ¥å·²å»ºç«‹å¯å‘é€æ¶ˆæ¯</td></tr><tr><td align="left">WebSocket.CLOSING</td><td align="right">2</td><td align="center">æ­£å…³é—­æ¡æ‰‹</td></tr><tr><td align="left">WebSocket.CLOSED</td><td align="right">3</td><td align="center">è¿æ¥å·²å…³é—­æˆ–ä¸èƒ½æ‰“å¼€</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    if(ws.readyState &#x3D;&#x3D;&#x3D; WebSocket.OPEN)&#123;</span><br><span class="line">        &#x2F;&#x2F; å¾…è¿æ¥å·²å»ºç«‹</span><br><span class="line">        ws.send(data);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p><code>ws.bufferedAmount</code><br><code>send()</code>å‘é€çš„æ•°æ®ä¸ä¼šç«‹å³ä¼ è¾“ï¼Œè€Œæ˜¯è¢«æµè§ˆå™¨ç¼“å­˜æ¯æ¬¡åº”ç”¨æµå‡ºçš„æ•°æ®ï¼ŒbufferedAmountå¯ç”¨æ¥æ£€æŸ¥æ¯æ¬¡æµå‡ºçš„æ•°æ®å¤§å°ï¼Œè€Œè¿™äº›æ•°æ®å·²è¿›å…¥é˜Ÿåˆ—ä½†æœªè¢«ä¼ è¾“  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var ws &#x3D; new WebSocket(&quot;ws:&#x2F;&#x2F;echo.websocket.org&quot;),</span><br><span class="line">        maxData &#x3D; 10240;</span><br><span class="line">    ws.onopen &#x3D; function()&#123;</span><br><span class="line">        setInterval(function()&#123;</span><br><span class="line">            if(ws.bufferedAmount &lt; maxData)&#123;</span><br><span class="line">                ws.send()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,1000);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p><code>ws.protocol</code><br>è¿”å›å½“å‰ä½¿ç”¨çš„websocketåè®®ï¼Œç”±æœåŠ¡å™¨æä¾›  </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‰ç«¯ç¨‹åºçŒ¿çš„ç¬¬äºŒæ˜¥ ä½¿ç”¨è€æœ¬è¡ŒJSæ¥æ„å»ºæœåŠ¡å™¨ç«¯çš„ç¥å™¨  NodeJs&lt;/p&gt;
&lt;h2 id=&quot;websocket&quot;&gt;&lt;a href=&quot;#websocket&quot; class=&quot;headerlink&quot; title=&quot;websocket&quot;&gt;&lt;/a&gt;websocket&lt;/h2&gt;&lt;u
      
    
    </summary>
    
    
      <category term="nodejs javascript" scheme="https://h5m1007.github.io/categories/nodejs-javascript/"/>
    
    
      <category term="nodejs express websocket" scheme="https://h5m1007.github.io/tags/nodejs-express-websocket/"/>
    
  </entry>
  
  <entry>
    <title>react å›å¿†å½•ä¸€</title>
    <link href="https://h5m1007.github.io/2016/11/01/learn-from-react/"/>
    <id>https://h5m1007.github.io/2016/11/01/learn-from-react/</id>
    <published>2016-11-01T02:55:00.000Z</published>
    <updated>2020-04-30T06:38:46.782Z</updated>
    
    <content type="html"><![CDATA[<p>é©å‘½æ€§åˆ›æ–° æ€§èƒ½å‡ºä¼— ä»£ç é€»è¾‘ç°å¸¸ç®€å•çš„ React</p><h2 id="ä»€ä¹ˆæ˜¯React"><a href="#ä»€ä¹ˆæ˜¯React" class="headerlink" title="ä»€ä¹ˆæ˜¯React"></a>ä»€ä¹ˆæ˜¯React</h2><p>React èµ·æºäºFacebookçš„å†…éƒ¨é¡¹ç›®ï¼Œé¡¹ç›®æœ¬èº«ä¹Ÿè¶Šæ»šè¶Šå¤§ï¼Œä»æœ€æ—©çš„UIå¼•æ“å˜æˆäº†ä¸€æ•´å¥—å‰åç«¯é€šåƒçš„ Web App è§£å†³æ–¹æ¡ˆ</p><h2 id="æ€ä¹ˆç©"><a href="#æ€ä¹ˆç©" class="headerlink" title="æ€ä¹ˆç©"></a>æ€ä¹ˆç©</h2><p>å¼•å…¥ä¸‰å¤§æ³•å®ï¼š <code>react.js</code>ã€<code>react-dom.js</code>ã€<code>browser.js</code>  </p><p><code>react.js</code> æ˜¯ React çš„æ ¸å¿ƒåº“<br><code>react-dom.js</code> æ˜¯æä¾›ä¸ DOM ç›¸å…³çš„åŠŸèƒ½<br><code>browser.js</code> çš„ä½œç”¨æ˜¯å°† JSX è¯­æ³•è½¬ä¸º JavaScript è¯­æ³•  </p><ul><li>JSX<br>å…è®¸ HTML ä¸ JavaScript çš„æ··å†™ï¼Œé‡åˆ° HTML æ ‡ç­¾ï¼ˆä»¥ &lt; å¼€å¤´ï¼‰ï¼Œå°±ç”¨ HTML è§„åˆ™è§£æï¼›é‡åˆ°ä»£ç å—ï¼ˆä»¥ { å¼€å¤´ï¼‰ï¼Œå°±ç”¨ JavaScript è§„åˆ™è§£æ</li></ul><h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- ... --&gt;</span><br><span class="line">&lt;div id&#x3D;&quot;example&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;babel&quot;&gt;</span><br><span class="line">    var names &#x3D; [&#39;Leon&#39;, &#39;Leo&#39;],</span><br><span class="line">        arr &#x3D; [</span><br><span class="line">            &lt;h1&gt;React is awesome&lt;&#x2F;h1&gt;,</span><br><span class="line">            &lt;h2&gt;good app!&lt;&#x2F;h2&gt;</span><br><span class="line">        ],</span><br><span class="line">        Msg &#x3D; React.createClass(&#123;</span><br><span class="line">            render: function()&#123;</span><br><span class="line">                return &lt;h1&gt;Hello, &#123;this.props.name&#125;&lt;&#x2F;h1&gt;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    ReactDOM.render(</span><br><span class="line">        &#x2F;&#x2F; &lt;h1&gt;Hello world!&lt;&#x2F;h1&gt;,</span><br><span class="line">        &#x2F;&#x2F; &lt;div&gt;</span><br><span class="line">        &#x2F;&#x2F;  &#123;</span><br><span class="line">        &#x2F;&#x2F;      names.map(function(name)&#123;</span><br><span class="line">        &#x2F;&#x2F;          return &lt;div&gt;Hello, &#123;name&#125;!&lt;&#x2F;div&gt;</span><br><span class="line">        &#x2F;&#x2F;      &#125;)</span><br><span class="line">        &#x2F;&#x2F;  &#125;</span><br><span class="line">        &#x2F;&#x2F; &lt;&#x2F;div&gt;,</span><br><span class="line">        &#x2F;&#x2F; &lt;div&gt;&#123;arr&#125;&lt;&#x2F;div&gt;,</span><br><span class="line">        &lt;Msg name&#x3D;&quot;Leon&quot;&#x2F;&gt;,</span><br><span class="line">        document.getElementById(&#39;example&#39;)</span><br><span class="line">    );</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><ul><li><p>åˆ†æ</p></li><li><p><code>ReactDOM.render(&quot;HTML&quot;, &quot;DOM&quot;)</code>  åŸºæœ¬æ³•ï¼Œå°†æ¨¡ç‰ˆè½¬ä¸ºHTMLè¯­è¨€ï¼Œå¹¶æ’å…¥æŒ‡å®šèŠ‚ç‚¹  </p></li><li><p><code>&lt;div&gt;{arr}&lt;/div&gt;</code>  å˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç»“æœ JSX ä¼šæŠŠå®ƒçš„æ‰€æœ‰æˆå‘˜ï¼Œæ·»åŠ åˆ°æ¨¡æ¿</p></li><li><p>ç»„ä»¶</p></li></ul><p><strong>ç»„ä»¶</strong>å¹¶ä¸æ˜¯çœŸå®çš„ DOM èŠ‚ç‚¹ï¼Œè€Œæ˜¯å­˜åœ¨äºå†…å­˜ä¹‹ä¸­çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå«åš<strong>è™šæ‹Ÿ DOM</strong> ï¼ˆvirtual DOMï¼‰ã€‚åªæœ‰å½“å®ƒæ’å…¥æ–‡æ¡£ä»¥åï¼Œæ‰ä¼šå˜æˆçœŸå®çš„ DOM</p><ul><li>DOM diff ç®—æ³•</li></ul><p>DOMçš„æ‰€æœ‰å˜åŠ¨ï¼Œéƒ½å…ˆåœ¨<strong>è™šæ‹Ÿ DOM</strong> ä¸Šå‘ç”Ÿï¼Œç„¶åå†å°†å®é™…å‘ç”Ÿå˜åŠ¨çš„éƒ¨åˆ†ï¼Œåæ˜ åœ¨çœŸå® DOMä¸Šï¼Œè¿™ç§ç®—æ³•å«åš <strong>DOM diff</strong> ï¼Œå®ƒå¯ä»¥æå¤§æé«˜ç½‘é¡µçš„æ€§èƒ½è¡¨ç°</p><ul><li><p><code>React.createClass({})</code>  ç”¨äºç”Ÿæˆä¸€ä¸ªç»„ä»¶ç±»ï¼Œå¦‚ <code>Msg</code>ï¼Œæ¨¡æ¿æ’å…¥ <Msg /> æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ Msg çš„ä¸€ä¸ªå®ä¾‹  </p></li><li><p>ç»„ä»¶æ³¨æ„äº‹é¡¹ï¼š </p></li></ul><p>ç»„ä»¶ç±»çš„ç¬¬ä¸€ä¸ªå­—æ¯å¿…é¡»å¤§å†™;<br>åªèƒ½åŒ…å«ä¸€ä¸ªé¡¶å±‚æ ‡ç­¾;<br>ç»„ä»¶çš„å±æ€§å¯ä»¥åœ¨ç»„ä»¶ç±»çš„ <code>this.props</code> å¯¹è±¡ä¸Šè·å–;<br><code>class</code> å±æ€§éœ€è¦å†™æˆ <code>className</code> ï¼Œ<code>for</code> å±æ€§éœ€è¦å†™æˆ <code>htmlFor</code>  </p><ul><li><p>ç»„ä»¶å‚æ•°</p></li><li><p>ç»„ä»¶å±æ€§  </p></li></ul><p><code>this.props</code> è¡¨ç¤ºé‚£äº›ä¸€æ—¦å®šä¹‰ï¼Œå°±ä¸å†æ”¹å˜çš„ç‰¹æ€§  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    Msg &#x3D; React.createClass(&#123;</span><br><span class="line">        &#x2F;&#x2F; åˆ¤æ–­ä¼ å…¥å‚æ•°æ˜¯å¦ç¬¦åˆè¦æ±‚</span><br><span class="line">        propTypes: &#123;</span><br><span class="line">            &#x2F;&#x2F; é™åˆ¶å‚æ•°ä¸ºå­—ç¬¦ä¸²</span><br><span class="line">            title: React.PropTypes.string.isRequired</span><br><span class="line">        &#125;,</span><br><span class="line">        &#x2F;&#x2F; è®¾ç½®å±æ€§é»˜è®¤å€¼</span><br><span class="line">        getDefaultProps: function()&#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                title: &quot;Hello Leon&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        render: function()&#123;</span><br><span class="line">            return &lt;h1&gt;Hello, &#123;this.props.name&#125;&lt;&#x2F;h1&gt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><ul><li>ç»„ä»¶çŠ¶æ€</li></ul><p>ç»„ä»¶çœ‹æˆæ˜¯ä¸€ä¸ª<strong>çŠ¶æ€æœº</strong>ï¼Œä¸€å¼€å§‹æœ‰ä¸€ä¸ªåˆå§‹çŠ¶æ€ï¼Œç„¶åç”¨æˆ·äº’åŠ¨ï¼Œå¯¼è‡´çŠ¶æ€å˜åŒ–ï¼Œä»è€Œè§¦å‘é‡æ–°æ¸²æŸ“ UI  </p><p><code>this.state</code> æ˜¯ä¼š<em>éšç€ç”¨æˆ·äº’åŠ¨è€Œäº§ç”Ÿå˜åŒ–</em>çš„ç‰¹æ€§  </p><p>æ‰€ä»¥ï¼Œè¯¥å±æ€§ä¸€èˆ¬åœ¨åº”ç”¨åœ¨è¡¨å•æ¯”è¾ƒå¤š  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    Slt_btn &#x3D; React.createClass(&#123;</span><br><span class="line">        &#x2F;&#x2F; å®šä¹‰åˆå§‹çŠ¶æ€(å¯¹è±¡)</span><br><span class="line">        getInitialState: function()&#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                opt: false</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        clickSlt: function()&#123;</span><br><span class="line">            this.setState(&#123;</span><br><span class="line">                &#x2F;**</span><br><span class="line">                 * ä¿®æ”¹çŠ¶æ€å€¼</span><br><span class="line">                 * æ¯æ¬¡ä¿®æ”¹ä»¥å</span><br><span class="line">                 * è‡ªåŠ¨è°ƒç”¨ this.render æ–¹æ³•å†æ¬¡æ¸²æŸ“ç»„ä»¶</span><br><span class="line">                 *&#x2F;</span><br><span class="line">                opt: !this.state.opt</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        render: function()&#123;</span><br><span class="line">            var text &#x3D; this.state.opt ? &quot;select&quot; : &quot;don&#39;t select&quot;;</span><br><span class="line">            return(</span><br><span class="line">                &lt;p onClick&#x3D;&#123;this.clickSlt&#125;&gt;</span><br><span class="line">                    You &#123;text&#125; this. Click to toggle!</span><br><span class="line">                &lt;&#x2F;p&gt;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><ul><li>ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</li></ul><p>åˆ†åˆ«æœ‰ï¼š  </p><ol><li>Mountingï¼šå·²æ’å…¥çœŸå® DOM</li><li>Updatingï¼šæ­£åœ¨è¢«é‡æ–°æ¸²æŸ“</li><li>Unmountingï¼šå·²ç§»å‡ºçœŸå® DOM</li></ol><p>ä¸‰ç§çŠ¶æ€æä¾›äº”ç§å¤„ç†å‡½æ•°ï¼š  </p><ol><li><code>componentWillMount()</code>  ç»„ä»¶<strong>è½½å…¥ä¹‹å‰</strong>è°ƒç”¨</li><li><code>componentDidMount()</code>  ç»„ä»¶<strong>è½½å…¥ä¹‹å</strong>è°ƒç”¨</li><li><code>componentWillUpdate()</code>  ç»„ä»¶<strong>æ›´æ–°ä¹‹å‰</strong>è°ƒç”¨</li><li><code>componentDidUpdate()</code>  ç»„ä»¶<strong>æ›´æ–°ä¹‹å</strong>è°ƒç”¨</li><li><code>componentWillUnmount()</code>  ç»„ä»¶<strong>å¸è½½ä¹‹å‰</strong>è°ƒç”¨</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;é©å‘½æ€§åˆ›æ–° æ€§èƒ½å‡ºä¼— ä»£ç é€»è¾‘ç°å¸¸ç®€å•çš„ React&lt;/p&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯React&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯React&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯React&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯React&lt;/h2&gt;&lt;p&gt;React èµ·æºäºFac
      
    
    </summary>
    
    
      <category term="react jsx" scheme="https://h5m1007.github.io/categories/react-jsx/"/>
    
    
      <category term="react jsx" scheme="https://h5m1007.github.io/tags/react-jsx/"/>
    
  </entry>
  
  <entry>
    <title>NodeJs å…¨è®°å½•å…­</title>
    <link href="https://h5m1007.github.io/2016/10/31/learn-from-nodejs/"/>
    <id>https://h5m1007.github.io/2016/10/31/learn-from-nodejs/</id>
    <published>2016-10-31T06:03:00.000Z</published>
    <updated>2020-04-30T06:38:46.781Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ç«¯ç¨‹åºçŒ¿çš„ç¬¬äºŒæ˜¥ ä½¿ç”¨è€æœ¬è¡ŒJSæ¥æ„å»ºæœåŠ¡å™¨ç«¯çš„ç¥å™¨  NodeJs</p><h2 id="express"><a href="#express" class="headerlink" title="express"></a>express</h2><p>ä½œä¸ºnodeæ¡†æ¶expressï¼ŒåŸºäºconnectæ„å»ºè€Œæˆï¼Œä¿æŒé‡ç”¨ä¸­é—´ä»¶çš„åšæ³•ï¼Œæ›´åŠ ä¾¿æ·æ„å»ºwebåº”ç”¨  </p><h3 id="æ¨¡ç‰ˆå¼•æ“"><a href="#æ¨¡ç‰ˆå¼•æ“" class="headerlink" title="æ¨¡ç‰ˆå¼•æ“"></a>æ¨¡ç‰ˆå¼•æ“</h3><p>æ¨¡ç‰ˆè¯­è¨€ï¼Œç”¨æ¥åˆ†ç¦»é€»è¾‘ä»£ç å’Œå¤–åœ¨å†…å®¹ï¼Œä½¿å‰åå°è®¾è®¡æ—¶ï¼Œå¯¹é¡µé¢æˆ–é€»è¾‘æ”¹åŠ¨æ—¶ï¼Œç›¸äº’ä¸å½±å“ï¼Œæ›´åŠ åˆ†æ¸…å‰ç«¯å’Œåå°è®¾è®¡çš„å·¥ä½œ  </p><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><ul><li>å‡è®¾å·²å®‰è£…æ¨¡å— <code>npm install ejs</code> å’Œ <code>npm install superagent</code>  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- server.js --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var express &#x3D; require(&#39;express&#39;),</span><br><span class="line">        search &#x3D; require(&#39;.&#x2F;search&#39;),</span><br><span class="line">        app &#x3D; express.createServer();</span><br><span class="line">    app</span><br><span class="line">        .set(&#39;view engine&#39;, &#39;ejs&#39;) &#x2F;&#x2F; æŒ‡æ˜æ¨¡ç‰ˆå¼•æ“</span><br><span class="line">        .set(&#39;views&#39;, __dirname + &#39;&#x2F;views&#39;) &#x2F;&#x2F; æŒ‡æ˜æ¨¡ç‰ˆæ ¹ç›®å½•</span><br><span class="line">        .set(&#39;view options&#39;, &#123;</span><br><span class="line">            &#x2F;&#x2F; å‚æ•°å€¼ä¼ é€’æ¯ä¸ªæ¨¡ç‰ˆ</span><br><span class="line">            layout: false</span><br><span class="line">        &#125;)</span><br><span class="line">        .set(&#39;view cache&#39;, true); &#x2F;&#x2F; å¯¹æ¨¡ç‰ˆç¼“å­˜</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * é…ç½®è·¯ç”±å¤„ç†å™¨</span><br><span class="line">     *&#x2F;</span><br><span class="line">    app.get(&#39;&#x2F;&#39;, function(req, res)&#123;</span><br><span class="line">        &#x2F;&#x2F; æ¸²æŸ“indexæ¨¡ç‰ˆ</span><br><span class="line">        &#x2F;&#x2F; å¹¶ä½œä¸ºå“åº”è¿”å›</span><br><span class="line">        res.render(&#39;index&#39;);</span><br><span class="line">        &#x2F;&#x2F; console.log(app.set(&#39;views&#39;));</span><br><span class="line">    &#125;);</span><br><span class="line">    app.get(&#39;&#x2F;search&#39;, function(req, res, next)&#123;</span><br><span class="line">        search(req.query.q, function(err, baikes)&#123;</span><br><span class="line">            &#x2F;&#x2F; req.query è·å–åœ°å€æ ä¼ é€’çš„å‚æ•°</span><br><span class="line">            if (err) &#123;</span><br><span class="line">                &#x2F;&#x2F; è°ƒç”¨search(qstr, fn)å‡½æ•°</span><br><span class="line">                &#x2F;&#x2F; ç»fnå®ä¾‹åŒ–çš„é”™è¯¯ä¸­é—´ä»¶</span><br><span class="line">                return next(err);</span><br><span class="line">            &#125;</span><br><span class="line">            res.render(</span><br><span class="line">                &#39;search&#39;,</span><br><span class="line">                &#123;</span><br><span class="line">                    &#x2F;&#x2F; ä¼ é€’å˜é‡åˆ°search.ejsè§†å›¾</span><br><span class="line">                    &#x2F;&#x2F; è¿™ç±»å˜é‡ç§°ä½œæœ¬åœ°å˜é‡</span><br><span class="line">                    &#x2F;&#x2F; å› åªå¯¹å…¶ä¼ é€’è§†å›¾å¯è§</span><br><span class="line">                    results: baikes,</span><br><span class="line">                    search: req.query.q</span><br><span class="line">                &#125;</span><br><span class="line">            );</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * é…ç½®é”™è¯¯å¤„ç†å™¨</span><br><span class="line">     *&#x2F;</span><br><span class="line">    app.error(function(err, req, res, next)&#123;</span><br><span class="line">        &#x2F;&#x2F; é…ç½®search(qstr, fn)å‡½æ•°</span><br><span class="line">        &#x2F;&#x2F; fnå®ä¾‹åŒ–çš„é”™è¯¯ä¸­é—´ä»¶å‚æ•°</span><br><span class="line">        if(&#39;Bad baidu baike response&#39; &#x3D;&#x3D; err.message)&#123;</span><br><span class="line">            res.render(</span><br><span class="line">                &#39;error&#39;,</span><br><span class="line">                &#123;</span><br><span class="line">                    status: 500</span><br><span class="line">                &#125;,</span><br><span class="line">                function(err, html)&#123;</span><br><span class="line">                    &#x2F;&#x2F; ç¬¬ä¸‰å‚æ•°</span><br><span class="line">                    &#x2F;&#x2F; å¯å¤„ç†æ”¶åˆ°çš„html</span><br><span class="line">                &#125;</span><br><span class="line">            );</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            next();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    app.listen(8080);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p><code>express.createServer</code> è¿”å›HTTPæœåŠ¡å™¨è‡ªå¸¦é…ç½®ç³»ç»Ÿ  </p><p>è°ƒç”¨å¯¹è±¡ <code>app</code> ä¸Šçš„ <code>set()</code> æ¥ä¿®æ”¹é»˜è®¤é…ç½®é¡¹  </p><p>ç»expressæ¡†æ¶å¤„ç†è·¯ç”±ï¼Œçœå»äº†å¯¹ <code>req.url</code> å’Œ <code>req.method</code> çš„åˆ¤æ–­  </p><p>expressä¸ºresponseå¯¹è±¡æä¾›äº† <code>render()</code> æ¸²æŸ“æ¨¡ç‰ˆæ–¹æ³•ï¼Œæ¸²æŸ“è¿‡ç¨‹ï¼š  </p><p>| åˆå§‹åŒ–æ¨¡ç‰ˆå¼•æ“  </p><p>| è¯»å–è§†å›¾æ–‡ä»¶å¹¶å°†å…¶ä¼ é€’ç»™æ¨¡ç‰ˆå¼•æ“  </p><p>| è·å–è§£æåçš„HTMLé¡µé¢å¹¶ä½œä¸ºå“åº”å‘é€ç»™å®¢æˆ·ç«¯  </p><ul><li>ç»“åˆä½¿ç”¨æ¨¡ç‰ˆè¯­è¨€ å¯é€‰Ejsæˆ–jade  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- index.ejs --&gt;</span><br><span class="line">&lt;h1&gt;Baike Search App&lt;&#x2F;h1&gt;</span><br><span class="line">&lt;p&gt;Please enter your search term:&lt;&#x2F;p&gt;</span><br><span class="line">&lt;form action&#x3D;&quot;&#x2F;search&quot; method&#x3D;&quot;GET&quot;&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;q&quot;&gt;</span><br><span class="line">    &lt;button&gt;Search&lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure><p>è¡¨å•é‡Œï¼Œæäº¤åˆ° <code>/search</code> ï¼Œæ‰€å¸¦å‚æ•°æœ‰ <code>q=</code> inputæ ‡ç­¾è¾“å…¥çš„å†…å®¹ï¼Œæœ€ç»ˆä»¥ <code>search?q=xxx</code> è·³è½¬åˆ°æäº¤é¡µé¢ï¼Œè€Œåœ°å€æ å‚æ•°ï¼Œå¯ç”± <code>req.query.q</code> è·å–  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- search.ejs --&gt;</span><br><span class="line">&lt;h1&gt;Baidu Baike Search results for &lt;%&#x3D; search %&gt;&lt;&#x2F;h1&gt;</span><br><span class="line">&lt;% if (results.length) &#123; %&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">        &lt;% for (var i &#x3D; 0; i &lt; results.length; i++) &#123; %&gt;</span><br><span class="line">        &lt;li&gt;&lt;%&#x3D; results[i].name %&gt; - &lt;em&gt;&lt;%&#x3D; results[i].value %&gt;&lt;&#x2F;em&gt;&lt;&#x2F;li&gt;</span><br><span class="line">        &lt;% &#125; %&gt;</span><br><span class="line">    &lt;&#x2F;ul&gt;</span><br><span class="line">&lt;% &#125; else &#123; %&gt;</span><br><span class="line">    &lt;p&gt;No resultes&lt;&#x2F;p&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure><p>ejsæ¨¡ç‰ˆè¯­è¨€ï¼Œjsä»£ç åµŒå…¥<code>&lt;%</code>å’Œ<code>%&gt;</code>é—´ï¼Œåœ¨<code>&lt;%</code>ååŠ å…¥<code>=</code>ç¬¦å·å°†å˜é‡æ‰“å°å‡ºæ¥  </p><h3 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h3><p>expressä¸ºnodeçš„Requestå’ŒResponseå¯¹è±¡æä¾›äº†ä¸€ç³»åˆ—æ‰©å±•æ¥ç®€åŒ–å¼€å‘  </p><ul><li><p><code>req.header(&#39;host&#39;)</code>  ç›´æ¥è·å–å¤´ä¿¡æ¯</p></li><li><p><code>req.accepts(&#39;html&#39;)</code>  åˆ¤æ–­Acceptå¤´ä¿¡æ¯ï¼Œè¿”å›å¸ƒå°”å€¼</p></li><li><p><code>req.is(&#39;text/html&#39;)</code>  åˆ¤æ–­ <code>Content-Type</code> å¤´ä¿¡æ¯</p></li><li><p><code>res.header(&#39;content-type&#39;)</code>  åˆ¤æ–­æŒ‡å®šå€¼æ˜¯å¦å·²åœ¨resä¸Šè®¾ç½®</p></li><li><p><code>res.send(500)</code>  ç›´æ¥å‘é€çŠ¶æ€ç </p></li><li><p><code>res.send(&#39;&lt;p&gt;html&lt;/p&gt;&#39;)</code>  ç›´æ¥å‘é€HTML</p></li><li><p><code>res.send({ obj: val })</code>  åºåˆ—åŒ–å¯¹è±¡ä¸ºJSONå¯¹è±¡ï¼Œå¹¶è®¾ç½® <code>Content-Type</code> å¤´ä¿¡æ¯</p></li><li><p><code>res.send([1, 2])</code>  åºåˆ—åŒ–æ•°ç»„ä¸ºJSONå¯¹è±¡ï¼Œå¹¶è®¾ç½® <code>Content-Type</code> å¤´ä¿¡æ¯</p></li><li><p><code>res.json(5)</code>  æ˜¾ç¤ºåœ°å°†å†…å®¹è½¬æˆJSONå¯¹è±¡</p></li><li><p><code>res.redirect(&#39;/some/other/url&#39;)</code>  ç­‰ä»·äºå‘é€çŠ¶æ€ç 302åŠLocationå¤´ä¿¡æ¯  </p></li><li><p><code>res.sendfile(&#39;image.jpg&#39;)</code>  ï¼›ç±»ä¼¼äº<code>static</code>ï¼Œä¸åŒäºå®ƒç”¨äºå•ä¸ªæ–‡ä»¶  </p></li></ul><h3 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h3><p><code>app.get(&#39;/&#39;, callback)</code></p><ul><li>è‡ªå®šä¹‰å‚æ•°</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    app.get(&#39;&#x2F;user&#x2F;:name&#39;, function(req, res, next)&#123;</span><br><span class="line">        return req.params.name &#x3D;&#x3D; &#39;leon&#39;; &#x2F;&#x2F; true</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">&#96;&#96;&#96;  </span><br><span class="line"></span><br><span class="line">nameå˜é‡ä¼šæ³¨å…¥ &#96;req.params&#96; è¯·æ±‚å‚æ•°å¯¹è±¡ä¸Šï¼ŒåŒ¹é…urlå¦‚ &#96;&#x2F;user&#x2F;leon&#96;ï¼Œè€Œä¸ä¼šåŒ¹é…åˆ° &#96;&#x2F;user&#x2F;&#96;  </span><br><span class="line"></span><br><span class="line">&#96;app.get(&#39;&#x2F;user&#x2F;:name?&#39;)&#96; å½“nameå˜é‡åæ·»åŠ &quot;?&quot;æ—¶ï¼Œå°†å¯ä»¥åŒ¹é…åˆ°å¦‚ &#96;&#x2F;user&#96; å’Œ &#96;&#x2F;user&#x2F;leon&#96;  </span><br><span class="line"></span><br><span class="line">&#96;app.get(&#x2F;^\&#x2F;user&#x2F;([a-z\d\-]*)&#x2F;)&#96; å¯ä½¿ç”¨æ­£åˆ™åŒ¹é…ï¼Œå°†åŒ¹é…å­—æ¯ã€æ•°å­—åŠä¸­åˆ’çº¿  </span><br><span class="line"></span><br><span class="line">- å¼ºåˆ¶åŒ¹é…å…¶å®ƒè·¯ç”±</span><br><span class="line">å½“ä¸€ä¸ªè·¯ç”±åŒ¹é…åˆ°å¹¶å¾—åˆ°å¤„ç†åï¼ŒåŒæ—¶å¯ä»¥å¼ºåˆ¶ç»§ç»­åŒ¹é…å…¶å®ƒè·¯ç”±</span><br></pre></td></tr></table></figure><script>    app.get('/user/:name', function(req, res, next){        if('leon' != req.params.name[0]) return next();    });</script><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- ä¸­é—´ä»¶</span><br><span class="line">ä¸connectä¸€æ ·åœ°ä½¿ç”¨ä¸­é—´ä»¶ï¼Œå¦‚ &#96;express.static(__dirname)&#96; &#96;express.session()&#96;  </span><br><span class="line"></span><br><span class="line">åŒæ—¶ï¼Œexpresså…è®¸åœ¨*ç‰¹å®šåŒ¹é…åˆ°çš„è·¯ç”±*ä¸‹æ‰èƒ½ä½¿ç”¨çš„ä¸­é—´ä»¶</span><br></pre></td></tr></table></figure><script>    function secure(req, res, next){        if(!req.session.logged_in){            return res.send(403); //æœªæˆæƒ            // è·³è¿‡è·¯ç”±çš„å…¶å®ƒä¸­é—´ä»¶            // ç›´æ¥åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±åšå¤„ç†            // return next('route');         }    }    app.get(        '/finacials',        secure,        function(){}    )</script><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## expressçš„åŠ è½½æ–¹å¼</span><br><span class="line">é€‰æ‹©ä¸€ç§ä»£ç ç»„ç»‡ç­–ç•¥ï¼Œä¿è¯æ¯ä¸ªæ¨¡å—éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œåˆ™å°±å¾—ç¡®å®šå¥½å„æ¨¡å—çš„åŠ è½½æ–¹å¼  </span><br><span class="line"></span><br><span class="line">- ç¬¬ä¸€ç§åŠ è½½æ–¹å¼</span><br><span class="line">è‰¯å¥½çš„ä»£ç ç»„ç»‡æ–¹å¼åº”åªç»´æŠ¤ä¸€ä¸ª &#96;server.js&#96; æ–‡ä»¶ï¼Œè€Œè¯¥æ–‡ä»¶åŒ…å«æœ‰è·¯ç”±è¡¨ï¼Œä¸”æ¯ä¸€éƒ¨åˆ†è·¯ç”±å¤„ç†å™¨éƒ½é€šè¿‡æ¨¡å—åŒ–çš„æ–¹å¼å¼•å…¥  </span><br><span class="line"></span><br><span class="line">**server.js**</span><br></pre></td></tr></table></figure><script>    var express = require('express'),        pages = require('./pages'),        app = express.createServer();    app.get('/pages', pages.home);    app.get('/pages/list', pages.list);</script><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**pages.js**</span><br></pre></td></tr></table></figure><script>    exports.home = function(req, res, next){}    exports.list = function(req, res, next){}</script><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">è€Œç¬¬ä¸€ç§åŠ è½½æ–¹å¼ï¼Œä¼š*å‡ºç°çš„é—®é¢˜*æ˜¯ï¼Œæ¯ä¸ªæ¨¡å—å¼•å…¥æ—¶ï¼Œéƒ½æ˜¯æŒ‡å‘åŒä¸€ä¸ªå®ä¾‹å¯¹è±¡ &#96;exports&#96; ï¼Œä¹Ÿå°±æ˜¯è¯´ &#96;require(&#39;.&#x2F;pages&#39;)&#96; è¯¥æ¨¡å—åªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œå› requireåªä¼šåŠ è½½ä¸€æ¬¡è¯¥æ¨¡å—ï¼Œä¸ç®¡åé¢æœ‰å¤šå°‘æ¬¡ä½¿ç”¨äº† &#96;require(&#39;.&#x2F;pages&#39;)&#96;    </span><br><span class="line"></span><br><span class="line">- ç¬¬äºŒç§åŠ è½½æ–¹å¼</span><br><span class="line">å¯ä»¥çœ‹å‡ºï¼Œç¬¬ä¸€ç§åŠ è½½æ–¹å¼æ¨¡å—é—´çš„**è€¦åˆåº¦é«˜**ï¼Œè€Œç¬¬äºŒç§åŠ è½½æ–¹å¼é€šè¿‡ä¸€ç§è§£è€¦æ–¹å¼**appæŒ‚è½½**æ¥é™ä½æ¨¡å—é—´è€¦åˆåº¦  </span><br><span class="line"></span><br><span class="line">**server.js**</span><br></pre></td></tr></table></figure><script>    // ...    app.use(require('./pages'));</script><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**pages.js**</span><br></pre></td></tr></table></figure><script>    var app = module.exports = express.createServer();    app.get('/', function(req, res, next){});    app.get('/list', function(req, res, next){});</script><pre><code>æŠŠæ¯ä¸ªæ¨¡å—å•ç‹¬ä½œä¸ºä¸­é—´ä»¶è®©å…¶å®ƒæ¨¡å—ä½¿ç”¨ï¼Œè¿™æ ·æ¨¡å—æœ¬èº«å°±æ˜¯å®Œå…¨ç‹¬ç«‹çš„ä¾èµ–ã€ä¸­é—´ä»¶ã€é…ç½®ï¼Œç­‰ç­‰  </code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‰ç«¯ç¨‹åºçŒ¿çš„ç¬¬äºŒæ˜¥ ä½¿ç”¨è€æœ¬è¡ŒJSæ¥æ„å»ºæœåŠ¡å™¨ç«¯çš„ç¥å™¨  NodeJs&lt;/p&gt;
&lt;h2 id=&quot;express&quot;&gt;&lt;a href=&quot;#express&quot; class=&quot;headerlink&quot; title=&quot;express&quot;&gt;&lt;/a&gt;express&lt;/h2&gt;&lt;p&gt;ä½œä¸ºnodeæ¡†
      
    
    </summary>
    
    
      <category term="node javascript" scheme="https://h5m1007.github.io/categories/node-javascript/"/>
    
    
      <category term="node nodejs express" scheme="https://h5m1007.github.io/tags/node-nodejs-express/"/>
    
  </entry>
  
  <entry>
    <title>NodeJs å…¨è®°å½•äº”</title>
    <link href="https://h5m1007.github.io/2016/10/28/learn-from-nodejs/"/>
    <id>https://h5m1007.github.io/2016/10/28/learn-from-nodejs/</id>
    <published>2016-10-28T08:00:00.000Z</published>
    <updated>2020-04-30T06:38:46.781Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ç«¯ç¨‹åºçŒ¿çš„ç¬¬äºŒæ˜¥ ä½¿ç”¨è€æœ¬è¡ŒJSæ¥æ„å»ºæœåŠ¡å™¨ç«¯çš„ç¥å™¨  NodeJs</p><h2 id="Connect"><a href="#Connect" class="headerlink" title="Connect"></a>Connect</h2><p>ä¸€ä¸ªåŸºäºHTTPæœåŠ¡å™¨çš„å·¥å…·é›†ï¼Œæä¾›ä¸€ç§æ–°çš„ç»„ç»‡ä»£ç æ–¹å¼æ¥ä¸è¯·æ±‚ã€å“åº”å¯¹è±¡è¿›è¡Œäº¤äº’ï¼Œè¿™ç§æ–¹å¼è¢«ç§°ä½œä¸­é—´ä»¶  </p><h3 id="staticä¸­é—´ä»¶"><a href="#staticä¸­é—´ä»¶" class="headerlink" title="staticä¸­é—´ä»¶"></a>staticä¸­é—´ä»¶</h3><ul><li>æŒ‚è½½<br>å…è®¸å°†ä»»æ„urlåŒ¹é…åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­ä»»æ„ç›®å½•  </li></ul><p>å‡è®¾è®© <code>/my-images</code> è¿™æ ·çš„urlå’Œç›®å½•åä¸º <code>/images</code> å¯¹åº”èµ·æ¥  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var connect &#x3D; require(&#39;connect&#39;),</span><br><span class="line">        server &#x3D; connect.createServer();</span><br><span class="line">    server.use(</span><br><span class="line">        &#39;&#x2F;my-images&#39;,</span><br><span class="line">        connect.static(&#39;&#x2F;images&#39;)</span><br><span class="line">    );</span><br><span class="line">    server.listen(8080);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><ul><li>maxAge<br>ä½œä¸ºstaticçš„é€‰é¡¹ï¼Œå®ç°é™å®šèµ„æºåœ¨å®¢æˆ·ç«¯çš„ç¼“å­˜æ—¶é—´  </li></ul><p>å‡è®¾ï¼Œå®¢æˆ·ç«¯æ‰€æœ‰jsåˆå¹¶è‡³ä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨å…¶æ–‡ä»¶ååŠ ä¸Šä¿®è®¢å·ï¼Œæ­¤æ—¶ï¼Œè®¾ç½®é€‰é¡¹maxAgeå¯å®ç°æ°¸ç¼“å­˜èµ·æ¥  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    server.use(</span><br><span class="line">        &#39;&#x2F;js&#39;,</span><br><span class="line">        connect.static(</span><br><span class="line">            &#39;&#x2F;path&#x2F;to&#x2F;bundles&#39;,</span><br><span class="line">            &#123; maxAge: 100000000&#125;</span><br><span class="line">        );</span><br><span class="line">    );</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="queryä¸­é—´ä»¶"><a href="#queryä¸­é—´ä»¶" class="headerlink" title="queryä¸­é—´ä»¶"></a>queryä¸­é—´ä»¶</h3><p>å‡è®¾ï¼Œå®¢æˆ·ç«¯å‘é€æŸ¥è¯¢è¯·æ±‚ï¼Œurlä¸º <code>/blog-posts?page=5</code> ï¼Œè®¿é—®è¯¥urlæ—¶ï¼Œnodeä¼šä»¥å­—ç¬¦ä¸²çš„å½¢å¼å°†urlå­˜å‚¨è‡³req.urlä¸­  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    server.use(connect.query);</span><br><span class="line">    server.use(function(req)&#123;</span><br><span class="line">        return req.url &#x3D;&#x3D; &quot;&#x2F;blog-posts?page&#x3D;5&quot;; &#x2F;&#x2F; true</span><br><span class="line">        return req.query.page &#x3D;&#x3D; &quot;5&quot;; &#x2F;&#x2F; true</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="loggerä¸­é—´ä»¶"><a href="#loggerä¸­é—´ä»¶" class="headerlink" title="loggerä¸­é—´ä»¶"></a>loggerä¸­é—´ä»¶</h3><p>ç”¨äºå¯¹webåº”ç”¨è¯Šæ–­çš„å·¥å…·ï¼Œå®ƒå°†è¯·æ±‚å’Œå“åº”ä¿¡æ¯æ‰“å°åœ¨ç»ˆç«¯  </p><p>æä¾›äº†å››ç§æ—¥è®°æ ¼å¼ï¼šdefaultã€devã€shortã€tiny  </p><ul><li>connect.logger(â€˜devâ€™)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    server.createServer(</span><br><span class="line">        connect.logger(&#39;dev&#39;),</span><br><span class="line">        function(req, res)&#123;</span><br><span class="line">            res.writeHead(200);</span><br><span class="line">            res.end(&#39;Hello world&#39;);</span><br><span class="line">        &#125;</span><br><span class="line">    ).listen(8080);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>ç­‰ä»·äºåˆå§‹åŒ–connectæœåŠ¡å™¨æ—¶è°ƒç”¨useä¸¤æ¬¡  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    server.use(connect.logger(&#39;dev&#39;));</span><br><span class="line">    server.use(function(req, res, next)&#123;</span><br><span class="line">        res.writeHead(200);</span><br><span class="line">        res.end(&#39;Fast!&#39;);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>ç»ˆç«¯è¾“å‡º  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F; 200 0ms</span><br><span class="line">GET &#x2F;favicon.ico 200 2ms</span><br></pre></td></tr></table></figure><ul><li>è‡ªå®šä¹‰æ ¼å¼</li></ul><p>è®°å½•<strong>è¯·æ±‚</strong>æ–¹æ³•å’ŒIP  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    server.use(</span><br><span class="line">        connect.logger(</span><br><span class="line">            &#39;:method :remote-addr&#39;</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>è®°å½•<strong>å“åº”</strong>çš„content-lengthå’Œcontent-typeä¿¡æ¯  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    server.use(</span><br><span class="line">        connect.logger(</span><br><span class="line">            &#39;type is :res[content-type], &#39; +</span><br><span class="line">            &#39;length is :res[content-length] &#39; +</span><br><span class="line">            &#39;and it took :response-time ms.&#39;</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="bodyparserä¸­é—´ä»¶"><a href="#bodyparserä¸­é—´ä»¶" class="headerlink" title="bodyparserä¸­é—´ä»¶"></a>bodyparserä¸­é—´ä»¶</h3><p>ç”¨æ¥è§£æ<strong>å®¢æˆ·ç«¯è¯·æ±‚bodyä¸­çš„å†…å®¹</strong>çš„ä¸­é—´ä»¶  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;form action&#x3D;&quot;&#x2F;&quot; method&#x3D;&quot;POST&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;</span><br><span class="line">        &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;doc&quot;&gt;</span><br><span class="line">        &lt;button&gt;Send file!&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    &#x2F;&#x2F; ç®€å†™ä½¿ç”¨connect</span><br><span class="line">    &#x2F;&#x2F; ä»¥ä¸‹ä»£ç åŒæ—¶å®ç°</span><br><span class="line">    &#x2F;&#x2F; å¯¹connect.createServer()çš„ä½¿ç”¨</span><br><span class="line">    &#x2F;&#x2F; å’Œæ‰§è¡Œäº†4æ¬¡çš„connect.createServer().use()</span><br><span class="line">    server &#x3D; connect(</span><br><span class="line">        connect.static(__dirname), &#x2F;&#x2F; æŒ‚è½½å½“å‰æ‰§è¡Œjsçš„ç›®å½•</span><br><span class="line">        connect.bodyParser(), &#x2F;&#x2F; ä½¿ç”¨è§£æä¸­é—´ä»¶</span><br><span class="line">        connect.logger(&#39;dev&#39;),</span><br><span class="line">        function(req, res, next)&#123;</span><br><span class="line">            if(&#39;POST&#39; &#x3D;&#x3D; req.method)&#123;</span><br><span class="line">             &#x2F;&#x2F; è¿”å›å…³è”æ•°ç»„å¯¹è±¡</span><br><span class="line">             &#x2F;&#x2F; åŒ…å«é”®ä¸ºè¡¨å•nameå€¼doc</span><br><span class="line">             &#x2F;&#x2F; é”®docå€¼ä¸ºä¸Šä¼ æ–‡ä»¶çš„æ‰€æœ‰ä¿¡æ¯</span><br><span class="line">             console.log(req.files);</span><br><span class="line"></span><br><span class="line">             &#x2F;&#x2F; è¿”å›å¯¹åº”è¡¨å•nameå€¼ä¸ºdoc</span><br><span class="line">             &#x2F;&#x2F; å³ä¸Šä¼ æ–‡ä»¶çš„æ‰€æœ‰ä¿¡æ¯</span><br><span class="line">             console.log(req.files.doc);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">             next();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ).listen(8080);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="cookieParserä¸­é—´ä»¶"><a href="#cookieParserä¸­é—´ä»¶" class="headerlink" title="cookieParserä¸­é—´ä»¶"></a>cookieParserä¸­é—´ä»¶</h3><p>ä¾¿æ·è·å–cookieæ•°æ®ï¼Œè§£æCookieså¤´å¯ç»  <code>req.cookies</code> å¾—åˆ°cookies  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Cookie: info1&#x3D;val1; info2&#x3D;val2</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    server.use(connect.cookieParser());</span><br><span class="line">    server.use(function(req, res, next)&#123;</span><br><span class="line">        &#x2F;&#x2F; req.cookies å¾—åˆ°å­˜å‚¨cookieçš„å¯¹è±¡</span><br><span class="line">        return req.cookies.info1 &#x3D;&#x3D; &#39;val1&#39;; &#x2F;&#x2F; true</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="sessionä¸­é—´ä»¶"><a href="#sessionä¸­é—´ä»¶" class="headerlink" title="sessionä¸­é—´ä»¶"></a>sessionä¸­é—´ä»¶</h3><p>ä¼šè¯ä¸­é—´ä»¶ï¼Œå¤šä¸ªè¯·æ±‚é—´å…±äº«<em>ç”¨æˆ·ä¼šè¯</em>ï¼Œç±»ä¼¼äºç”¨æˆ·ç™»å½•ä¼šæœ‰æŸç§å½¢å¼çš„ä¼šè¯ç³»ç»Ÿï¼Œé€šè¿‡è®¾ç½®cookieæ¥ä¿å­˜ç”¨æˆ·ä¿¡æ¯  </p><p><code>session(option)</code><br>æ¥å—å‚æ•°option:  </p><p>| 1. key: Cookiesåï¼Œé»˜è®¤å€¼ä¸ºconnect.sid<br>| 2. store: sessionå­˜å‚¨å®ä¾‹<br>| 3. secret: sessionçš„cookieåŠ å¯†<br>| 4. cookie: sessionçš„cookieé…ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var connect &#x3D; require(&#39;connect&#39;),</span><br><span class="line">        users &#x3D; require(&#39;.&#x2F;users&#39;);</span><br><span class="line">    var server &#x3D; connect(</span><br><span class="line">        connect.logger(&#39;dev&#39;),</span><br><span class="line">        connect.bodyParser(),</span><br><span class="line">        &#x2F;&#x2F; éœ€è¦ä½¿ç”¨cookieParserä¸­é—´ä»¶</span><br><span class="line">        &#x2F;&#x2F; å¹¶ä¸”éœ€æ”¾åœ¨sessionä¸­é—´ä»¶å‰é¢</span><br><span class="line">        &#x2F;&#x2F; sessionçš„æ•°æ®ç»åŠ å¯†åä¼šä¿å­˜åˆ°cookiesä¸­</span><br><span class="line">        connect.cookieParser(),</span><br><span class="line">        &#x2F;&#x2F; sessioné»˜è®¤å­˜å‚¨æ–¹å¼å­˜å‚¨åˆ°å†…å­˜</span><br><span class="line">        &#x2F;&#x2F; æœåŠ¡å™¨å…³é—­å³è¿›ç¨‹å…³é—­</span><br><span class="line">        &#x2F;&#x2F; sessionä¼šä¸¢å¤±</span><br><span class="line">        connect.session(&#123;</span><br><span class="line">            secret: &#39;my app secret&#39;</span><br><span class="line">        &#125;),</span><br><span class="line">        function(req, res, next)&#123;</span><br><span class="line">            &#x2F;&#x2F; ç™»å½•åæ˜¾ç¤ºçš„å†…å®¹</span><br><span class="line">            if(&#39;&#x2F;&#39; &#x3D;&#x3D; req.url &amp;&amp; req.session.logged_in)&#123;</span><br><span class="line">                &#x2F;&#x2F; req.session.logged_in</span><br><span class="line">                &#x2F;&#x2F; åˆ¤æ–­ç™»é™†ä¸å¦</span><br><span class="line">                res.writeHead(200, &#123;</span><br><span class="line">                    &quot;Content-Type&quot;: &quot;text&#x2F;html&quot;</span><br><span class="line">                &#125;);</span><br><span class="line">                res.end(</span><br><span class="line">                    &#39;Welcome back, &lt;b&gt;&#39; + req.session.name + &#39;&lt;&#x2F;b&gt;.&#39; +</span><br><span class="line">                    &#39;&lt;a href&#x3D;&quot;&#x2F;logout&quot;&gt;Logout&lt;&#x2F;a&gt;&#39;</span><br><span class="line">                );</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                next();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        function(req, res, next)&#123;</span><br><span class="line">            &#x2F;&#x2F; ç™»å½•é¡µé¢å†…å®¹</span><br><span class="line">            if(&#39;&#x2F;&#39; &#x3D;&#x3D; req.url &amp;&amp; &#39;GET&#39; &#x3D;&#x3D; req.method)&#123;</span><br><span class="line">                res.writeHead(200, &#123;</span><br><span class="line">                    &#39;Content-Type&#39;: &#39;text&#x2F;html&#39;</span><br><span class="line">                &#125;);</span><br><span class="line">                res.end([</span><br><span class="line">                    &#39;&lt;form action&#x3D;&quot;&#x2F;login&quot; method&#x3D;&quot;POST&quot;&gt;&#39;,</span><br><span class="line">                    &#39;&lt;fieldset&gt;&#39;,</span><br><span class="line">                    &#39;&lt;lengend&gt;Please log in&lt;&#x2F;lengend&gt;&#39;,</span><br><span class="line">                    &#39;&lt;p&gt;User: &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;user&quot; &#x2F;&gt;&lt;&#x2F;p&gt;&#39;,</span><br><span class="line">                    &#39;&lt;p&gt;Password: &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;password&quot; &#x2F;&gt;&lt;&#x2F;p&gt;&#39;,</span><br><span class="line">                    &#39;&lt;button&gt;Submit&lt;&#x2F;button&gt;&#39;,</span><br><span class="line">                    &#39;&lt;&#x2F;fieldset&gt;&#39;,</span><br><span class="line">                    &#39;&lt;&#x2F;form&gt;&#39;</span><br><span class="line">                ].join(&#39;&#39;));</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                next();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        function(req, res, next)&#123;</span><br><span class="line">            if(&#39;&#x2F;login&#39; &#x3D;&#x3D; req.url &amp;&amp; &#39;POST&#39; &#x3D;&#x3D; req.method)&#123;</span><br><span class="line">                res.writeHead(200);</span><br><span class="line">                if(!users[req.body.user] || req.body.password !&#x3D; users[req.body.user].password)&#123;</span><br><span class="line">                    res.end(&#39;Bad username&#x2F;password&#39;);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    req.session.logged_in &#x3D; true;</span><br><span class="line">                    req.session.name &#x3D; users[req.body.user].name;</span><br><span class="line">                    res.end(&#39;Authenticated!&#39;);</span><br><span class="line">                    console.log(JSON.stringify(req.session));</span><br><span class="line">                    console.log(JSON.stringify(req.cookies));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                next();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        function(req, res, next)&#123;</span><br><span class="line">            if(&#39;&#x2F;logout&#39; &#x3D;&#x3D; req.url)&#123;</span><br><span class="line">                req.session.logged_in &#x3D; false;</span><br><span class="line">                res.writeHead(200);</span><br><span class="line">                res.end(&#39;Logged out!&#39;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                next();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">    server.listen(8080);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="basicAuthä¸­é—´ä»¶"><a href="#basicAuthä¸­é—´ä»¶" class="headerlink" title="basicAuthä¸­é—´ä»¶"></a>basicAuthä¸­é—´ä»¶</h3><p>å‘ç”¨æˆ·æä¾›åŸºæœ¬çš„èº«ä»½éªŒè¯  </p><p><code>connect.basicAuth(function(user,pass,fn))</code><br>æä¾›userå’Œpassç›´æ¥æŒ‡å‘ç”¨æˆ·è¾“å…¥çš„å¸å·å’Œå¯†ç ï¼Œfnå›è°ƒæ¥è¿”å›éªŒè¯æˆåŠŸä¸å¦<br>å½“æ²¡æœ‰å›è°ƒfnï¼Œå°†æ˜¯åŒæ­¥éªŒè¯ï¼Œåä¹‹æœ‰fnå›è°ƒåˆ™ä¸ºå¼‚æ­¥éªŒè¯  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    connect(</span><br><span class="line">        connect.basicAuth(function(user, pass, fn)&#123;</span><br><span class="line">            &#x2F;&#x2F; å®ç°å®¢æˆ·ç«¯åŸºæœ¬èº«ä»½å¼‚æ­¥éªŒè¯</span><br><span class="line">            process.stdout.write(&#39;Allow user \033[96m&#39; +</span><br><span class="line">                user +</span><br><span class="line">                &#39;\033[39m &#39; +</span><br><span class="line">                &#39;with pass \033[90m&#39; +</span><br><span class="line">                pass +</span><br><span class="line">                &#39;\03339m ? [y&#x2F;n]: &#39;);</span><br><span class="line">            process.stdin.once(&#39;data&#39;, function(data)&#123;</span><br><span class="line">                &#x2F;&#x2F; .once æ¯ä¸ªè¯·æ±‚è·å–ä¸€æ¬¡æ•°æ®</span><br><span class="line">                if(data[0] &#x3D;&#x3D; &#39;y&#39;)&#123;</span><br><span class="line">                    fn(null, &#123;</span><br><span class="line">                        username: user &#x2F;&#x2F; ç”¨æ¥ç”Ÿæˆreq.remoteUserå¯¹è±¡</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    fn(new Error(&#39;Unauthorized&#39;));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;),</span><br><span class="line">        function(req, res)&#123;</span><br><span class="line">            res.writeHead(200);</span><br><span class="line">            res.end(&#39;Welcome to the protected area.&#39; +</span><br><span class="line">                &#x2F;&#x2F;req.remoteUserè¿”å›&#123; username: &#39;xxx&#39;&#125;</span><br><span class="line">                req.remoteUser.username);</span><br><span class="line">        &#125;</span><br><span class="line">    ).listen(8080);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‰ç«¯ç¨‹åºçŒ¿çš„ç¬¬äºŒæ˜¥ ä½¿ç”¨è€æœ¬è¡ŒJSæ¥æ„å»ºæœåŠ¡å™¨ç«¯çš„ç¥å™¨  NodeJs&lt;/p&gt;
&lt;h2 id=&quot;Connect&quot;&gt;&lt;a href=&quot;#Connect&quot; class=&quot;headerlink&quot; title=&quot;Connect&quot;&gt;&lt;/a&gt;Connect&lt;/h2&gt;&lt;p&gt;ä¸€ä¸ªåŸºäºHTT
      
    
    </summary>
    
    
      <category term="node javascript" scheme="https://h5m1007.github.io/categories/node-javascript/"/>
    
    
      <category term="node nodejs" scheme="https://h5m1007.github.io/tags/node-nodejs/"/>
    
  </entry>
  
  <entry>
    <title>NodeJs å…¨è®°å½•å››</title>
    <link href="https://h5m1007.github.io/2016/10/23/learn-from-nodejs/"/>
    <id>https://h5m1007.github.io/2016/10/23/learn-from-nodejs/</id>
    <published>2016-10-23T14:42:00.000Z</published>
    <updated>2020-04-30T06:38:46.781Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ç«¯ç¨‹åºçŒ¿çš„ç¬¬äºŒæ˜¥ ä½¿ç”¨è€æœ¬è¡ŒJSæ¥æ„å»ºæœåŠ¡å™¨ç«¯çš„ç¥å™¨  NodeJs<br><img src="http://www.blogjava.net/images/blogjava_net/amigoxie/40799/o_http%e5%8d%8f%e8%ae%ae%e5%ad%a6%e4%b9%a0-11.jpg" alt="HTTP&amp;TCP&amp;IP"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å½“åœ¨ä¼ è¾“æ•°æ®æ—¶ï¼Œå¯ä»¥å•å•åªæ˜¯ç”¨TCP/IPåè®®ï¼Œä½†æ— æ³•çœ‹åˆ°ä¼ è¾“çš„æ•°æ®ï¼Œè¿™æ ·è¿™äº›æ•°æ®å°±æ²¡ä»€ä¹ˆæ„ä¹‰äº†ï¼Œä¸€æ—¦æœ‰äº†åº”ç”¨å±‚åè®®ï¼Œå°±èƒ½è¯†åˆ«æ•°æ®å†…å®¹ï¼Œä½¿å…¶å˜å¾—æœ‰æ„ä¹‰ï¼Œè€Œåº”ç”¨å±‚åè®®æœ‰HTTPã€FTPã€TELNETï¼Œç­‰ç­‰  </p><h2 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h2><p>TCPä¼ è¾“æ§åˆ¶åè®®ï¼ŒHTTPã€SMTPã€SSHç­‰åè®®éƒ½æ˜¯åŸºäºæ­¤åè®®ï¼Œå®ƒèƒ½å°†æ•°æ®ä»ä¸€å°è®¡ç®—æœºä¼ è¾“è‡³å¦ä¸€å°æœºå™¨ï¼Œä¸”ä¿æŒæ•°æ®ä¸€è‡´æ€§å’Œé¡ºåº  </p><p>å„ç§æ•°æ®åº“åŠä¸æ•°æ®åº“é€šä¿¡ä½¿ç”¨çš„éƒ½æ˜¯TCPå¥—æ¥å­—  </p><h3 id="TCPç‰¹æ€§"><a href="#TCPç‰¹æ€§" class="headerlink" title="TCPç‰¹æ€§"></a>TCPç‰¹æ€§</h3><p>é¦–è¦ç‰¹æ€§æ˜¯é¢å‘è¿æ¥çš„  </p><p>å› å„ç§çš„ç½‘ç»œåº”ç”¨ä½¿ç”¨çš„éƒ½æ˜¯TCP/IPåè®®ï¼Œä½†åŸºäºæ•°æ®åŒ…ä¼ è¾“çš„IPï¼Œå…¶æ•°æ®åŒ…æ˜¯ç‹¬ç«‹ä¼ è¾“ä¸”æ— åºé€è¾¾  </p><p>å½“TCP/IPå’ŒæœåŠ¡å™¨å»ºç«‹è¿æ¥æ—¶ï¼Œä¸ºäº†è®©æ•°æ®åŒ…é€è¾¾æœ‰åºï¼Œå› å‘é€çš„IPæ•°æ®åŒ…åŒ…å«äº†æ ‡è¯†è¯¥è¿æ¥åŠæ•°æ®æµé¡ºåºçš„ä¿¡æ¯  </p><p>ç”¨nodeå†™çš„æœåŠ¡å™¨ï¼Œåªéœ€è€ƒè™‘å…¶è¿æ¥åŠå¾€å¥—æ¥å­—å†™æ•°æ®å³å¯ï¼Œæ¥æ”¶æ–¹ä¼šæŒ‰åºæ¥æ”¶ä¿¡æ¯  </p><h2 id="Telnet"><a href="#Telnet" class="headerlink" title="Telnet"></a>Telnet</h2><p>ä¸€ç§TCPåè®®ä¸Šå±‚çš„åè®®</p><h3 id="ç”¨ä½œè®¿é—®nodeæœåŠ¡å™¨çš„å®¢æˆ·ç«¯"><a href="#ç”¨ä½œè®¿é—®nodeæœåŠ¡å™¨çš„å®¢æˆ·ç«¯" class="headerlink" title="ç”¨ä½œè®¿é—®nodeæœåŠ¡å™¨çš„å®¢æˆ·ç«¯"></a>ç”¨ä½œè®¿é—®nodeæœåŠ¡å™¨çš„å®¢æˆ·ç«¯</h3><p>Telnetç”¨æ¥è®¿é—®nodeå†™çš„æœåŠ¡å™¨  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; # server.js</span><br><span class="line">    require(&#39;net&#39;).createServer(function(conn)&#123;</span><br><span class="line">        &#x2F;&#x2F; æ¯æ¬¡æœ‰æ–°è¿æ¥å»ºç«‹</span><br><span class="line">        &#x2F;&#x2F; éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡å›è°ƒ</span><br><span class="line">        console.log(&#39;new connection&#39;);</span><br><span class="line">        &#x2F;&#x2F; createServerçš„å›è°ƒæ¥æ”¶çš„ä¸€ä¸ªå‚æ•°</span><br><span class="line">        &#x2F;&#x2F; connå³net.Streamæµå¯¹è±¡å¯è¯»ä¹Ÿå¯å†™(ç±»ä¼¼process.stdout.write)</span><br><span class="line">        conn.write(</span><br><span class="line">            &#39;welcome to node&#39;</span><br><span class="line">        );</span><br><span class="line">        conn.on(&#39;data&#39;, function(data)&#123;</span><br><span class="line">            &#x2F;&#x2F; ç›‘è§†å®¢æˆ·ç«¯è¾“å…¥æ•°æ®çš„å˜åŒ–</span><br><span class="line">        &#125;);</span><br><span class="line">        conn.on(&#39;close&#39;, function()&#123;</span><br><span class="line">            &#x2F;&#x2F; ç›‘è§†å®¢æˆ·ç«¯çŠ¶æ€(å…³é—­)</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;).listen(8080);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>å‘½ä»¤ç»ˆç«¯1è¾“å…¥<code>node server.js</code>  å¯åŠ¨æœåŠ¡å™¨<br>å‘½ä»¤ç»ˆç«¯2è¾“å…¥<code>telnet 127.0.0.1 8080</code>  ç»ˆç«¯äºŒå°†æ”¶åˆ° <em>welcome to node</em><br>å‘½ä»¤ç»ˆç«¯1å°†æ”¶åˆ°ä¿¡æ¯  <em>new connection</em>  </p><h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œæ˜¯æ„å»ºåœ¨è¯·æ±‚ä¸å“åº”ä¸Š  </p><p>è€Œåœ¨nodeä¸­ï¼Œhttp.ServerRequeståŠhttp.ServerResponseæ¥å®ç°  </p><h3 id="server-amp-client"><a href="#server-amp-client" class="headerlink" title="server &amp; client"></a>server &amp; client</h3><p>åœ¨httpæ¨¡å—ä¸­ï¼Œæä¾›http.server()å’Œhttp.request()ä¸¤é™æ€æ–¹æ³•ï¼Œåˆ†åˆ«å®ä¾‹åŒ–  </p><h2 id="http-server"><a href="#http-server" class="headerlink" title="http.server()"></a>http.server()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    require(&#39;http&#39;)</span><br><span class="line">        .server()</span><br><span class="line">        .on(&#39;request&#39;, function(req,res)&#123;</span><br><span class="line"></span><br><span class="line">        &#125;).listen(80);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>ç­‰ä»·äº  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    require(&#39;http&#39;)</span><br><span class="line">        .createServer(function(req, res)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;).listen(80);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="è¯·æ±‚è¿‡ç¨‹"><a href="#è¯·æ±‚è¿‡ç¨‹" class="headerlink" title="è¯·æ±‚è¿‡ç¨‹"></a>è¯·æ±‚è¿‡ç¨‹</h3><p>è®¿é—®ç½‘ç«™æ—¶ï¼Œç”¨æˆ·ä»£ç†å³å®¢æˆ·ç«¯æµè§ˆå™¨å°†ä¼šåˆ›å»ºä¸€ä¸ªè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šç»TCPå‘é€ç»™WebæœåŠ¡å™¨ï¼Œæ¥ç€æœåŠ¡å™¨åšå‡ºå“åº”  </p><h4 id="è¯·æ±‚å’Œå“åº”"><a href="#è¯·æ±‚å’Œå“åº”" class="headerlink" title="è¯·æ±‚å’Œå“åº”"></a>è¯·æ±‚å’Œå“åº”</h4><ul><li>è¯·æ±‚åˆ†ä¸ºè¯·æ±‚å¤´(req.headers)å’Œè¯·æ±‚ä½“(æ— )</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    require(&#39;http&#39;).createServer(function(req, res)&#123;&#125;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>å›è°ƒå‡½æ•°ä¸­çš„ä¸¤å‚æ•°ï¼Œreqå’Œresï¼Œåˆ†åˆ«æ˜¯http.ServerRuestå’Œhttp.ServerResponseçš„å®ä¾‹  </p><ul><li>reqä¸ºrequestå®¢æˆ·ç«¯è¯·æ±‚ï¼Œæä¾›äº†3ä¸ªäº‹ä»¶  </li></ul><p><code>data</code>  è¯·æ±‚ä½“æ•°æ®åˆ°è¾¾è¯¥äº‹ä»¶è§¦å‘ï¼Œäº‹ä»¶æä¾›ä¸€ä¸ªå‚æ•°chunkï¼Œåˆ†å—å¤„ç†æ•°æ®<br><code>end</code>  è¯·æ±‚ä½“æ•°æ®å®Œæˆä¼ è¾“è¯¥äº‹ä»¶è§¦å‘ï¼Œè¡¨ç¤ºæ­¤åå°†ä¸ä¼šæœ‰æ•°æ®åˆ°æ¥<br><code>close</code>  è¯·æ±‚ç»“æŸè¯¥äº‹ä»¶è§¦å‘  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    req.on(&#39;data&#39;, function(chunk)&#123;</span><br><span class="line">        &#x2F;&#x2F; ç›‘è§†è¯·æ±‚æ•°æ®å˜åŒ–</span><br><span class="line">        &#x2F;&#x2F; æ•°æ®å·²æ•°æ®å—åˆ†å—å­˜å‚¨</span><br><span class="line">        &#x2F;&#x2F; å¹¶åˆ†å—å‘é€</span><br><span class="line">        body +&#x3D; chunk;</span><br><span class="line">    &#125;);</span><br><span class="line">    req.on(&#39;end&#39;, function()&#123;</span><br><span class="line">        &#x2F;&#x2F; endäº‹ä»¶è¢«è§¦å‘</span><br><span class="line">        &#x2F;&#x2F; å³æ•°æ®å·²æ¥æ”¶å®Œå…¨</span><br><span class="line">        &#x2F;&#x2F; æ¥ç€å‘æœåŠ¡å™¨å‘é€æ•°æ®</span><br><span class="line">        res.writeHead(200, &#123;</span><br><span class="line">            &#39;Content-Type&#39;: &#39;text&#x2F;html&#39;</span><br><span class="line">        &#125;);</span><br><span class="line">        &#x2F;&#x2F; querystring.parse(str)  è§£æå­—ç¬¦ä¸²ä¸ºå¯¹è±¡</span><br><span class="line">        res.end(&#39;&lt;p&gt;your name is &lt;b&gt;&#39; + qs.parse(body).name + &#39;&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&#39;);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><ul><li>resä¸ºresponseæœåŠ¡å™¨å“åº”ï¼Œæœ‰ä¸‰ä¸ªé‡è¦æˆå‘˜  </li></ul><p><em>å“åº”å¤´</em>  <code>response.writeHead(çŠ¶æ€ç , {å“åº”å¤´æ¯ä¸ªå±æ€§})</code>  </p><p><em>å“åº”å†…å®¹</em>  <code>response.write(data, [encoding])</code>  <code>data</code>ä¸ºä¸€ä¸ªbuffer(å•å­—èŠ‚)æˆ–å­—ç¬¦ä¸²ï¼Œå½“ä¸ºå­—ç¬¦ä¸²éœ€æŒ‡æ˜å…¶ç¼–ç æ–¹å¼<code>encoding</code>é»˜è®¤utf-8ï¼Œåœ¨<code>response.end</code>è°ƒç”¨å‰ï¼Œ<code>reponse.write</code>å¯è¢«å¤šæ¬¡è°ƒç”¨  </p><p><em>ç»“æŸè¯·æ±‚</em>  é€šçŸ¥å®¢æˆ·ç«¯æ‰€æœ‰å‘é€å·²å®Œæˆï¼Œè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œä¸è°ƒç”¨çš„è¯å®¢æˆ·ç«¯æ°¸å¤„äºç­‰å¾…çŠ¶æ€  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    res.writeHead(200, &#123;</span><br><span class="line">        &#39;Content-Type&#39;: &#39;text&#x2F;html&#39;</span><br><span class="line">    &#125;);</span><br><span class="line">    res.write(&#39;å“åº”å†…å®¹&#39;)</span><br><span class="line">    res.end(&#39;ç»“æŸå“åº”&#39;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="å¤´ä¿¡æ¯"><a href="#å¤´ä¿¡æ¯" class="headerlink" title="å¤´ä¿¡æ¯"></a>å¤´ä¿¡æ¯</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    require(&#39;http&#39;).createServer(function(req, res)&#123;</span><br><span class="line">        res.writeHead(200, &#123;</span><br><span class="line">            &#x2F;&#x2F; æŒ‡æ˜å¤´ä¿¡æ¯</span><br><span class="line">            &#x2F;&#x2F; æ–‡æ¡£ç±»å‹é»˜è®¤text&#x2F;plain</span><br><span class="line">            &#39;Content-Type&#39;: &#39;text&#x2F;html&#39;</span><br><span class="line">        &#125;);</span><br><span class="line">        &#x2F;&#x2F; ç”±endå†™å…¥æ•°æ®æ—¶ nodeä¼šç»“æŸå“åº”</span><br><span class="line">        res.end(&#39;Hello &lt;b&gt;World&lt;&#x2F;b&gt;&#39;);</span><br><span class="line">    &#125;).listen(8080);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="å—æ•°æ®"><a href="#å—æ•°æ®" class="headerlink" title="å—æ•°æ®"></a>å—æ•°æ®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    res.write(&#39;Hello &#39;);</span><br><span class="line">    setTimeout(function()&#123;</span><br><span class="line">        res.end(&#39;&lt;b&gt;World&lt;&#x2F;b&gt;&#39;);</span><br><span class="line">    &#125;, 500);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>å…ˆå†™å…¥<em>Hello</em>ï¼Œå†å»¶è¿Ÿ500æ¯«ç§’å†™å…¥Worldå¹¶ç»“æŸå“åº”  </p><p>nodeå…è®¸ä»¥æ•°æ®å—å½¢å¼å¾€å“åº”å†™æ•°æ®ï¼Œä¸”ä¹Ÿå…è®¸ä»¥æ•°æ®å—è¯»æ–‡ä»¶ â€“&gt; <code>ReadStream</code>  </p><ul><li>é«˜æ•ˆå†…å­˜åˆ†é…</li><li>æ•°æ®ä¸€æ—¦å°±ç»ªç«‹å³å¯å†™å…¥</li></ul><h3 id="ReadStream"><a href="#ReadStream" class="headerlink" title="ReadStream"></a>ReadStream</h3><p>å½“å¯¹äºå¤§æ–‡ä»¶å¦‚å›¾ç‰‡åˆ†å—ä¼ è¾“ï¼Œä¼šä½¿ç”¨å¯¹æ–‡ä»¶åˆ›å»ºæµå¯¹è±¡<code>createReadStream</code>  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    require(&#39;http&#39;).createServer(function(req, res)&#123;</span><br><span class="line">        res.writeHead(200, &#123;</span><br><span class="line">            &#39;Content-Type&#39;: &#39;image&#x2F;png&#39;</span><br><span class="line">        &#125;);</span><br><span class="line">        var stream &#x3D; require(&#39;fs&#39;).createReadStream(&#39;xxx.png&#39;);</span><br><span class="line">        stream.on(&#39;data&#39;, function(data)&#123;</span><br><span class="line">            &#x2F;&#x2F; å¯¹æ¥å£</span><br><span class="line">            res.write(data);</span><br><span class="line">        &#125;);</span><br><span class="line">        stream.on(&#39;end&#39;, function()&#123;</span><br><span class="line">            &#x2F;&#x2F; å¯¹æ¥å£</span><br><span class="line">            res.end();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;).listen(8080);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œå…¶å®æ˜¯åœ¨å®ç°<strong>æµçš„å¯¹æ¥</strong>  (<code>.pipe()</code>)  ï¼Œå³æµ(Stream)æ–‡ä»¶ç³»ç»Ÿæ¥ä¸Šäº†å¦ä¸€æµ(http.ServerResponseå¯¹è±¡)ï¼Œæ‰€ä»¥ï¼Œä¸Šè¿°ä»£ç ç­‰ä»·äº  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    require(&#39;http&#39;).createServer(function(req, res)&#123;</span><br><span class="line">        res.writeHead(200, &#123;</span><br><span class="line">            &#39;Content-Type&#39;: &#39;image&#x2F;png&#39;</span><br><span class="line">        &#125;);</span><br><span class="line">        require(&#39;fs&#39;).createReadStream(&#39;xxx.png&#39;).pipe(res);</span><br><span class="line">    &#125;).listen(8080);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h2 id="http-request"><a href="#http-request" class="headerlink" title="http.request()"></a>http.request()</h2><p><code>http.request(option, callback)</code>  ä½œä¸ºå®¢æˆ·ç«¯æƒ³httpæœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ª<code>http.ClientRequest</code>  çš„å®ä¾‹  </p><ul><li><p>å‚æ•°ä¸€optionä¸ºå…³è”æ•°ç»„å¯¹è±¡ï¼Œè¡¨ç¤ºè¯·æ±‚å‚æ•°<br>| host: è¯·æ±‚ç½‘ç«™åŸŸåæˆ–IP<br>| port: ç½‘ç«™ç«¯å£ é»˜è®¤80<br>| method: è¯·æ±‚æ–¹æ³• é»˜è®¤GET<br>| path: è¯·æ±‚ç›¸å¯¹æ ¹çš„è·¯å¾„ é»˜è®¤â€/â€œ  ä¸€èˆ¬ç”±<code>querystring</code>æ¨¡å—è§£æå­—ç¬¦ä¸²è·¯å¾„ä¸ºurlæ ¼å¼ç¼–ç <br>| headers: å…³è”æ•°ç»„å¯¹è±¡ è¯·æ±‚å¤´å†…å®¹</p></li><li><p>å‚æ•°äºŒcallbackè¯·æ±‚å›è°ƒå‡½æ•°<br>callbackå›è°ƒä¼ é€’çš„å‚æ•°ä¸º<code>http.ClientResponse</code>çš„å®ä¾‹</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; è¿”å›http.ClientRequestçš„å®ä¾‹</span><br><span class="line">    http.request(&#123;</span><br><span class="line">        host: &#39;127.0.0.1&#39;,</span><br><span class="line">        port: 8080,</span><br><span class="line">        url: &#39;&#x2F;&#39;,</span><br><span class="line">        method: &#39;GET&#39;</span><br><span class="line">    &#125;, function(res)&#123;</span><br><span class="line">        &#x2F;&#x2F; http.ClientResponseçš„å®ä¾‹</span><br><span class="line">        var body &#x3D; &#39;&#39;;</span><br><span class="line">        res.setEncoding(&#39;utf8&#39;);</span><br><span class="line">        res.on(&#39;data&#39;, function(chunk)&#123;</span><br><span class="line">            &#x2F;&#x2F; ç›‘å¬å“åº”æ•°æ®çš„å˜åŒ–</span><br><span class="line">            &#x2F;&#x2F; ä»¥æ•°æ®å—å½¢å¼</span><br><span class="line">            &#x2F;&#x2F; å­˜å‚¨è‡³bodyå¹¶ä¿å­˜ä¸ºå­—ç¬¦ä¸²</span><br><span class="line">            body +&#x3D; chunk;</span><br><span class="line">        &#125;);</span><br><span class="line">        res.on(&#39;end&#39;, function()&#123;</span><br><span class="line">            console.log(&#39;\n We got: \033[96m&#39; + body + &#39;\033[39m\n&#39;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;).end(); &#x2F;&#x2F; ç»“æŸå“åº”</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="http-get"><a href="#http-get" class="headerlink" title="http.get()"></a>http.get()</h3><p>ç±»ä¼¼ä¸<code>http.request()</code>ï¼Œæä¾›ä¸€æ ·çš„åŠŸèƒ½ï¼Œä½†ç”¨æ³•æ›´ç®€æ´  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    http.get(&#123;</span><br><span class="line">        &#x2F;&#x2F; æ›´åŠ æ˜ç¡®æ˜¯GETè¯·æ±‚</span><br><span class="line">        host: &#39;127.0.0.1&#39;,</span><br><span class="line">        port: 8080,</span><br><span class="line">        url: &#39;&#x2F;&#39;,</span><br><span class="line">        method: &#39;GET&#39;</span><br><span class="line">    &#125;, function(res)&#123;</span><br><span class="line">        var body &#x3D; &#39;&#39;;</span><br><span class="line">        res.setEncoding(&#39;utf8&#39;);</span><br><span class="line">        res.on(&#39;data&#39;, function(chunk)&#123;</span><br><span class="line">            body +&#x3D; chunk;</span><br><span class="line">        &#125;);</span><br><span class="line">        res.on(&#39;end&#39;, function()&#123;</span><br><span class="line">            console.log(&#39;\n We got: \033[96m&#39; + body + &#39;\033[39m\n&#39;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;); &#x2F;&#x2F; ä½¿ç”¨.get() æ­¤å¤„çœç•¥äº†.end()</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h2 id="superagent"><a href="#superagent" class="headerlink" title="superagent"></a>superagent</h2><p>ç±»ä¼¼äº<code>http.request()</code>ï¼Œä¸€ä¸ªæ›´åŠ ä¾¿æ·çš„å®¢æˆ·ç«¯è¯·æ±‚ä»£ç†æ¨¡å—  </p><ul><li>getè¯·æ±‚</li></ul><p>ä½¿ç”¨getè¯·æ±‚ä¼ é€’æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå¯ç”¨<code>.query()</code>ï¼Œä¼ é€’ä¸€ä¸ªå¯¹è±¡æˆ–å­—ç¬¦ä¸²  </p><p><code>.set()</code>  è®¾ç½®<em>è¯·æ±‚å¤´</em>ä¿¡æ¯  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var request &#x3D; require(&#39;superagent&#39;);</span><br><span class="line">    request</span><br><span class="line">        .get(&#39;&#x2F;search&#39;)</span><br><span class="line">        .query(&#123;</span><br><span class="line">            scope: 103,</span><br><span class="line">            format: &#39;json&#39;,</span><br><span class="line">            appid: &#39;379020&#39;,</span><br><span class="line">            bk_key: &#39;ç«å½±&#39;</span><br><span class="line">        &#125;)</span><br><span class="line">        &#x2F;&#x2F; ç­‰ä»·äº</span><br><span class="line">        &#x2F;&#x2F; .query(&#39;scope&#x3D;103&amp;format&#x3D;json&amp;appid&#x3D;379020&amp;bk_key&#x3D;ç«å½±&#39;)</span><br><span class="line">        .set(&#39;Accept&#39;, &#39;application&#x2F;json&#39;)</span><br><span class="line">        .end(function(res)&#123;</span><br><span class="line">            console.log(res.body);</span><br><span class="line">        &#125;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><ul><li>postè¯·æ±‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    request</span><br><span class="line">        .post(&#39;&#x2F;user&#39;)</span><br><span class="line">        .set(&#39;Content-Type&#39;, &#39;application&#x2F;json&#39;)</span><br><span class="line">        .send(&#123;</span><br><span class="line">            name: &#39;leon&#39;,</span><br><span class="line">            job: &#39;engineer&#39;</span><br><span class="line">        &#125;)</span><br><span class="line">        .end(callback);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼äºgetè¯·æ±‚çš„å†™æ³•ï¼Œå½“æƒ³æäº¤æ•°æ®ä»¥ <code>application/x-www-form-urlencoded</code>  ç±»å‹çš„è¯ï¼Œåˆ™å¯ç›´æ¥è°ƒç”¨ <code>.type()</code>  ä¼ é€’formå‚æ•°å³å¯  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    request</span><br><span class="line">        .type(&#39;form&#39;)</span><br><span class="line">        .send(&#123;</span><br><span class="line">            name: &#39;leon&#39;</span><br><span class="line">        &#125;)</span><br><span class="line">        .send(&#123;</span><br><span class="line">            job: &#39;engineer&#39;</span><br><span class="line">        &#125;)</span><br><span class="line">        .end(callback);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‰ç«¯ç¨‹åºçŒ¿çš„ç¬¬äºŒæ˜¥ ä½¿ç”¨è€æœ¬è¡ŒJSæ¥æ„å»ºæœåŠ¡å™¨ç«¯çš„ç¥å™¨  NodeJs&lt;br&gt;&lt;img src=&quot;http://www.blogjava.net/images/blogjava_net/amigoxie/40799/o_http%e5%8d%8f%e8%ae%ae%e5%a
      
    
    </summary>
    
    
      <category term="node javascript" scheme="https://h5m1007.github.io/categories/node-javascript/"/>
    
    
      <category term="node nodejs" scheme="https://h5m1007.github.io/tags/node-nodejs/"/>
    
  </entry>
  
</feed>
